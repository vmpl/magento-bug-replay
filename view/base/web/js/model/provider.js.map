{"version":3,"file":"provider.js","names":["_default","_uiComponent","extend","defaults","ignoreTmpls","data","set","path","value","_this","Array","_this$get","Object","keys","get","filter","index","length","forEach","remove","$$primary","Function","_super","diffs","isTracked","_mageUtils","compare","_set","_notifyChanges","pathComponent","parent","pathComponents","split","lastPathComponent","pop","shift","_underscore","isObject","isFunction"],"sources":["../../ts/js/model/provider.ts"],"sourcesContent":["// @ts-ignore\nimport utils from 'mageUtils';\nimport _ from 'underscore';\nimport Component from 'uiComponent';\n\nexport default Component.extend({\n    defaults: {\n        ignoreTmpls: {\n            data: true\n        }\n    },\n    set(path: string, value: any) {\n        if (value instanceof Array) {\n            Object.keys(this.get(path) ?? {})\n                .filter(index => ~~index >= value.length)\n                .forEach(index => this.remove(`${path}.${index}`));\n\n            for (let index in value) {\n                this.set(`${path}.${index}`, value[index]);\n            }\n\n            return this;\n        }\n\n        // @docs prevents the loop of the same item\n        if (!(value.$$primary instanceof Function)) {\n            return this._super(path, value);\n        }\n\n        const data = this.get(path);\n        const diffs = !(data instanceof Function)\n            && !this.isTracked(data)\n            && data?.$$primary() !== value.$$primary()\n                ? utils.compare(data, value, path)\n                : false;\n        this._set(path ,value);\n\n        if (diffs) {\n            this._notifyChanges(diffs);\n        }\n\n        return this;\n    },\n    _set(path: string, value: any) {\n        let pathComponent, parent = this;\n        const pathComponents = path.split('.');\n        const lastPathComponent = pathComponents.pop();\n        while(pathComponent = pathComponents.shift()) {\n            if (!_.isObject(parent[pathComponent])) {\n                parent[pathComponent] = {};\n            }\n            parent = parent[pathComponent];\n        }\n        if (_.isFunction(parent[lastPathComponent])) {\n            parent[lastPathComponent](value);\n        } else {\n            parent[lastPathComponent] = value;\n        }\n    }\n})\n"],"mappings":";;;EAAA;EAAA,IAAAA,QAAA,GAKeC,YAAA,CAAUC,MAAM,CAAC;IAC5BC,QAAQ,EAAE;MACNC,WAAW,EAAE;QACTC,IAAI,EAAE;MACV;IACJ,CAAC;IACDC,GAAG,WAAAA,IAACC,IAAY,EAAEC,KAAU,EAAE;MAAA,IAAAC,KAAA;MAC1B,IAAID,KAAK,YAAYE,KAAK,EAAE;QAAA,IAAAC,SAAA;QACxBC,MAAM,CAACC,IAAI,EAAAF,SAAA,GAAC,IAAI,CAACG,GAAG,CAACP,IAAI,CAAC,YAAAI,SAAA,GAAI,CAAC,CAAC,CAAC,CAC5BI,MAAM,CAAC,UAAAC,KAAK;UAAA,OAAI,CAAC,CAACA,KAAK,IAAIR,KAAK,CAACS,MAAM;QAAA,EAAC,CACxCC,OAAO,CAAC,UAAAF,KAAK;UAAA,OAAIP,KAAI,CAACU,MAAM,CAAIZ,IAAI,SAAIS,KAAO,CAAC;QAAA,EAAC;QAEtD,KAAK,IAAIA,KAAK,IAAIR,KAAK,EAAE;UACrB,IAAI,CAACF,GAAG,CAAIC,IAAI,SAAIS,KAAK,EAAIR,KAAK,CAACQ,KAAK,CAAC,CAAC;QAC9C;QAEA,OAAO,IAAI;MACf;;MAEA;MACA,IAAI,EAAER,KAAK,CAACY,SAAS,YAAYC,QAAQ,CAAC,EAAE;QACxC,OAAO,IAAI,CAACC,MAAM,CAACf,IAAI,EAAEC,KAAK,CAAC;MACnC;MAEA,IAAMH,IAAI,GAAG,IAAI,CAACS,GAAG,CAACP,IAAI,CAAC;MAC3B,IAAMgB,KAAK,GAAG,EAAElB,IAAI,YAAYgB,QAAQ,CAAC,IAClC,CAAC,IAAI,CAACG,SAAS,CAACnB,IAAI,CAAC,IACrB,CAAAA,IAAI,oBAAJA,IAAI,CAAEe,SAAS,CAAC,CAAC,MAAKZ,KAAK,CAACY,SAAS,CAAC,CAAC,GACpCK,UAAA,CAAMC,OAAO,CAACrB,IAAI,EAAEG,KAAK,EAAED,IAAI,CAAC,GAChC,KAAK;MACf,IAAI,CAACoB,IAAI,CAACpB,IAAI,EAAEC,KAAK,CAAC;MAEtB,IAAIe,KAAK,EAAE;QACP,IAAI,CAACK,cAAc,CAACL,KAAK,CAAC;MAC9B;MAEA,OAAO,IAAI;IACf,CAAC;IACDI,IAAI,WAAAA,KAACpB,IAAY,EAAEC,KAAU,EAAE;MAC3B,IAAIqB,aAAa;QAAEC,MAAM,GAAG,IAAI;MAChC,IAAMC,cAAc,GAAGxB,IAAI,CAACyB,KAAK,CAAC,GAAG,CAAC;MACtC,IAAMC,iBAAiB,GAAGF,cAAc,CAACG,GAAG,CAAC,CAAC;MAC9C,OAAML,aAAa,GAAGE,cAAc,CAACI,KAAK,CAAC,CAAC,EAAE;QAC1C,IAAI,CAACC,WAAA,CAAEC,QAAQ,CAACP,MAAM,CAACD,aAAa,CAAC,CAAC,EAAE;UACpCC,MAAM,CAACD,aAAa,CAAC,GAAG,CAAC,CAAC;QAC9B;QACAC,MAAM,GAAGA,MAAM,CAACD,aAAa,CAAC;MAClC;MACA,IAAIO,WAAA,CAAEE,UAAU,CAACR,MAAM,CAACG,iBAAiB,CAAC,CAAC,EAAE;QACzCH,MAAM,CAACG,iBAAiB,CAAC,CAACzB,KAAK,CAAC;MACpC,CAAC,MAAM;QACHsB,MAAM,CAACG,iBAAiB,CAAC,GAAGzB,KAAK;MACrC;IACJ;EACJ,CAAC,CAAC;EAAA,OAAAR,QAAA;AAAA"}