{"version":3,"file":"./dexie.js","mappings":"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","sources":["webpack://@vmpl/module-bug-replay/webpack/universalModuleDefinition","webpack://@vmpl/module-bug-replay/webpack/bootstrap","webpack://@vmpl/module-bug-replay/webpack/runtime/define property getters","webpack://@vmpl/module-bug-replay/webpack/runtime/hasOwnProperty shorthand","webpack://@vmpl/module-bug-replay/webpack/runtime/make namespace object","webpack://@vmpl/module-bug-replay/./node_modules/dexie/dist/dexie.mjs"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/*\n * Dexie.js - a minimalistic wrapper for IndexedDB\n * ===============================================\n *\n * By David Fahlander, david.fahlander@gmail.com\n *\n * Version 3.2.3, Mon Jan 23 2023\n *\n * https://dexie.org\n *\n * Apache License Version 2.0, January 2004, http://www.apache.org/licenses/\n */\n \n/*! *****************************************************************************\nCopyright (c) Microsoft Corporation.\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\nvar __assign = function() {\n    __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nfunction __spreadArray(to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nvar _global = typeof globalThis !== 'undefined' ? globalThis :\n    typeof self !== 'undefined' ? self :\n        typeof window !== 'undefined' ? window :\n            global;\n\nvar keys = Object.keys;\nvar isArray = Array.isArray;\nif (typeof Promise !== 'undefined' && !_global.Promise) {\n    _global.Promise = Promise;\n}\nfunction extend(obj, extension) {\n    if (typeof extension !== 'object')\n        return obj;\n    keys(extension).forEach(function (key) {\n        obj[key] = extension[key];\n    });\n    return obj;\n}\nvar getProto = Object.getPrototypeOf;\nvar _hasOwn = {}.hasOwnProperty;\nfunction hasOwn(obj, prop) {\n    return _hasOwn.call(obj, prop);\n}\nfunction props(proto, extension) {\n    if (typeof extension === 'function')\n        extension = extension(getProto(proto));\n    (typeof Reflect === \"undefined\" ? keys : Reflect.ownKeys)(extension).forEach(function (key) {\n        setProp(proto, key, extension[key]);\n    });\n}\nvar defineProperty = Object.defineProperty;\nfunction setProp(obj, prop, functionOrGetSet, options) {\n    defineProperty(obj, prop, extend(functionOrGetSet && hasOwn(functionOrGetSet, \"get\") && typeof functionOrGetSet.get === 'function' ?\n        { get: functionOrGetSet.get, set: functionOrGetSet.set, configurable: true } :\n        { value: functionOrGetSet, configurable: true, writable: true }, options));\n}\nfunction derive(Child) {\n    return {\n        from: function (Parent) {\n            Child.prototype = Object.create(Parent.prototype);\n            setProp(Child.prototype, \"constructor\", Child);\n            return {\n                extend: props.bind(null, Child.prototype)\n            };\n        }\n    };\n}\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\nfunction getPropertyDescriptor(obj, prop) {\n    var pd = getOwnPropertyDescriptor(obj, prop);\n    var proto;\n    return pd || (proto = getProto(obj)) && getPropertyDescriptor(proto, prop);\n}\nvar _slice = [].slice;\nfunction slice(args, start, end) {\n    return _slice.call(args, start, end);\n}\nfunction override(origFunc, overridedFactory) {\n    return overridedFactory(origFunc);\n}\nfunction assert(b) {\n    if (!b)\n        throw new Error(\"Assertion Failed\");\n}\nfunction asap$1(fn) {\n    if (_global.setImmediate)\n        setImmediate(fn);\n    else\n        setTimeout(fn, 0);\n}\nfunction arrayToObject(array, extractor) {\n    return array.reduce(function (result, item, i) {\n        var nameAndValue = extractor(item, i);\n        if (nameAndValue)\n            result[nameAndValue[0]] = nameAndValue[1];\n        return result;\n    }, {});\n}\nfunction tryCatch(fn, onerror, args) {\n    try {\n        fn.apply(null, args);\n    }\n    catch (ex) {\n        onerror && onerror(ex);\n    }\n}\nfunction getByKeyPath(obj, keyPath) {\n    if (hasOwn(obj, keyPath))\n        return obj[keyPath];\n    if (!keyPath)\n        return obj;\n    if (typeof keyPath !== 'string') {\n        var rv = [];\n        for (var i = 0, l = keyPath.length; i < l; ++i) {\n            var val = getByKeyPath(obj, keyPath[i]);\n            rv.push(val);\n        }\n        return rv;\n    }\n    var period = keyPath.indexOf('.');\n    if (period !== -1) {\n        var innerObj = obj[keyPath.substr(0, period)];\n        return innerObj === undefined ? undefined : getByKeyPath(innerObj, keyPath.substr(period + 1));\n    }\n    return undefined;\n}\nfunction setByKeyPath(obj, keyPath, value) {\n    if (!obj || keyPath === undefined)\n        return;\n    if ('isFrozen' in Object && Object.isFrozen(obj))\n        return;\n    if (typeof keyPath !== 'string' && 'length' in keyPath) {\n        assert(typeof value !== 'string' && 'length' in value);\n        for (var i = 0, l = keyPath.length; i < l; ++i) {\n            setByKeyPath(obj, keyPath[i], value[i]);\n        }\n    }\n    else {\n        var period = keyPath.indexOf('.');\n        if (period !== -1) {\n            var currentKeyPath = keyPath.substr(0, period);\n            var remainingKeyPath = keyPath.substr(period + 1);\n            if (remainingKeyPath === \"\")\n                if (value === undefined) {\n                    if (isArray(obj) && !isNaN(parseInt(currentKeyPath)))\n                        obj.splice(currentKeyPath, 1);\n                    else\n                        delete obj[currentKeyPath];\n                }\n                else\n                    obj[currentKeyPath] = value;\n            else {\n                var innerObj = obj[currentKeyPath];\n                if (!innerObj || !hasOwn(obj, currentKeyPath))\n                    innerObj = (obj[currentKeyPath] = {});\n                setByKeyPath(innerObj, remainingKeyPath, value);\n            }\n        }\n        else {\n            if (value === undefined) {\n                if (isArray(obj) && !isNaN(parseInt(keyPath)))\n                    obj.splice(keyPath, 1);\n                else\n                    delete obj[keyPath];\n            }\n            else\n                obj[keyPath] = value;\n        }\n    }\n}\nfunction delByKeyPath(obj, keyPath) {\n    if (typeof keyPath === 'string')\n        setByKeyPath(obj, keyPath, undefined);\n    else if ('length' in keyPath)\n        [].map.call(keyPath, function (kp) {\n            setByKeyPath(obj, kp, undefined);\n        });\n}\nfunction shallowClone(obj) {\n    var rv = {};\n    for (var m in obj) {\n        if (hasOwn(obj, m))\n            rv[m] = obj[m];\n    }\n    return rv;\n}\nvar concat = [].concat;\nfunction flatten(a) {\n    return concat.apply([], a);\n}\nvar intrinsicTypeNames = \"Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey\"\n    .split(',').concat(flatten([8, 16, 32, 64].map(function (num) { return [\"Int\", \"Uint\", \"Float\"].map(function (t) { return t + num + \"Array\"; }); }))).filter(function (t) { return _global[t]; });\nvar intrinsicTypes = intrinsicTypeNames.map(function (t) { return _global[t]; });\narrayToObject(intrinsicTypeNames, function (x) { return [x, true]; });\nvar circularRefs = null;\nfunction deepClone(any) {\n    circularRefs = typeof WeakMap !== 'undefined' && new WeakMap();\n    var rv = innerDeepClone(any);\n    circularRefs = null;\n    return rv;\n}\nfunction innerDeepClone(any) {\n    if (!any || typeof any !== 'object')\n        return any;\n    var rv = circularRefs && circularRefs.get(any);\n    if (rv)\n        return rv;\n    if (isArray(any)) {\n        rv = [];\n        circularRefs && circularRefs.set(any, rv);\n        for (var i = 0, l = any.length; i < l; ++i) {\n            rv.push(innerDeepClone(any[i]));\n        }\n    }\n    else if (intrinsicTypes.indexOf(any.constructor) >= 0) {\n        rv = any;\n    }\n    else {\n        var proto = getProto(any);\n        rv = proto === Object.prototype ? {} : Object.create(proto);\n        circularRefs && circularRefs.set(any, rv);\n        for (var prop in any) {\n            if (hasOwn(any, prop)) {\n                rv[prop] = innerDeepClone(any[prop]);\n            }\n        }\n    }\n    return rv;\n}\nvar toString = {}.toString;\nfunction toStringTag(o) {\n    return toString.call(o).slice(8, -1);\n}\nvar iteratorSymbol = typeof Symbol !== 'undefined' ?\n    Symbol.iterator :\n    '@@iterator';\nvar getIteratorOf = typeof iteratorSymbol === \"symbol\" ? function (x) {\n    var i;\n    return x != null && (i = x[iteratorSymbol]) && i.apply(x);\n} : function () { return null; };\nvar NO_CHAR_ARRAY = {};\nfunction getArrayOf(arrayLike) {\n    var i, a, x, it;\n    if (arguments.length === 1) {\n        if (isArray(arrayLike))\n            return arrayLike.slice();\n        if (this === NO_CHAR_ARRAY && typeof arrayLike === 'string')\n            return [arrayLike];\n        if ((it = getIteratorOf(arrayLike))) {\n            a = [];\n            while ((x = it.next()), !x.done)\n                a.push(x.value);\n            return a;\n        }\n        if (arrayLike == null)\n            return [arrayLike];\n        i = arrayLike.length;\n        if (typeof i === 'number') {\n            a = new Array(i);\n            while (i--)\n                a[i] = arrayLike[i];\n            return a;\n        }\n        return [arrayLike];\n    }\n    i = arguments.length;\n    a = new Array(i);\n    while (i--)\n        a[i] = arguments[i];\n    return a;\n}\nvar isAsyncFunction = typeof Symbol !== 'undefined'\n    ? function (fn) { return fn[Symbol.toStringTag] === 'AsyncFunction'; }\n    : function () { return false; };\n\nvar debug = typeof location !== 'undefined' &&\n    /^(http|https):\\/\\/(localhost|127\\.0\\.0\\.1)/.test(location.href);\nfunction setDebug(value, filter) {\n    debug = value;\n    libraryFilter = filter;\n}\nvar libraryFilter = function () { return true; };\nvar NEEDS_THROW_FOR_STACK = !new Error(\"\").stack;\nfunction getErrorWithStack() {\n    if (NEEDS_THROW_FOR_STACK)\n        try {\n            getErrorWithStack.arguments;\n            throw new Error();\n        }\n        catch (e) {\n            return e;\n        }\n    return new Error();\n}\nfunction prettyStack(exception, numIgnoredFrames) {\n    var stack = exception.stack;\n    if (!stack)\n        return \"\";\n    numIgnoredFrames = (numIgnoredFrames || 0);\n    if (stack.indexOf(exception.name) === 0)\n        numIgnoredFrames += (exception.name + exception.message).split('\\n').length;\n    return stack.split('\\n')\n        .slice(numIgnoredFrames)\n        .filter(libraryFilter)\n        .map(function (frame) { return \"\\n\" + frame; })\n        .join('');\n}\n\nvar dexieErrorNames = [\n    'Modify',\n    'Bulk',\n    'OpenFailed',\n    'VersionChange',\n    'Schema',\n    'Upgrade',\n    'InvalidTable',\n    'MissingAPI',\n    'NoSuchDatabase',\n    'InvalidArgument',\n    'SubTransaction',\n    'Unsupported',\n    'Internal',\n    'DatabaseClosed',\n    'PrematureCommit',\n    'ForeignAwait'\n];\nvar idbDomErrorNames = [\n    'Unknown',\n    'Constraint',\n    'Data',\n    'TransactionInactive',\n    'ReadOnly',\n    'Version',\n    'NotFound',\n    'InvalidState',\n    'InvalidAccess',\n    'Abort',\n    'Timeout',\n    'QuotaExceeded',\n    'Syntax',\n    'DataClone'\n];\nvar errorList = dexieErrorNames.concat(idbDomErrorNames);\nvar defaultTexts = {\n    VersionChanged: \"Database version changed by other database connection\",\n    DatabaseClosed: \"Database has been closed\",\n    Abort: \"Transaction aborted\",\n    TransactionInactive: \"Transaction has already completed or failed\",\n    MissingAPI: \"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb\"\n};\nfunction DexieError(name, msg) {\n    this._e = getErrorWithStack();\n    this.name = name;\n    this.message = msg;\n}\nderive(DexieError).from(Error).extend({\n    stack: {\n        get: function () {\n            return this._stack ||\n                (this._stack = this.name + \": \" + this.message + prettyStack(this._e, 2));\n        }\n    },\n    toString: function () { return this.name + \": \" + this.message; }\n});\nfunction getMultiErrorMessage(msg, failures) {\n    return msg + \". Errors: \" + Object.keys(failures)\n        .map(function (key) { return failures[key].toString(); })\n        .filter(function (v, i, s) { return s.indexOf(v) === i; })\n        .join('\\n');\n}\nfunction ModifyError(msg, failures, successCount, failedKeys) {\n    this._e = getErrorWithStack();\n    this.failures = failures;\n    this.failedKeys = failedKeys;\n    this.successCount = successCount;\n    this.message = getMultiErrorMessage(msg, failures);\n}\nderive(ModifyError).from(DexieError);\nfunction BulkError(msg, failures) {\n    this._e = getErrorWithStack();\n    this.name = \"BulkError\";\n    this.failures = Object.keys(failures).map(function (pos) { return failures[pos]; });\n    this.failuresByPos = failures;\n    this.message = getMultiErrorMessage(msg, failures);\n}\nderive(BulkError).from(DexieError);\nvar errnames = errorList.reduce(function (obj, name) { return (obj[name] = name + \"Error\", obj); }, {});\nvar BaseException = DexieError;\nvar exceptions = errorList.reduce(function (obj, name) {\n    var fullName = name + \"Error\";\n    function DexieError(msgOrInner, inner) {\n        this._e = getErrorWithStack();\n        this.name = fullName;\n        if (!msgOrInner) {\n            this.message = defaultTexts[name] || fullName;\n            this.inner = null;\n        }\n        else if (typeof msgOrInner === 'string') {\n            this.message = \"\" + msgOrInner + (!inner ? '' : '\\n ' + inner);\n            this.inner = inner || null;\n        }\n        else if (typeof msgOrInner === 'object') {\n            this.message = msgOrInner.name + \" \" + msgOrInner.message;\n            this.inner = msgOrInner;\n        }\n    }\n    derive(DexieError).from(BaseException);\n    obj[name] = DexieError;\n    return obj;\n}, {});\nexceptions.Syntax = SyntaxError;\nexceptions.Type = TypeError;\nexceptions.Range = RangeError;\nvar exceptionMap = idbDomErrorNames.reduce(function (obj, name) {\n    obj[name + \"Error\"] = exceptions[name];\n    return obj;\n}, {});\nfunction mapError(domError, message) {\n    if (!domError || domError instanceof DexieError || domError instanceof TypeError || domError instanceof SyntaxError || !domError.name || !exceptionMap[domError.name])\n        return domError;\n    var rv = new exceptionMap[domError.name](message || domError.message, domError);\n    if (\"stack\" in domError) {\n        setProp(rv, \"stack\", { get: function () {\n                return this.inner.stack;\n            } });\n    }\n    return rv;\n}\nvar fullNameExceptions = errorList.reduce(function (obj, name) {\n    if ([\"Syntax\", \"Type\", \"Range\"].indexOf(name) === -1)\n        obj[name + \"Error\"] = exceptions[name];\n    return obj;\n}, {});\nfullNameExceptions.ModifyError = ModifyError;\nfullNameExceptions.DexieError = DexieError;\nfullNameExceptions.BulkError = BulkError;\n\nfunction nop() { }\nfunction mirror(val) { return val; }\nfunction pureFunctionChain(f1, f2) {\n    if (f1 == null || f1 === mirror)\n        return f2;\n    return function (val) {\n        return f2(f1(val));\n    };\n}\nfunction callBoth(on1, on2) {\n    return function () {\n        on1.apply(this, arguments);\n        on2.apply(this, arguments);\n    };\n}\nfunction hookCreatingChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        var res = f1.apply(this, arguments);\n        if (res !== undefined)\n            arguments[0] = res;\n        var onsuccess = this.onsuccess,\n        onerror = this.onerror;\n        this.onsuccess = null;\n        this.onerror = null;\n        var res2 = f2.apply(this, arguments);\n        if (onsuccess)\n            this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror)\n            this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        return res2 !== undefined ? res2 : res;\n    };\n}\nfunction hookDeletingChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        f1.apply(this, arguments);\n        var onsuccess = this.onsuccess,\n        onerror = this.onerror;\n        this.onsuccess = this.onerror = null;\n        f2.apply(this, arguments);\n        if (onsuccess)\n            this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror)\n            this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n    };\n}\nfunction hookUpdatingChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function (modifications) {\n        var res = f1.apply(this, arguments);\n        extend(modifications, res);\n        var onsuccess = this.onsuccess,\n        onerror = this.onerror;\n        this.onsuccess = null;\n        this.onerror = null;\n        var res2 = f2.apply(this, arguments);\n        if (onsuccess)\n            this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n        if (onerror)\n            this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        return res === undefined ?\n            (res2 === undefined ? undefined : res2) :\n            (extend(res, res2));\n    };\n}\nfunction reverseStoppableEventChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        if (f2.apply(this, arguments) === false)\n            return false;\n        return f1.apply(this, arguments);\n    };\n}\nfunction promisableChain(f1, f2) {\n    if (f1 === nop)\n        return f2;\n    return function () {\n        var res = f1.apply(this, arguments);\n        if (res && typeof res.then === 'function') {\n            var thiz = this, i = arguments.length, args = new Array(i);\n            while (i--)\n                args[i] = arguments[i];\n            return res.then(function () {\n                return f2.apply(thiz, args);\n            });\n        }\n        return f2.apply(this, arguments);\n    };\n}\n\nvar INTERNAL = {};\nvar LONG_STACKS_CLIP_LIMIT = 100,\nMAX_LONG_STACKS = 20, ZONE_ECHO_LIMIT = 100, _a$1 = typeof Promise === 'undefined' ?\n    [] :\n    (function () {\n        var globalP = Promise.resolve();\n        if (typeof crypto === 'undefined' || !crypto.subtle)\n            return [globalP, getProto(globalP), globalP];\n        var nativeP = crypto.subtle.digest(\"SHA-512\", new Uint8Array([0]));\n        return [\n            nativeP,\n            getProto(nativeP),\n            globalP\n        ];\n    })(), resolvedNativePromise = _a$1[0], nativePromiseProto = _a$1[1], resolvedGlobalPromise = _a$1[2], nativePromiseThen = nativePromiseProto && nativePromiseProto.then;\nvar NativePromise = resolvedNativePromise && resolvedNativePromise.constructor;\nvar patchGlobalPromise = !!resolvedGlobalPromise;\nvar stack_being_generated = false;\nvar schedulePhysicalTick = resolvedGlobalPromise ?\n    function () { resolvedGlobalPromise.then(physicalTick); }\n    :\n        _global.setImmediate ?\n            setImmediate.bind(null, physicalTick) :\n            _global.MutationObserver ?\n                function () {\n                    var hiddenDiv = document.createElement(\"div\");\n                    (new MutationObserver(function () {\n                        physicalTick();\n                        hiddenDiv = null;\n                    })).observe(hiddenDiv, { attributes: true });\n                    hiddenDiv.setAttribute('i', '1');\n                } :\n                function () { setTimeout(physicalTick, 0); };\nvar asap = function (callback, args) {\n    microtickQueue.push([callback, args]);\n    if (needsNewPhysicalTick) {\n        schedulePhysicalTick();\n        needsNewPhysicalTick = false;\n    }\n};\nvar isOutsideMicroTick = true,\nneedsNewPhysicalTick = true,\nunhandledErrors = [],\nrejectingErrors = [],\ncurrentFulfiller = null, rejectionMapper = mirror;\nvar globalPSD = {\n    id: 'global',\n    global: true,\n    ref: 0,\n    unhandleds: [],\n    onunhandled: globalError,\n    pgp: false,\n    env: {},\n    finalize: function () {\n        this.unhandleds.forEach(function (uh) {\n            try {\n                globalError(uh[0], uh[1]);\n            }\n            catch (e) { }\n        });\n    }\n};\nvar PSD = globalPSD;\nvar microtickQueue = [];\nvar numScheduledCalls = 0;\nvar tickFinalizers = [];\nfunction DexiePromise(fn) {\n    if (typeof this !== 'object')\n        throw new TypeError('Promises must be constructed via new');\n    this._listeners = [];\n    this.onuncatched = nop;\n    this._lib = false;\n    var psd = (this._PSD = PSD);\n    if (debug) {\n        this._stackHolder = getErrorWithStack();\n        this._prev = null;\n        this._numPrev = 0;\n    }\n    if (typeof fn !== 'function') {\n        if (fn !== INTERNAL)\n            throw new TypeError('Not a function');\n        this._state = arguments[1];\n        this._value = arguments[2];\n        if (this._state === false)\n            handleRejection(this, this._value);\n        return;\n    }\n    this._state = null;\n    this._value = null;\n    ++psd.ref;\n    executePromiseTask(this, fn);\n}\nvar thenProp = {\n    get: function () {\n        var psd = PSD, microTaskId = totalEchoes;\n        function then(onFulfilled, onRejected) {\n            var _this = this;\n            var possibleAwait = !psd.global && (psd !== PSD || microTaskId !== totalEchoes);\n            var cleanup = possibleAwait && !decrementExpectedAwaits();\n            var rv = new DexiePromise(function (resolve, reject) {\n                propagateToListener(_this, new Listener(nativeAwaitCompatibleWrap(onFulfilled, psd, possibleAwait, cleanup), nativeAwaitCompatibleWrap(onRejected, psd, possibleAwait, cleanup), resolve, reject, psd));\n            });\n            debug && linkToPreviousPromise(rv, this);\n            return rv;\n        }\n        then.prototype = INTERNAL;\n        return then;\n    },\n    set: function (value) {\n        setProp(this, 'then', value && value.prototype === INTERNAL ?\n            thenProp :\n            {\n                get: function () {\n                    return value;\n                },\n                set: thenProp.set\n            });\n    }\n};\nprops(DexiePromise.prototype, {\n    then: thenProp,\n    _then: function (onFulfilled, onRejected) {\n        propagateToListener(this, new Listener(null, null, onFulfilled, onRejected, PSD));\n    },\n    catch: function (onRejected) {\n        if (arguments.length === 1)\n            return this.then(null, onRejected);\n        var type = arguments[0], handler = arguments[1];\n        return typeof type === 'function' ? this.then(null, function (err) {\n            return err instanceof type ? handler(err) : PromiseReject(err);\n        })\n            : this.then(null, function (err) {\n                return err && err.name === type ? handler(err) : PromiseReject(err);\n            });\n    },\n    finally: function (onFinally) {\n        return this.then(function (value) {\n            onFinally();\n            return value;\n        }, function (err) {\n            onFinally();\n            return PromiseReject(err);\n        });\n    },\n    stack: {\n        get: function () {\n            if (this._stack)\n                return this._stack;\n            try {\n                stack_being_generated = true;\n                var stacks = getStack(this, [], MAX_LONG_STACKS);\n                var stack = stacks.join(\"\\nFrom previous: \");\n                if (this._state !== null)\n                    this._stack = stack;\n                return stack;\n            }\n            finally {\n                stack_being_generated = false;\n            }\n        }\n    },\n    timeout: function (ms, msg) {\n        var _this = this;\n        return ms < Infinity ?\n            new DexiePromise(function (resolve, reject) {\n                var handle = setTimeout(function () { return reject(new exceptions.Timeout(msg)); }, ms);\n                _this.then(resolve, reject).finally(clearTimeout.bind(null, handle));\n            }) : this;\n    }\n});\nif (typeof Symbol !== 'undefined' && Symbol.toStringTag)\n    setProp(DexiePromise.prototype, Symbol.toStringTag, 'Dexie.Promise');\nglobalPSD.env = snapShot();\nfunction Listener(onFulfilled, onRejected, resolve, reject, zone) {\n    this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n    this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n    this.resolve = resolve;\n    this.reject = reject;\n    this.psd = zone;\n}\nprops(DexiePromise, {\n    all: function () {\n        var values = getArrayOf.apply(null, arguments)\n            .map(onPossibleParallellAsync);\n        return new DexiePromise(function (resolve, reject) {\n            if (values.length === 0)\n                resolve([]);\n            var remaining = values.length;\n            values.forEach(function (a, i) { return DexiePromise.resolve(a).then(function (x) {\n                values[i] = x;\n                if (!--remaining)\n                    resolve(values);\n            }, reject); });\n        });\n    },\n    resolve: function (value) {\n        if (value instanceof DexiePromise)\n            return value;\n        if (value && typeof value.then === 'function')\n            return new DexiePromise(function (resolve, reject) {\n                value.then(resolve, reject);\n            });\n        var rv = new DexiePromise(INTERNAL, true, value);\n        linkToPreviousPromise(rv, currentFulfiller);\n        return rv;\n    },\n    reject: PromiseReject,\n    race: function () {\n        var values = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n        return new DexiePromise(function (resolve, reject) {\n            values.map(function (value) { return DexiePromise.resolve(value).then(resolve, reject); });\n        });\n    },\n    PSD: {\n        get: function () { return PSD; },\n        set: function (value) { return PSD = value; }\n    },\n    totalEchoes: { get: function () { return totalEchoes; } },\n    newPSD: newScope,\n    usePSD: usePSD,\n    scheduler: {\n        get: function () { return asap; },\n        set: function (value) { asap = value; }\n    },\n    rejectionMapper: {\n        get: function () { return rejectionMapper; },\n        set: function (value) { rejectionMapper = value; }\n    },\n    follow: function (fn, zoneProps) {\n        return new DexiePromise(function (resolve, reject) {\n            return newScope(function (resolve, reject) {\n                var psd = PSD;\n                psd.unhandleds = [];\n                psd.onunhandled = reject;\n                psd.finalize = callBoth(function () {\n                    var _this = this;\n                    run_at_end_of_this_or_next_physical_tick(function () {\n                        _this.unhandleds.length === 0 ? resolve() : reject(_this.unhandleds[0]);\n                    });\n                }, psd.finalize);\n                fn();\n            }, zoneProps, resolve, reject);\n        });\n    }\n});\nif (NativePromise) {\n    if (NativePromise.allSettled)\n        setProp(DexiePromise, \"allSettled\", function () {\n            var possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n            return new DexiePromise(function (resolve) {\n                if (possiblePromises.length === 0)\n                    resolve([]);\n                var remaining = possiblePromises.length;\n                var results = new Array(remaining);\n                possiblePromises.forEach(function (p, i) { return DexiePromise.resolve(p).then(function (value) { return results[i] = { status: \"fulfilled\", value: value }; }, function (reason) { return results[i] = { status: \"rejected\", reason: reason }; })\n                    .then(function () { return --remaining || resolve(results); }); });\n            });\n        });\n    if (NativePromise.any && typeof AggregateError !== 'undefined')\n        setProp(DexiePromise, \"any\", function () {\n            var possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n            return new DexiePromise(function (resolve, reject) {\n                if (possiblePromises.length === 0)\n                    reject(new AggregateError([]));\n                var remaining = possiblePromises.length;\n                var failures = new Array(remaining);\n                possiblePromises.forEach(function (p, i) { return DexiePromise.resolve(p).then(function (value) { return resolve(value); }, function (failure) {\n                    failures[i] = failure;\n                    if (!--remaining)\n                        reject(new AggregateError(failures));\n                }); });\n            });\n        });\n}\nfunction executePromiseTask(promise, fn) {\n    try {\n        fn(function (value) {\n            if (promise._state !== null)\n                return;\n            if (value === promise)\n                throw new TypeError('A promise cannot be resolved with itself.');\n            var shouldExecuteTick = promise._lib && beginMicroTickScope();\n            if (value && typeof value.then === 'function') {\n                executePromiseTask(promise, function (resolve, reject) {\n                    value instanceof DexiePromise ?\n                        value._then(resolve, reject) :\n                        value.then(resolve, reject);\n                });\n            }\n            else {\n                promise._state = true;\n                promise._value = value;\n                propagateAllListeners(promise);\n            }\n            if (shouldExecuteTick)\n                endMicroTickScope();\n        }, handleRejection.bind(null, promise));\n    }\n    catch (ex) {\n        handleRejection(promise, ex);\n    }\n}\nfunction handleRejection(promise, reason) {\n    rejectingErrors.push(reason);\n    if (promise._state !== null)\n        return;\n    var shouldExecuteTick = promise._lib && beginMicroTickScope();\n    reason = rejectionMapper(reason);\n    promise._state = false;\n    promise._value = reason;\n    debug && reason !== null && typeof reason === 'object' && !reason._promise && tryCatch(function () {\n        var origProp = getPropertyDescriptor(reason, \"stack\");\n        reason._promise = promise;\n        setProp(reason, \"stack\", {\n            get: function () {\n                return stack_being_generated ?\n                    origProp && (origProp.get ?\n                        origProp.get.apply(reason) :\n                        origProp.value) :\n                    promise.stack;\n            }\n        });\n    });\n    addPossiblyUnhandledError(promise);\n    propagateAllListeners(promise);\n    if (shouldExecuteTick)\n        endMicroTickScope();\n}\nfunction propagateAllListeners(promise) {\n    var listeners = promise._listeners;\n    promise._listeners = [];\n    for (var i = 0, len = listeners.length; i < len; ++i) {\n        propagateToListener(promise, listeners[i]);\n    }\n    var psd = promise._PSD;\n    --psd.ref || psd.finalize();\n    if (numScheduledCalls === 0) {\n        ++numScheduledCalls;\n        asap(function () {\n            if (--numScheduledCalls === 0)\n                finalizePhysicalTick();\n        }, []);\n    }\n}\nfunction propagateToListener(promise, listener) {\n    if (promise._state === null) {\n        promise._listeners.push(listener);\n        return;\n    }\n    var cb = promise._state ? listener.onFulfilled : listener.onRejected;\n    if (cb === null) {\n        return (promise._state ? listener.resolve : listener.reject)(promise._value);\n    }\n    ++listener.psd.ref;\n    ++numScheduledCalls;\n    asap(callListener, [cb, promise, listener]);\n}\nfunction callListener(cb, promise, listener) {\n    try {\n        currentFulfiller = promise;\n        var ret, value = promise._value;\n        if (promise._state) {\n            ret = cb(value);\n        }\n        else {\n            if (rejectingErrors.length)\n                rejectingErrors = [];\n            ret = cb(value);\n            if (rejectingErrors.indexOf(value) === -1)\n                markErrorAsHandled(promise);\n        }\n        listener.resolve(ret);\n    }\n    catch (e) {\n        listener.reject(e);\n    }\n    finally {\n        currentFulfiller = null;\n        if (--numScheduledCalls === 0)\n            finalizePhysicalTick();\n        --listener.psd.ref || listener.psd.finalize();\n    }\n}\nfunction getStack(promise, stacks, limit) {\n    if (stacks.length === limit)\n        return stacks;\n    var stack = \"\";\n    if (promise._state === false) {\n        var failure = promise._value, errorName, message;\n        if (failure != null) {\n            errorName = failure.name || \"Error\";\n            message = failure.message || failure;\n            stack = prettyStack(failure, 0);\n        }\n        else {\n            errorName = failure;\n            message = \"\";\n        }\n        stacks.push(errorName + (message ? \": \" + message : \"\") + stack);\n    }\n    if (debug) {\n        stack = prettyStack(promise._stackHolder, 2);\n        if (stack && stacks.indexOf(stack) === -1)\n            stacks.push(stack);\n        if (promise._prev)\n            getStack(promise._prev, stacks, limit);\n    }\n    return stacks;\n}\nfunction linkToPreviousPromise(promise, prev) {\n    var numPrev = prev ? prev._numPrev + 1 : 0;\n    if (numPrev < LONG_STACKS_CLIP_LIMIT) {\n        promise._prev = prev;\n        promise._numPrev = numPrev;\n    }\n}\nfunction physicalTick() {\n    beginMicroTickScope() && endMicroTickScope();\n}\nfunction beginMicroTickScope() {\n    var wasRootExec = isOutsideMicroTick;\n    isOutsideMicroTick = false;\n    needsNewPhysicalTick = false;\n    return wasRootExec;\n}\nfunction endMicroTickScope() {\n    var callbacks, i, l;\n    do {\n        while (microtickQueue.length > 0) {\n            callbacks = microtickQueue;\n            microtickQueue = [];\n            l = callbacks.length;\n            for (i = 0; i < l; ++i) {\n                var item = callbacks[i];\n                item[0].apply(null, item[1]);\n            }\n        }\n    } while (microtickQueue.length > 0);\n    isOutsideMicroTick = true;\n    needsNewPhysicalTick = true;\n}\nfunction finalizePhysicalTick() {\n    var unhandledErrs = unhandledErrors;\n    unhandledErrors = [];\n    unhandledErrs.forEach(function (p) {\n        p._PSD.onunhandled.call(null, p._value, p);\n    });\n    var finalizers = tickFinalizers.slice(0);\n    var i = finalizers.length;\n    while (i)\n        finalizers[--i]();\n}\nfunction run_at_end_of_this_or_next_physical_tick(fn) {\n    function finalizer() {\n        fn();\n        tickFinalizers.splice(tickFinalizers.indexOf(finalizer), 1);\n    }\n    tickFinalizers.push(finalizer);\n    ++numScheduledCalls;\n    asap(function () {\n        if (--numScheduledCalls === 0)\n            finalizePhysicalTick();\n    }, []);\n}\nfunction addPossiblyUnhandledError(promise) {\n    if (!unhandledErrors.some(function (p) { return p._value === promise._value; }))\n        unhandledErrors.push(promise);\n}\nfunction markErrorAsHandled(promise) {\n    var i = unhandledErrors.length;\n    while (i)\n        if (unhandledErrors[--i]._value === promise._value) {\n            unhandledErrors.splice(i, 1);\n            return;\n        }\n}\nfunction PromiseReject(reason) {\n    return new DexiePromise(INTERNAL, false, reason);\n}\nfunction wrap(fn, errorCatcher) {\n    var psd = PSD;\n    return function () {\n        var wasRootExec = beginMicroTickScope(), outerScope = PSD;\n        try {\n            switchToZone(psd, true);\n            return fn.apply(this, arguments);\n        }\n        catch (e) {\n            errorCatcher && errorCatcher(e);\n        }\n        finally {\n            switchToZone(outerScope, false);\n            if (wasRootExec)\n                endMicroTickScope();\n        }\n    };\n}\nvar task = { awaits: 0, echoes: 0, id: 0 };\nvar taskCounter = 0;\nvar zoneStack = [];\nvar zoneEchoes = 0;\nvar totalEchoes = 0;\nvar zone_id_counter = 0;\nfunction newScope(fn, props, a1, a2) {\n    var parent = PSD, psd = Object.create(parent);\n    psd.parent = parent;\n    psd.ref = 0;\n    psd.global = false;\n    psd.id = ++zone_id_counter;\n    var globalEnv = globalPSD.env;\n    psd.env = patchGlobalPromise ? {\n        Promise: DexiePromise,\n        PromiseProp: { value: DexiePromise, configurable: true, writable: true },\n        all: DexiePromise.all,\n        race: DexiePromise.race,\n        allSettled: DexiePromise.allSettled,\n        any: DexiePromise.any,\n        resolve: DexiePromise.resolve,\n        reject: DexiePromise.reject,\n        nthen: getPatchedPromiseThen(globalEnv.nthen, psd),\n        gthen: getPatchedPromiseThen(globalEnv.gthen, psd)\n    } : {};\n    if (props)\n        extend(psd, props);\n    ++parent.ref;\n    psd.finalize = function () {\n        --this.parent.ref || this.parent.finalize();\n    };\n    var rv = usePSD(psd, fn, a1, a2);\n    if (psd.ref === 0)\n        psd.finalize();\n    return rv;\n}\nfunction incrementExpectedAwaits() {\n    if (!task.id)\n        task.id = ++taskCounter;\n    ++task.awaits;\n    task.echoes += ZONE_ECHO_LIMIT;\n    return task.id;\n}\nfunction decrementExpectedAwaits() {\n    if (!task.awaits)\n        return false;\n    if (--task.awaits === 0)\n        task.id = 0;\n    task.echoes = task.awaits * ZONE_ECHO_LIMIT;\n    return true;\n}\nif (('' + nativePromiseThen).indexOf('[native code]') === -1) {\n    incrementExpectedAwaits = decrementExpectedAwaits = nop;\n}\nfunction onPossibleParallellAsync(possiblePromise) {\n    if (task.echoes && possiblePromise && possiblePromise.constructor === NativePromise) {\n        incrementExpectedAwaits();\n        return possiblePromise.then(function (x) {\n            decrementExpectedAwaits();\n            return x;\n        }, function (e) {\n            decrementExpectedAwaits();\n            return rejection(e);\n        });\n    }\n    return possiblePromise;\n}\nfunction zoneEnterEcho(targetZone) {\n    ++totalEchoes;\n    if (!task.echoes || --task.echoes === 0) {\n        task.echoes = task.id = 0;\n    }\n    zoneStack.push(PSD);\n    switchToZone(targetZone, true);\n}\nfunction zoneLeaveEcho() {\n    var zone = zoneStack[zoneStack.length - 1];\n    zoneStack.pop();\n    switchToZone(zone, false);\n}\nfunction switchToZone(targetZone, bEnteringZone) {\n    var currentZone = PSD;\n    if (bEnteringZone ? task.echoes && (!zoneEchoes++ || targetZone !== PSD) : zoneEchoes && (!--zoneEchoes || targetZone !== PSD)) {\n        enqueueNativeMicroTask(bEnteringZone ? zoneEnterEcho.bind(null, targetZone) : zoneLeaveEcho);\n    }\n    if (targetZone === PSD)\n        return;\n    PSD = targetZone;\n    if (currentZone === globalPSD)\n        globalPSD.env = snapShot();\n    if (patchGlobalPromise) {\n        var GlobalPromise_1 = globalPSD.env.Promise;\n        var targetEnv = targetZone.env;\n        nativePromiseProto.then = targetEnv.nthen;\n        GlobalPromise_1.prototype.then = targetEnv.gthen;\n        if (currentZone.global || targetZone.global) {\n            Object.defineProperty(_global, 'Promise', targetEnv.PromiseProp);\n            GlobalPromise_1.all = targetEnv.all;\n            GlobalPromise_1.race = targetEnv.race;\n            GlobalPromise_1.resolve = targetEnv.resolve;\n            GlobalPromise_1.reject = targetEnv.reject;\n            if (targetEnv.allSettled)\n                GlobalPromise_1.allSettled = targetEnv.allSettled;\n            if (targetEnv.any)\n                GlobalPromise_1.any = targetEnv.any;\n        }\n    }\n}\nfunction snapShot() {\n    var GlobalPromise = _global.Promise;\n    return patchGlobalPromise ? {\n        Promise: GlobalPromise,\n        PromiseProp: Object.getOwnPropertyDescriptor(_global, \"Promise\"),\n        all: GlobalPromise.all,\n        race: GlobalPromise.race,\n        allSettled: GlobalPromise.allSettled,\n        any: GlobalPromise.any,\n        resolve: GlobalPromise.resolve,\n        reject: GlobalPromise.reject,\n        nthen: nativePromiseProto.then,\n        gthen: GlobalPromise.prototype.then\n    } : {};\n}\nfunction usePSD(psd, fn, a1, a2, a3) {\n    var outerScope = PSD;\n    try {\n        switchToZone(psd, true);\n        return fn(a1, a2, a3);\n    }\n    finally {\n        switchToZone(outerScope, false);\n    }\n}\nfunction enqueueNativeMicroTask(job) {\n    nativePromiseThen.call(resolvedNativePromise, job);\n}\nfunction nativeAwaitCompatibleWrap(fn, zone, possibleAwait, cleanup) {\n    return typeof fn !== 'function' ? fn : function () {\n        var outerZone = PSD;\n        if (possibleAwait)\n            incrementExpectedAwaits();\n        switchToZone(zone, true);\n        try {\n            return fn.apply(this, arguments);\n        }\n        finally {\n            switchToZone(outerZone, false);\n            if (cleanup)\n                enqueueNativeMicroTask(decrementExpectedAwaits);\n        }\n    };\n}\nfunction getPatchedPromiseThen(origThen, zone) {\n    return function (onResolved, onRejected) {\n        return origThen.call(this, nativeAwaitCompatibleWrap(onResolved, zone), nativeAwaitCompatibleWrap(onRejected, zone));\n    };\n}\nvar UNHANDLEDREJECTION = \"unhandledrejection\";\nfunction globalError(err, promise) {\n    var rv;\n    try {\n        rv = promise.onuncatched(err);\n    }\n    catch (e) { }\n    if (rv !== false)\n        try {\n            var event, eventData = { promise: promise, reason: err };\n            if (_global.document && document.createEvent) {\n                event = document.createEvent('Event');\n                event.initEvent(UNHANDLEDREJECTION, true, true);\n                extend(event, eventData);\n            }\n            else if (_global.CustomEvent) {\n                event = new CustomEvent(UNHANDLEDREJECTION, { detail: eventData });\n                extend(event, eventData);\n            }\n            if (event && _global.dispatchEvent) {\n                dispatchEvent(event);\n                if (!_global.PromiseRejectionEvent && _global.onunhandledrejection)\n                    try {\n                        _global.onunhandledrejection(event);\n                    }\n                    catch (_) { }\n            }\n            if (debug && event && !event.defaultPrevented) {\n                console.warn(\"Unhandled rejection: \" + (err.stack || err));\n            }\n        }\n        catch (e) { }\n}\nvar rejection = DexiePromise.reject;\n\nfunction tempTransaction(db, mode, storeNames, fn) {\n    if (!db.idbdb || (!db._state.openComplete && (!PSD.letThrough && !db._vip))) {\n        if (db._state.openComplete) {\n            return rejection(new exceptions.DatabaseClosed(db._state.dbOpenError));\n        }\n        if (!db._state.isBeingOpened) {\n            if (!db._options.autoOpen)\n                return rejection(new exceptions.DatabaseClosed());\n            db.open().catch(nop);\n        }\n        return db._state.dbReadyPromise.then(function () { return tempTransaction(db, mode, storeNames, fn); });\n    }\n    else {\n        var trans = db._createTransaction(mode, storeNames, db._dbSchema);\n        try {\n            trans.create();\n            db._state.PR1398_maxLoop = 3;\n        }\n        catch (ex) {\n            if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n                console.warn('Dexie: Need to reopen db');\n                db._close();\n                return db.open().then(function () { return tempTransaction(db, mode, storeNames, fn); });\n            }\n            return rejection(ex);\n        }\n        return trans._promise(mode, function (resolve, reject) {\n            return newScope(function () {\n                PSD.trans = trans;\n                return fn(resolve, reject, trans);\n            });\n        }).then(function (result) {\n            return trans._completion.then(function () { return result; });\n        });\n    }\n}\n\nvar DEXIE_VERSION = '3.2.3';\nvar maxString = String.fromCharCode(65535);\nvar minKey = -Infinity;\nvar INVALID_KEY_ARGUMENT = \"Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.\";\nvar STRING_EXPECTED = \"String expected.\";\nvar connections = [];\nvar isIEOrEdge = typeof navigator !== 'undefined' && /(MSIE|Trident|Edge)/.test(navigator.userAgent);\nvar hasIEDeleteObjectStoreBug = isIEOrEdge;\nvar hangsOnDeleteLargeKeyRange = isIEOrEdge;\nvar dexieStackFrameFilter = function (frame) { return !/(dexie\\.js|dexie\\.min\\.js)/.test(frame); };\nvar DBNAMES_DB = '__dbnames';\nvar READONLY = 'readonly';\nvar READWRITE = 'readwrite';\n\nfunction combine(filter1, filter2) {\n    return filter1 ?\n        filter2 ?\n            function () { return filter1.apply(this, arguments) && filter2.apply(this, arguments); } :\n            filter1 :\n        filter2;\n}\n\nvar AnyRange = {\n    type: 3 ,\n    lower: -Infinity,\n    lowerOpen: false,\n    upper: [[]],\n    upperOpen: false\n};\n\nfunction workaroundForUndefinedPrimKey(keyPath) {\n    return typeof keyPath === \"string\" && !/\\./.test(keyPath)\n        ? function (obj) {\n            if (obj[keyPath] === undefined && (keyPath in obj)) {\n                obj = deepClone(obj);\n                delete obj[keyPath];\n            }\n            return obj;\n        }\n        : function (obj) { return obj; };\n}\n\nvar Table =  (function () {\n    function Table() {\n    }\n    Table.prototype._trans = function (mode, fn, writeLocked) {\n        var trans = this._tx || PSD.trans;\n        var tableName = this.name;\n        function checkTableInTransaction(resolve, reject, trans) {\n            if (!trans.schema[tableName])\n                throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n            return fn(trans.idbtrans, trans);\n        }\n        var wasRootExec = beginMicroTickScope();\n        try {\n            return trans && trans.db === this.db ?\n                trans === PSD.trans ?\n                    trans._promise(mode, checkTableInTransaction, writeLocked) :\n                    newScope(function () { return trans._promise(mode, checkTableInTransaction, writeLocked); }, { trans: trans, transless: PSD.transless || PSD }) :\n                tempTransaction(this.db, mode, [this.name], checkTableInTransaction);\n        }\n        finally {\n            if (wasRootExec)\n                endMicroTickScope();\n        }\n    };\n    Table.prototype.get = function (keyOrCrit, cb) {\n        var _this = this;\n        if (keyOrCrit && keyOrCrit.constructor === Object)\n            return this.where(keyOrCrit).first(cb);\n        return this._trans('readonly', function (trans) {\n            return _this.core.get({ trans: trans, key: keyOrCrit })\n                .then(function (res) { return _this.hook.reading.fire(res); });\n        }).then(cb);\n    };\n    Table.prototype.where = function (indexOrCrit) {\n        if (typeof indexOrCrit === 'string')\n            return new this.db.WhereClause(this, indexOrCrit);\n        if (isArray(indexOrCrit))\n            return new this.db.WhereClause(this, \"[\" + indexOrCrit.join('+') + \"]\");\n        var keyPaths = keys(indexOrCrit);\n        if (keyPaths.length === 1)\n            return this\n                .where(keyPaths[0])\n                .equals(indexOrCrit[keyPaths[0]]);\n        var compoundIndex = this.schema.indexes.concat(this.schema.primKey).filter(function (ix) {\n            return ix.compound &&\n                keyPaths.every(function (keyPath) { return ix.keyPath.indexOf(keyPath) >= 0; }) &&\n                ix.keyPath.every(function (keyPath) { return keyPaths.indexOf(keyPath) >= 0; });\n        })[0];\n        if (compoundIndex && this.db._maxKey !== maxString)\n            return this\n                .where(compoundIndex.name)\n                .equals(compoundIndex.keyPath.map(function (kp) { return indexOrCrit[kp]; }));\n        if (!compoundIndex && debug)\n            console.warn(\"The query \" + JSON.stringify(indexOrCrit) + \" on \" + this.name + \" would benefit of a \" +\n                (\"compound index [\" + keyPaths.join('+') + \"]\"));\n        var idxByName = this.schema.idxByName;\n        var idb = this.db._deps.indexedDB;\n        function equals(a, b) {\n            try {\n                return idb.cmp(a, b) === 0;\n            }\n            catch (e) {\n                return false;\n            }\n        }\n        var _a = keyPaths.reduce(function (_a, keyPath) {\n            var prevIndex = _a[0], prevFilterFn = _a[1];\n            var index = idxByName[keyPath];\n            var value = indexOrCrit[keyPath];\n            return [\n                prevIndex || index,\n                prevIndex || !index ?\n                    combine(prevFilterFn, index && index.multi ?\n                        function (x) {\n                            var prop = getByKeyPath(x, keyPath);\n                            return isArray(prop) && prop.some(function (item) { return equals(value, item); });\n                        } : function (x) { return equals(value, getByKeyPath(x, keyPath)); })\n                    : prevFilterFn\n            ];\n        }, [null, null]), idx = _a[0], filterFunction = _a[1];\n        return idx ?\n            this.where(idx.name).equals(indexOrCrit[idx.keyPath])\n                .filter(filterFunction) :\n            compoundIndex ?\n                this.filter(filterFunction) :\n                this.where(keyPaths).equals('');\n    };\n    Table.prototype.filter = function (filterFunction) {\n        return this.toCollection().and(filterFunction);\n    };\n    Table.prototype.count = function (thenShortcut) {\n        return this.toCollection().count(thenShortcut);\n    };\n    Table.prototype.offset = function (offset) {\n        return this.toCollection().offset(offset);\n    };\n    Table.prototype.limit = function (numRows) {\n        return this.toCollection().limit(numRows);\n    };\n    Table.prototype.each = function (callback) {\n        return this.toCollection().each(callback);\n    };\n    Table.prototype.toArray = function (thenShortcut) {\n        return this.toCollection().toArray(thenShortcut);\n    };\n    Table.prototype.toCollection = function () {\n        return new this.db.Collection(new this.db.WhereClause(this));\n    };\n    Table.prototype.orderBy = function (index) {\n        return new this.db.Collection(new this.db.WhereClause(this, isArray(index) ?\n            \"[\" + index.join('+') + \"]\" :\n            index));\n    };\n    Table.prototype.reverse = function () {\n        return this.toCollection().reverse();\n    };\n    Table.prototype.mapToClass = function (constructor) {\n        this.schema.mappedClass = constructor;\n        var readHook = function (obj) {\n            if (!obj)\n                return obj;\n            var res = Object.create(constructor.prototype);\n            for (var m in obj)\n                if (hasOwn(obj, m))\n                    try {\n                        res[m] = obj[m];\n                    }\n                    catch (_) { }\n            return res;\n        };\n        if (this.schema.readHook) {\n            this.hook.reading.unsubscribe(this.schema.readHook);\n        }\n        this.schema.readHook = readHook;\n        this.hook(\"reading\", readHook);\n        return constructor;\n    };\n    Table.prototype.defineClass = function () {\n        function Class(content) {\n            extend(this, content);\n        }\n        return this.mapToClass(Class);\n    };\n    Table.prototype.add = function (obj, key) {\n        var _this = this;\n        var _a = this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n        var objToAdd = obj;\n        if (keyPath && auto) {\n            objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n        }\n        return this._trans('readwrite', function (trans) {\n            return _this.core.mutate({ trans: trans, type: 'add', keys: key != null ? [key] : null, values: [objToAdd] });\n        }).then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult; })\n            .then(function (lastResult) {\n            if (keyPath) {\n                try {\n                    setByKeyPath(obj, keyPath, lastResult);\n                }\n                catch (_) { }\n            }\n            return lastResult;\n        });\n    };\n    Table.prototype.update = function (keyOrObject, modifications) {\n        if (typeof keyOrObject === 'object' && !isArray(keyOrObject)) {\n            var key = getByKeyPath(keyOrObject, this.schema.primKey.keyPath);\n            if (key === undefined)\n                return rejection(new exceptions.InvalidArgument(\"Given object does not contain its primary key\"));\n            try {\n                if (typeof modifications !== \"function\") {\n                    keys(modifications).forEach(function (keyPath) {\n                        setByKeyPath(keyOrObject, keyPath, modifications[keyPath]);\n                    });\n                }\n                else {\n                    modifications(keyOrObject, { value: keyOrObject, primKey: key });\n                }\n            }\n            catch (_a) {\n            }\n            return this.where(\":id\").equals(key).modify(modifications);\n        }\n        else {\n            return this.where(\":id\").equals(keyOrObject).modify(modifications);\n        }\n    };\n    Table.prototype.put = function (obj, key) {\n        var _this = this;\n        var _a = this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n        var objToAdd = obj;\n        if (keyPath && auto) {\n            objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n        }\n        return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'put', values: [objToAdd], keys: key != null ? [key] : null }); })\n            .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult; })\n            .then(function (lastResult) {\n            if (keyPath) {\n                try {\n                    setByKeyPath(obj, keyPath, lastResult);\n                }\n                catch (_) { }\n            }\n            return lastResult;\n        });\n    };\n    Table.prototype.delete = function (key) {\n        var _this = this;\n        return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'delete', keys: [key] }); })\n            .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined; });\n    };\n    Table.prototype.clear = function () {\n        var _this = this;\n        return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'deleteRange', range: AnyRange }); })\n            .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined; });\n    };\n    Table.prototype.bulkGet = function (keys) {\n        var _this = this;\n        return this._trans('readonly', function (trans) {\n            return _this.core.getMany({\n                keys: keys,\n                trans: trans\n            }).then(function (result) { return result.map(function (res) { return _this.hook.reading.fire(res); }); });\n        });\n    };\n    Table.prototype.bulkAdd = function (objects, keysOrOptions, options) {\n        var _this = this;\n        var keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n        options = options || (keys ? undefined : keysOrOptions);\n        var wantResults = options ? options.allKeys : undefined;\n        return this._trans('readwrite', function (trans) {\n            var _a = _this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n            if (keyPath && keys)\n                throw new exceptions.InvalidArgument(\"bulkAdd(): keys argument invalid on tables with inbound keys\");\n            if (keys && keys.length !== objects.length)\n                throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n            var numObjects = objects.length;\n            var objectsToAdd = keyPath && auto ?\n                objects.map(workaroundForUndefinedPrimKey(keyPath)) :\n                objects;\n            return _this.core.mutate({ trans: trans, type: 'add', keys: keys, values: objectsToAdd, wantResults: wantResults })\n                .then(function (_a) {\n                var numFailures = _a.numFailures, results = _a.results, lastResult = _a.lastResult, failures = _a.failures;\n                var result = wantResults ? results : lastResult;\n                if (numFailures === 0)\n                    return result;\n                throw new BulkError(_this.name + \".bulkAdd(): \" + numFailures + \" of \" + numObjects + \" operations failed\", failures);\n            });\n        });\n    };\n    Table.prototype.bulkPut = function (objects, keysOrOptions, options) {\n        var _this = this;\n        var keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n        options = options || (keys ? undefined : keysOrOptions);\n        var wantResults = options ? options.allKeys : undefined;\n        return this._trans('readwrite', function (trans) {\n            var _a = _this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n            if (keyPath && keys)\n                throw new exceptions.InvalidArgument(\"bulkPut(): keys argument invalid on tables with inbound keys\");\n            if (keys && keys.length !== objects.length)\n                throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n            var numObjects = objects.length;\n            var objectsToPut = keyPath && auto ?\n                objects.map(workaroundForUndefinedPrimKey(keyPath)) :\n                objects;\n            return _this.core.mutate({ trans: trans, type: 'put', keys: keys, values: objectsToPut, wantResults: wantResults })\n                .then(function (_a) {\n                var numFailures = _a.numFailures, results = _a.results, lastResult = _a.lastResult, failures = _a.failures;\n                var result = wantResults ? results : lastResult;\n                if (numFailures === 0)\n                    return result;\n                throw new BulkError(_this.name + \".bulkPut(): \" + numFailures + \" of \" + numObjects + \" operations failed\", failures);\n            });\n        });\n    };\n    Table.prototype.bulkDelete = function (keys) {\n        var _this = this;\n        var numKeys = keys.length;\n        return this._trans('readwrite', function (trans) {\n            return _this.core.mutate({ trans: trans, type: 'delete', keys: keys });\n        }).then(function (_a) {\n            var numFailures = _a.numFailures, lastResult = _a.lastResult, failures = _a.failures;\n            if (numFailures === 0)\n                return lastResult;\n            throw new BulkError(_this.name + \".bulkDelete(): \" + numFailures + \" of \" + numKeys + \" operations failed\", failures);\n        });\n    };\n    return Table;\n}());\n\nfunction Events(ctx) {\n    var evs = {};\n    var rv = function (eventName, subscriber) {\n        if (subscriber) {\n            var i = arguments.length, args = new Array(i - 1);\n            while (--i)\n                args[i - 1] = arguments[i];\n            evs[eventName].subscribe.apply(null, args);\n            return ctx;\n        }\n        else if (typeof (eventName) === 'string') {\n            return evs[eventName];\n        }\n    };\n    rv.addEventType = add;\n    for (var i = 1, l = arguments.length; i < l; ++i) {\n        add(arguments[i]);\n    }\n    return rv;\n    function add(eventName, chainFunction, defaultFunction) {\n        if (typeof eventName === 'object')\n            return addConfiguredEvents(eventName);\n        if (!chainFunction)\n            chainFunction = reverseStoppableEventChain;\n        if (!defaultFunction)\n            defaultFunction = nop;\n        var context = {\n            subscribers: [],\n            fire: defaultFunction,\n            subscribe: function (cb) {\n                if (context.subscribers.indexOf(cb) === -1) {\n                    context.subscribers.push(cb);\n                    context.fire = chainFunction(context.fire, cb);\n                }\n            },\n            unsubscribe: function (cb) {\n                context.subscribers = context.subscribers.filter(function (fn) { return fn !== cb; });\n                context.fire = context.subscribers.reduce(chainFunction, defaultFunction);\n            }\n        };\n        evs[eventName] = rv[eventName] = context;\n        return context;\n    }\n    function addConfiguredEvents(cfg) {\n        keys(cfg).forEach(function (eventName) {\n            var args = cfg[eventName];\n            if (isArray(args)) {\n                add(eventName, cfg[eventName][0], cfg[eventName][1]);\n            }\n            else if (args === 'asap') {\n                var context = add(eventName, mirror, function fire() {\n                    var i = arguments.length, args = new Array(i);\n                    while (i--)\n                        args[i] = arguments[i];\n                    context.subscribers.forEach(function (fn) {\n                        asap$1(function fireEvent() {\n                            fn.apply(null, args);\n                        });\n                    });\n                });\n            }\n            else\n                throw new exceptions.InvalidArgument(\"Invalid event config\");\n        });\n    }\n}\n\nfunction makeClassConstructor(prototype, constructor) {\n    derive(constructor).from({ prototype: prototype });\n    return constructor;\n}\n\nfunction createTableConstructor(db) {\n    return makeClassConstructor(Table.prototype, function Table(name, tableSchema, trans) {\n        this.db = db;\n        this._tx = trans;\n        this.name = name;\n        this.schema = tableSchema;\n        this.hook = db._allTables[name] ? db._allTables[name].hook : Events(null, {\n            \"creating\": [hookCreatingChain, nop],\n            \"reading\": [pureFunctionChain, mirror],\n            \"updating\": [hookUpdatingChain, nop],\n            \"deleting\": [hookDeletingChain, nop]\n        });\n    });\n}\n\nfunction isPlainKeyRange(ctx, ignoreLimitFilter) {\n    return !(ctx.filter || ctx.algorithm || ctx.or) &&\n        (ignoreLimitFilter ? ctx.justLimit : !ctx.replayFilter);\n}\nfunction addFilter(ctx, fn) {\n    ctx.filter = combine(ctx.filter, fn);\n}\nfunction addReplayFilter(ctx, factory, isLimitFilter) {\n    var curr = ctx.replayFilter;\n    ctx.replayFilter = curr ? function () { return combine(curr(), factory()); } : factory;\n    ctx.justLimit = isLimitFilter && !curr;\n}\nfunction addMatchFilter(ctx, fn) {\n    ctx.isMatch = combine(ctx.isMatch, fn);\n}\nfunction getIndexOrStore(ctx, coreSchema) {\n    if (ctx.isPrimKey)\n        return coreSchema.primaryKey;\n    var index = coreSchema.getIndexByKeyPath(ctx.index);\n    if (!index)\n        throw new exceptions.Schema(\"KeyPath \" + ctx.index + \" on object store \" + coreSchema.name + \" is not indexed\");\n    return index;\n}\nfunction openCursor(ctx, coreTable, trans) {\n    var index = getIndexOrStore(ctx, coreTable.schema);\n    return coreTable.openCursor({\n        trans: trans,\n        values: !ctx.keysOnly,\n        reverse: ctx.dir === 'prev',\n        unique: !!ctx.unique,\n        query: {\n            index: index,\n            range: ctx.range\n        }\n    });\n}\nfunction iter(ctx, fn, coreTrans, coreTable) {\n    var filter = ctx.replayFilter ? combine(ctx.filter, ctx.replayFilter()) : ctx.filter;\n    if (!ctx.or) {\n        return iterate(openCursor(ctx, coreTable, coreTrans), combine(ctx.algorithm, filter), fn, !ctx.keysOnly && ctx.valueMapper);\n    }\n    else {\n        var set_1 = {};\n        var union = function (item, cursor, advance) {\n            if (!filter || filter(cursor, advance, function (result) { return cursor.stop(result); }, function (err) { return cursor.fail(err); })) {\n                var primaryKey = cursor.primaryKey;\n                var key = '' + primaryKey;\n                if (key === '[object ArrayBuffer]')\n                    key = '' + new Uint8Array(primaryKey);\n                if (!hasOwn(set_1, key)) {\n                    set_1[key] = true;\n                    fn(item, cursor, advance);\n                }\n            }\n        };\n        return Promise.all([\n            ctx.or._iterate(union, coreTrans),\n            iterate(openCursor(ctx, coreTable, coreTrans), ctx.algorithm, union, !ctx.keysOnly && ctx.valueMapper)\n        ]);\n    }\n}\nfunction iterate(cursorPromise, filter, fn, valueMapper) {\n    var mappedFn = valueMapper ? function (x, c, a) { return fn(valueMapper(x), c, a); } : fn;\n    var wrappedFn = wrap(mappedFn);\n    return cursorPromise.then(function (cursor) {\n        if (cursor) {\n            return cursor.start(function () {\n                var c = function () { return cursor.continue(); };\n                if (!filter || filter(cursor, function (advancer) { return c = advancer; }, function (val) { cursor.stop(val); c = nop; }, function (e) { cursor.fail(e); c = nop; }))\n                    wrappedFn(cursor.value, cursor, function (advancer) { return c = advancer; });\n                c();\n            });\n        }\n    });\n}\n\nfunction cmp(a, b) {\n    try {\n        var ta = type(a);\n        var tb = type(b);\n        if (ta !== tb) {\n            if (ta === 'Array')\n                return 1;\n            if (tb === 'Array')\n                return -1;\n            if (ta === 'binary')\n                return 1;\n            if (tb === 'binary')\n                return -1;\n            if (ta === 'string')\n                return 1;\n            if (tb === 'string')\n                return -1;\n            if (ta === 'Date')\n                return 1;\n            if (tb !== 'Date')\n                return NaN;\n            return -1;\n        }\n        switch (ta) {\n            case 'number':\n            case 'Date':\n            case 'string':\n                return a > b ? 1 : a < b ? -1 : 0;\n            case 'binary': {\n                return compareUint8Arrays(getUint8Array(a), getUint8Array(b));\n            }\n            case 'Array':\n                return compareArrays(a, b);\n        }\n    }\n    catch (_a) { }\n    return NaN;\n}\nfunction compareArrays(a, b) {\n    var al = a.length;\n    var bl = b.length;\n    var l = al < bl ? al : bl;\n    for (var i = 0; i < l; ++i) {\n        var res = cmp(a[i], b[i]);\n        if (res !== 0)\n            return res;\n    }\n    return al === bl ? 0 : al < bl ? -1 : 1;\n}\nfunction compareUint8Arrays(a, b) {\n    var al = a.length;\n    var bl = b.length;\n    var l = al < bl ? al : bl;\n    for (var i = 0; i < l; ++i) {\n        if (a[i] !== b[i])\n            return a[i] < b[i] ? -1 : 1;\n    }\n    return al === bl ? 0 : al < bl ? -1 : 1;\n}\nfunction type(x) {\n    var t = typeof x;\n    if (t !== 'object')\n        return t;\n    if (ArrayBuffer.isView(x))\n        return 'binary';\n    var tsTag = toStringTag(x);\n    return tsTag === 'ArrayBuffer' ? 'binary' : tsTag;\n}\nfunction getUint8Array(a) {\n    if (a instanceof Uint8Array)\n        return a;\n    if (ArrayBuffer.isView(a))\n        return new Uint8Array(a.buffer, a.byteOffset, a.byteLength);\n    return new Uint8Array(a);\n}\n\nvar Collection =  (function () {\n    function Collection() {\n    }\n    Collection.prototype._read = function (fn, cb) {\n        var ctx = this._ctx;\n        return ctx.error ?\n            ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n            ctx.table._trans('readonly', fn).then(cb);\n    };\n    Collection.prototype._write = function (fn) {\n        var ctx = this._ctx;\n        return ctx.error ?\n            ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n            ctx.table._trans('readwrite', fn, \"locked\");\n    };\n    Collection.prototype._addAlgorithm = function (fn) {\n        var ctx = this._ctx;\n        ctx.algorithm = combine(ctx.algorithm, fn);\n    };\n    Collection.prototype._iterate = function (fn, coreTrans) {\n        return iter(this._ctx, fn, coreTrans, this._ctx.table.core);\n    };\n    Collection.prototype.clone = function (props) {\n        var rv = Object.create(this.constructor.prototype), ctx = Object.create(this._ctx);\n        if (props)\n            extend(ctx, props);\n        rv._ctx = ctx;\n        return rv;\n    };\n    Collection.prototype.raw = function () {\n        this._ctx.valueMapper = null;\n        return this;\n    };\n    Collection.prototype.each = function (fn) {\n        var ctx = this._ctx;\n        return this._read(function (trans) { return iter(ctx, fn, trans, ctx.table.core); });\n    };\n    Collection.prototype.count = function (cb) {\n        var _this = this;\n        return this._read(function (trans) {\n            var ctx = _this._ctx;\n            var coreTable = ctx.table.core;\n            if (isPlainKeyRange(ctx, true)) {\n                return coreTable.count({\n                    trans: trans,\n                    query: {\n                        index: getIndexOrStore(ctx, coreTable.schema),\n                        range: ctx.range\n                    }\n                }).then(function (count) { return Math.min(count, ctx.limit); });\n            }\n            else {\n                var count = 0;\n                return iter(ctx, function () { ++count; return false; }, trans, coreTable)\n                    .then(function () { return count; });\n            }\n        }).then(cb);\n    };\n    Collection.prototype.sortBy = function (keyPath, cb) {\n        var parts = keyPath.split('.').reverse(), lastPart = parts[0], lastIndex = parts.length - 1;\n        function getval(obj, i) {\n            if (i)\n                return getval(obj[parts[i]], i - 1);\n            return obj[lastPart];\n        }\n        var order = this._ctx.dir === \"next\" ? 1 : -1;\n        function sorter(a, b) {\n            var aVal = getval(a, lastIndex), bVal = getval(b, lastIndex);\n            return aVal < bVal ? -order : aVal > bVal ? order : 0;\n        }\n        return this.toArray(function (a) {\n            return a.sort(sorter);\n        }).then(cb);\n    };\n    Collection.prototype.toArray = function (cb) {\n        var _this = this;\n        return this._read(function (trans) {\n            var ctx = _this._ctx;\n            if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n                var valueMapper_1 = ctx.valueMapper;\n                var index = getIndexOrStore(ctx, ctx.table.core.schema);\n                return ctx.table.core.query({\n                    trans: trans,\n                    limit: ctx.limit,\n                    values: true,\n                    query: {\n                        index: index,\n                        range: ctx.range\n                    }\n                }).then(function (_a) {\n                    var result = _a.result;\n                    return valueMapper_1 ? result.map(valueMapper_1) : result;\n                });\n            }\n            else {\n                var a_1 = [];\n                return iter(ctx, function (item) { return a_1.push(item); }, trans, ctx.table.core).then(function () { return a_1; });\n            }\n        }, cb);\n    };\n    Collection.prototype.offset = function (offset) {\n        var ctx = this._ctx;\n        if (offset <= 0)\n            return this;\n        ctx.offset += offset;\n        if (isPlainKeyRange(ctx)) {\n            addReplayFilter(ctx, function () {\n                var offsetLeft = offset;\n                return function (cursor, advance) {\n                    if (offsetLeft === 0)\n                        return true;\n                    if (offsetLeft === 1) {\n                        --offsetLeft;\n                        return false;\n                    }\n                    advance(function () {\n                        cursor.advance(offsetLeft);\n                        offsetLeft = 0;\n                    });\n                    return false;\n                };\n            });\n        }\n        else {\n            addReplayFilter(ctx, function () {\n                var offsetLeft = offset;\n                return function () { return (--offsetLeft < 0); };\n            });\n        }\n        return this;\n    };\n    Collection.prototype.limit = function (numRows) {\n        this._ctx.limit = Math.min(this._ctx.limit, numRows);\n        addReplayFilter(this._ctx, function () {\n            var rowsLeft = numRows;\n            return function (cursor, advance, resolve) {\n                if (--rowsLeft <= 0)\n                    advance(resolve);\n                return rowsLeft >= 0;\n            };\n        }, true);\n        return this;\n    };\n    Collection.prototype.until = function (filterFunction, bIncludeStopEntry) {\n        addFilter(this._ctx, function (cursor, advance, resolve) {\n            if (filterFunction(cursor.value)) {\n                advance(resolve);\n                return bIncludeStopEntry;\n            }\n            else {\n                return true;\n            }\n        });\n        return this;\n    };\n    Collection.prototype.first = function (cb) {\n        return this.limit(1).toArray(function (a) { return a[0]; }).then(cb);\n    };\n    Collection.prototype.last = function (cb) {\n        return this.reverse().first(cb);\n    };\n    Collection.prototype.filter = function (filterFunction) {\n        addFilter(this._ctx, function (cursor) {\n            return filterFunction(cursor.value);\n        });\n        addMatchFilter(this._ctx, filterFunction);\n        return this;\n    };\n    Collection.prototype.and = function (filter) {\n        return this.filter(filter);\n    };\n    Collection.prototype.or = function (indexName) {\n        return new this.db.WhereClause(this._ctx.table, indexName, this);\n    };\n    Collection.prototype.reverse = function () {\n        this._ctx.dir = (this._ctx.dir === \"prev\" ? \"next\" : \"prev\");\n        if (this._ondirectionchange)\n            this._ondirectionchange(this._ctx.dir);\n        return this;\n    };\n    Collection.prototype.desc = function () {\n        return this.reverse();\n    };\n    Collection.prototype.eachKey = function (cb) {\n        var ctx = this._ctx;\n        ctx.keysOnly = !ctx.isMatch;\n        return this.each(function (val, cursor) { cb(cursor.key, cursor); });\n    };\n    Collection.prototype.eachUniqueKey = function (cb) {\n        this._ctx.unique = \"unique\";\n        return this.eachKey(cb);\n    };\n    Collection.prototype.eachPrimaryKey = function (cb) {\n        var ctx = this._ctx;\n        ctx.keysOnly = !ctx.isMatch;\n        return this.each(function (val, cursor) { cb(cursor.primaryKey, cursor); });\n    };\n    Collection.prototype.keys = function (cb) {\n        var ctx = this._ctx;\n        ctx.keysOnly = !ctx.isMatch;\n        var a = [];\n        return this.each(function (item, cursor) {\n            a.push(cursor.key);\n        }).then(function () {\n            return a;\n        }).then(cb);\n    };\n    Collection.prototype.primaryKeys = function (cb) {\n        var ctx = this._ctx;\n        if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n            return this._read(function (trans) {\n                var index = getIndexOrStore(ctx, ctx.table.core.schema);\n                return ctx.table.core.query({\n                    trans: trans,\n                    values: false,\n                    limit: ctx.limit,\n                    query: {\n                        index: index,\n                        range: ctx.range\n                    }\n                });\n            }).then(function (_a) {\n                var result = _a.result;\n                return result;\n            }).then(cb);\n        }\n        ctx.keysOnly = !ctx.isMatch;\n        var a = [];\n        return this.each(function (item, cursor) {\n            a.push(cursor.primaryKey);\n        }).then(function () {\n            return a;\n        }).then(cb);\n    };\n    Collection.prototype.uniqueKeys = function (cb) {\n        this._ctx.unique = \"unique\";\n        return this.keys(cb);\n    };\n    Collection.prototype.firstKey = function (cb) {\n        return this.limit(1).keys(function (a) { return a[0]; }).then(cb);\n    };\n    Collection.prototype.lastKey = function (cb) {\n        return this.reverse().firstKey(cb);\n    };\n    Collection.prototype.distinct = function () {\n        var ctx = this._ctx, idx = ctx.index && ctx.table.schema.idxByName[ctx.index];\n        if (!idx || !idx.multi)\n            return this;\n        var set = {};\n        addFilter(this._ctx, function (cursor) {\n            var strKey = cursor.primaryKey.toString();\n            var found = hasOwn(set, strKey);\n            set[strKey] = true;\n            return !found;\n        });\n        return this;\n    };\n    Collection.prototype.modify = function (changes) {\n        var _this = this;\n        var ctx = this._ctx;\n        return this._write(function (trans) {\n            var modifyer;\n            if (typeof changes === 'function') {\n                modifyer = changes;\n            }\n            else {\n                var keyPaths = keys(changes);\n                var numKeys = keyPaths.length;\n                modifyer = function (item) {\n                    var anythingModified = false;\n                    for (var i = 0; i < numKeys; ++i) {\n                        var keyPath = keyPaths[i], val = changes[keyPath];\n                        if (getByKeyPath(item, keyPath) !== val) {\n                            setByKeyPath(item, keyPath, val);\n                            anythingModified = true;\n                        }\n                    }\n                    return anythingModified;\n                };\n            }\n            var coreTable = ctx.table.core;\n            var _a = coreTable.schema.primaryKey, outbound = _a.outbound, extractKey = _a.extractKey;\n            var limit = _this.db._options.modifyChunkSize || 200;\n            var totalFailures = [];\n            var successCount = 0;\n            var failedKeys = [];\n            var applyMutateResult = function (expectedCount, res) {\n                var failures = res.failures, numFailures = res.numFailures;\n                successCount += expectedCount - numFailures;\n                for (var _i = 0, _a = keys(failures); _i < _a.length; _i++) {\n                    var pos = _a[_i];\n                    totalFailures.push(failures[pos]);\n                }\n            };\n            return _this.clone().primaryKeys().then(function (keys) {\n                var nextChunk = function (offset) {\n                    var count = Math.min(limit, keys.length - offset);\n                    return coreTable.getMany({\n                        trans: trans,\n                        keys: keys.slice(offset, offset + count),\n                        cache: \"immutable\"\n                    }).then(function (values) {\n                        var addValues = [];\n                        var putValues = [];\n                        var putKeys = outbound ? [] : null;\n                        var deleteKeys = [];\n                        for (var i = 0; i < count; ++i) {\n                            var origValue = values[i];\n                            var ctx_1 = {\n                                value: deepClone(origValue),\n                                primKey: keys[offset + i]\n                            };\n                            if (modifyer.call(ctx_1, ctx_1.value, ctx_1) !== false) {\n                                if (ctx_1.value == null) {\n                                    deleteKeys.push(keys[offset + i]);\n                                }\n                                else if (!outbound && cmp(extractKey(origValue), extractKey(ctx_1.value)) !== 0) {\n                                    deleteKeys.push(keys[offset + i]);\n                                    addValues.push(ctx_1.value);\n                                }\n                                else {\n                                    putValues.push(ctx_1.value);\n                                    if (outbound)\n                                        putKeys.push(keys[offset + i]);\n                                }\n                            }\n                        }\n                        var criteria = isPlainKeyRange(ctx) &&\n                            ctx.limit === Infinity &&\n                            (typeof changes !== 'function' || changes === deleteCallback) && {\n                            index: ctx.index,\n                            range: ctx.range\n                        };\n                        return Promise.resolve(addValues.length > 0 &&\n                            coreTable.mutate({ trans: trans, type: 'add', values: addValues })\n                                .then(function (res) {\n                                for (var pos in res.failures) {\n                                    deleteKeys.splice(parseInt(pos), 1);\n                                }\n                                applyMutateResult(addValues.length, res);\n                            })).then(function () { return (putValues.length > 0 || (criteria && typeof changes === 'object')) &&\n                            coreTable.mutate({\n                                trans: trans,\n                                type: 'put',\n                                keys: putKeys,\n                                values: putValues,\n                                criteria: criteria,\n                                changeSpec: typeof changes !== 'function'\n                                    && changes\n                            }).then(function (res) { return applyMutateResult(putValues.length, res); }); }).then(function () { return (deleteKeys.length > 0 || (criteria && changes === deleteCallback)) &&\n                            coreTable.mutate({\n                                trans: trans,\n                                type: 'delete',\n                                keys: deleteKeys,\n                                criteria: criteria\n                            }).then(function (res) { return applyMutateResult(deleteKeys.length, res); }); }).then(function () {\n                            return keys.length > offset + count && nextChunk(offset + limit);\n                        });\n                    });\n                };\n                return nextChunk(0).then(function () {\n                    if (totalFailures.length > 0)\n                        throw new ModifyError(\"Error modifying one or more objects\", totalFailures, successCount, failedKeys);\n                    return keys.length;\n                });\n            });\n        });\n    };\n    Collection.prototype.delete = function () {\n        var ctx = this._ctx, range = ctx.range;\n        if (isPlainKeyRange(ctx) &&\n            ((ctx.isPrimKey && !hangsOnDeleteLargeKeyRange) || range.type === 3 ))\n         {\n            return this._write(function (trans) {\n                var primaryKey = ctx.table.core.schema.primaryKey;\n                var coreRange = range;\n                return ctx.table.core.count({ trans: trans, query: { index: primaryKey, range: coreRange } }).then(function (count) {\n                    return ctx.table.core.mutate({ trans: trans, type: 'deleteRange', range: coreRange })\n                        .then(function (_a) {\n                        var failures = _a.failures; _a.lastResult; _a.results; var numFailures = _a.numFailures;\n                        if (numFailures)\n                            throw new ModifyError(\"Could not delete some values\", Object.keys(failures).map(function (pos) { return failures[pos]; }), count - numFailures);\n                        return count - numFailures;\n                    });\n                });\n            });\n        }\n        return this.modify(deleteCallback);\n    };\n    return Collection;\n}());\nvar deleteCallback = function (value, ctx) { return ctx.value = null; };\n\nfunction createCollectionConstructor(db) {\n    return makeClassConstructor(Collection.prototype, function Collection(whereClause, keyRangeGenerator) {\n        this.db = db;\n        var keyRange = AnyRange, error = null;\n        if (keyRangeGenerator)\n            try {\n                keyRange = keyRangeGenerator();\n            }\n            catch (ex) {\n                error = ex;\n            }\n        var whereCtx = whereClause._ctx;\n        var table = whereCtx.table;\n        var readingHook = table.hook.reading.fire;\n        this._ctx = {\n            table: table,\n            index: whereCtx.index,\n            isPrimKey: (!whereCtx.index || (table.schema.primKey.keyPath && whereCtx.index === table.schema.primKey.name)),\n            range: keyRange,\n            keysOnly: false,\n            dir: \"next\",\n            unique: \"\",\n            algorithm: null,\n            filter: null,\n            replayFilter: null,\n            justLimit: true,\n            isMatch: null,\n            offset: 0,\n            limit: Infinity,\n            error: error,\n            or: whereCtx.or,\n            valueMapper: readingHook !== mirror ? readingHook : null\n        };\n    });\n}\n\nfunction simpleCompare(a, b) {\n    return a < b ? -1 : a === b ? 0 : 1;\n}\nfunction simpleCompareReverse(a, b) {\n    return a > b ? -1 : a === b ? 0 : 1;\n}\n\nfunction fail(collectionOrWhereClause, err, T) {\n    var collection = collectionOrWhereClause instanceof WhereClause ?\n        new collectionOrWhereClause.Collection(collectionOrWhereClause) :\n        collectionOrWhereClause;\n    collection._ctx.error = T ? new T(err) : new TypeError(err);\n    return collection;\n}\nfunction emptyCollection(whereClause) {\n    return new whereClause.Collection(whereClause, function () { return rangeEqual(\"\"); }).limit(0);\n}\nfunction upperFactory(dir) {\n    return dir === \"next\" ?\n        function (s) { return s.toUpperCase(); } :\n        function (s) { return s.toLowerCase(); };\n}\nfunction lowerFactory(dir) {\n    return dir === \"next\" ?\n        function (s) { return s.toLowerCase(); } :\n        function (s) { return s.toUpperCase(); };\n}\nfunction nextCasing(key, lowerKey, upperNeedle, lowerNeedle, cmp, dir) {\n    var length = Math.min(key.length, lowerNeedle.length);\n    var llp = -1;\n    for (var i = 0; i < length; ++i) {\n        var lwrKeyChar = lowerKey[i];\n        if (lwrKeyChar !== lowerNeedle[i]) {\n            if (cmp(key[i], upperNeedle[i]) < 0)\n                return key.substr(0, i) + upperNeedle[i] + upperNeedle.substr(i + 1);\n            if (cmp(key[i], lowerNeedle[i]) < 0)\n                return key.substr(0, i) + lowerNeedle[i] + upperNeedle.substr(i + 1);\n            if (llp >= 0)\n                return key.substr(0, llp) + lowerKey[llp] + upperNeedle.substr(llp + 1);\n            return null;\n        }\n        if (cmp(key[i], lwrKeyChar) < 0)\n            llp = i;\n    }\n    if (length < lowerNeedle.length && dir === \"next\")\n        return key + upperNeedle.substr(key.length);\n    if (length < key.length && dir === \"prev\")\n        return key.substr(0, upperNeedle.length);\n    return (llp < 0 ? null : key.substr(0, llp) + lowerNeedle[llp] + upperNeedle.substr(llp + 1));\n}\nfunction addIgnoreCaseAlgorithm(whereClause, match, needles, suffix) {\n    var upper, lower, compare, upperNeedles, lowerNeedles, direction, nextKeySuffix, needlesLen = needles.length;\n    if (!needles.every(function (s) { return typeof s === 'string'; })) {\n        return fail(whereClause, STRING_EXPECTED);\n    }\n    function initDirection(dir) {\n        upper = upperFactory(dir);\n        lower = lowerFactory(dir);\n        compare = (dir === \"next\" ? simpleCompare : simpleCompareReverse);\n        var needleBounds = needles.map(function (needle) {\n            return { lower: lower(needle), upper: upper(needle) };\n        }).sort(function (a, b) {\n            return compare(a.lower, b.lower);\n        });\n        upperNeedles = needleBounds.map(function (nb) { return nb.upper; });\n        lowerNeedles = needleBounds.map(function (nb) { return nb.lower; });\n        direction = dir;\n        nextKeySuffix = (dir === \"next\" ? \"\" : suffix);\n    }\n    initDirection(\"next\");\n    var c = new whereClause.Collection(whereClause, function () { return createRange(upperNeedles[0], lowerNeedles[needlesLen - 1] + suffix); });\n    c._ondirectionchange = function (direction) {\n        initDirection(direction);\n    };\n    var firstPossibleNeedle = 0;\n    c._addAlgorithm(function (cursor, advance, resolve) {\n        var key = cursor.key;\n        if (typeof key !== 'string')\n            return false;\n        var lowerKey = lower(key);\n        if (match(lowerKey, lowerNeedles, firstPossibleNeedle)) {\n            return true;\n        }\n        else {\n            var lowestPossibleCasing = null;\n            for (var i = firstPossibleNeedle; i < needlesLen; ++i) {\n                var casing = nextCasing(key, lowerKey, upperNeedles[i], lowerNeedles[i], compare, direction);\n                if (casing === null && lowestPossibleCasing === null)\n                    firstPossibleNeedle = i + 1;\n                else if (lowestPossibleCasing === null || compare(lowestPossibleCasing, casing) > 0) {\n                    lowestPossibleCasing = casing;\n                }\n            }\n            if (lowestPossibleCasing !== null) {\n                advance(function () { cursor.continue(lowestPossibleCasing + nextKeySuffix); });\n            }\n            else {\n                advance(resolve);\n            }\n            return false;\n        }\n    });\n    return c;\n}\nfunction createRange(lower, upper, lowerOpen, upperOpen) {\n    return {\n        type: 2 ,\n        lower: lower,\n        upper: upper,\n        lowerOpen: lowerOpen,\n        upperOpen: upperOpen\n    };\n}\nfunction rangeEqual(value) {\n    return {\n        type: 1 ,\n        lower: value,\n        upper: value\n    };\n}\n\nvar WhereClause =  (function () {\n    function WhereClause() {\n    }\n    Object.defineProperty(WhereClause.prototype, \"Collection\", {\n        get: function () {\n            return this._ctx.table.db.Collection;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    WhereClause.prototype.between = function (lower, upper, includeLower, includeUpper) {\n        includeLower = includeLower !== false;\n        includeUpper = includeUpper === true;\n        try {\n            if ((this._cmp(lower, upper) > 0) ||\n                (this._cmp(lower, upper) === 0 && (includeLower || includeUpper) && !(includeLower && includeUpper)))\n                return emptyCollection(this);\n            return new this.Collection(this, function () { return createRange(lower, upper, !includeLower, !includeUpper); });\n        }\n        catch (e) {\n            return fail(this, INVALID_KEY_ARGUMENT);\n        }\n    };\n    WhereClause.prototype.equals = function (value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, function () { return rangeEqual(value); });\n    };\n    WhereClause.prototype.above = function (value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, function () { return createRange(value, undefined, true); });\n    };\n    WhereClause.prototype.aboveOrEqual = function (value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, function () { return createRange(value, undefined, false); });\n    };\n    WhereClause.prototype.below = function (value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, function () { return createRange(undefined, value, false, true); });\n    };\n    WhereClause.prototype.belowOrEqual = function (value) {\n        if (value == null)\n            return fail(this, INVALID_KEY_ARGUMENT);\n        return new this.Collection(this, function () { return createRange(undefined, value); });\n    };\n    WhereClause.prototype.startsWith = function (str) {\n        if (typeof str !== 'string')\n            return fail(this, STRING_EXPECTED);\n        return this.between(str, str + maxString, true, true);\n    };\n    WhereClause.prototype.startsWithIgnoreCase = function (str) {\n        if (str === \"\")\n            return this.startsWith(str);\n        return addIgnoreCaseAlgorithm(this, function (x, a) { return x.indexOf(a[0]) === 0; }, [str], maxString);\n    };\n    WhereClause.prototype.equalsIgnoreCase = function (str) {\n        return addIgnoreCaseAlgorithm(this, function (x, a) { return x === a[0]; }, [str], \"\");\n    };\n    WhereClause.prototype.anyOfIgnoreCase = function () {\n        var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        if (set.length === 0)\n            return emptyCollection(this);\n        return addIgnoreCaseAlgorithm(this, function (x, a) { return a.indexOf(x) !== -1; }, set, \"\");\n    };\n    WhereClause.prototype.startsWithAnyOfIgnoreCase = function () {\n        var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        if (set.length === 0)\n            return emptyCollection(this);\n        return addIgnoreCaseAlgorithm(this, function (x, a) { return a.some(function (n) { return x.indexOf(n) === 0; }); }, set, maxString);\n    };\n    WhereClause.prototype.anyOf = function () {\n        var _this = this;\n        var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        var compare = this._cmp;\n        try {\n            set.sort(compare);\n        }\n        catch (e) {\n            return fail(this, INVALID_KEY_ARGUMENT);\n        }\n        if (set.length === 0)\n            return emptyCollection(this);\n        var c = new this.Collection(this, function () { return createRange(set[0], set[set.length - 1]); });\n        c._ondirectionchange = function (direction) {\n            compare = (direction === \"next\" ?\n                _this._ascending :\n                _this._descending);\n            set.sort(compare);\n        };\n        var i = 0;\n        c._addAlgorithm(function (cursor, advance, resolve) {\n            var key = cursor.key;\n            while (compare(key, set[i]) > 0) {\n                ++i;\n                if (i === set.length) {\n                    advance(resolve);\n                    return false;\n                }\n            }\n            if (compare(key, set[i]) === 0) {\n                return true;\n            }\n            else {\n                advance(function () { cursor.continue(set[i]); });\n                return false;\n            }\n        });\n        return c;\n    };\n    WhereClause.prototype.notEqual = function (value) {\n        return this.inAnyRange([[minKey, value], [value, this.db._maxKey]], { includeLowers: false, includeUppers: false });\n    };\n    WhereClause.prototype.noneOf = function () {\n        var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        if (set.length === 0)\n            return new this.Collection(this);\n        try {\n            set.sort(this._ascending);\n        }\n        catch (e) {\n            return fail(this, INVALID_KEY_ARGUMENT);\n        }\n        var ranges = set.reduce(function (res, val) { return res ?\n            res.concat([[res[res.length - 1][1], val]]) :\n            [[minKey, val]]; }, null);\n        ranges.push([set[set.length - 1], this.db._maxKey]);\n        return this.inAnyRange(ranges, { includeLowers: false, includeUppers: false });\n    };\n    WhereClause.prototype.inAnyRange = function (ranges, options) {\n        var _this = this;\n        var cmp = this._cmp, ascending = this._ascending, descending = this._descending, min = this._min, max = this._max;\n        if (ranges.length === 0)\n            return emptyCollection(this);\n        if (!ranges.every(function (range) {\n            return range[0] !== undefined &&\n                range[1] !== undefined &&\n                ascending(range[0], range[1]) <= 0;\n        })) {\n            return fail(this, \"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower\", exceptions.InvalidArgument);\n        }\n        var includeLowers = !options || options.includeLowers !== false;\n        var includeUppers = options && options.includeUppers === true;\n        function addRange(ranges, newRange) {\n            var i = 0, l = ranges.length;\n            for (; i < l; ++i) {\n                var range = ranges[i];\n                if (cmp(newRange[0], range[1]) < 0 && cmp(newRange[1], range[0]) > 0) {\n                    range[0] = min(range[0], newRange[0]);\n                    range[1] = max(range[1], newRange[1]);\n                    break;\n                }\n            }\n            if (i === l)\n                ranges.push(newRange);\n            return ranges;\n        }\n        var sortDirection = ascending;\n        function rangeSorter(a, b) { return sortDirection(a[0], b[0]); }\n        var set;\n        try {\n            set = ranges.reduce(addRange, []);\n            set.sort(rangeSorter);\n        }\n        catch (ex) {\n            return fail(this, INVALID_KEY_ARGUMENT);\n        }\n        var rangePos = 0;\n        var keyIsBeyondCurrentEntry = includeUppers ?\n            function (key) { return ascending(key, set[rangePos][1]) > 0; } :\n            function (key) { return ascending(key, set[rangePos][1]) >= 0; };\n        var keyIsBeforeCurrentEntry = includeLowers ?\n            function (key) { return descending(key, set[rangePos][0]) > 0; } :\n            function (key) { return descending(key, set[rangePos][0]) >= 0; };\n        function keyWithinCurrentRange(key) {\n            return !keyIsBeyondCurrentEntry(key) && !keyIsBeforeCurrentEntry(key);\n        }\n        var checkKey = keyIsBeyondCurrentEntry;\n        var c = new this.Collection(this, function () { return createRange(set[0][0], set[set.length - 1][1], !includeLowers, !includeUppers); });\n        c._ondirectionchange = function (direction) {\n            if (direction === \"next\") {\n                checkKey = keyIsBeyondCurrentEntry;\n                sortDirection = ascending;\n            }\n            else {\n                checkKey = keyIsBeforeCurrentEntry;\n                sortDirection = descending;\n            }\n            set.sort(rangeSorter);\n        };\n        c._addAlgorithm(function (cursor, advance, resolve) {\n            var key = cursor.key;\n            while (checkKey(key)) {\n                ++rangePos;\n                if (rangePos === set.length) {\n                    advance(resolve);\n                    return false;\n                }\n            }\n            if (keyWithinCurrentRange(key)) {\n                return true;\n            }\n            else if (_this._cmp(key, set[rangePos][1]) === 0 || _this._cmp(key, set[rangePos][0]) === 0) {\n                return false;\n            }\n            else {\n                advance(function () {\n                    if (sortDirection === ascending)\n                        cursor.continue(set[rangePos][0]);\n                    else\n                        cursor.continue(set[rangePos][1]);\n                });\n                return false;\n            }\n        });\n        return c;\n    };\n    WhereClause.prototype.startsWithAnyOf = function () {\n        var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n        if (!set.every(function (s) { return typeof s === 'string'; })) {\n            return fail(this, \"startsWithAnyOf() only works with strings\");\n        }\n        if (set.length === 0)\n            return emptyCollection(this);\n        return this.inAnyRange(set.map(function (str) { return [str, str + maxString]; }));\n    };\n    return WhereClause;\n}());\n\nfunction createWhereClauseConstructor(db) {\n    return makeClassConstructor(WhereClause.prototype, function WhereClause(table, index, orCollection) {\n        this.db = db;\n        this._ctx = {\n            table: table,\n            index: index === \":id\" ? null : index,\n            or: orCollection\n        };\n        var indexedDB = db._deps.indexedDB;\n        if (!indexedDB)\n            throw new exceptions.MissingAPI();\n        this._cmp = this._ascending = indexedDB.cmp.bind(indexedDB);\n        this._descending = function (a, b) { return indexedDB.cmp(b, a); };\n        this._max = function (a, b) { return indexedDB.cmp(a, b) > 0 ? a : b; };\n        this._min = function (a, b) { return indexedDB.cmp(a, b) < 0 ? a : b; };\n        this._IDBKeyRange = db._deps.IDBKeyRange;\n    });\n}\n\nfunction eventRejectHandler(reject) {\n    return wrap(function (event) {\n        preventDefault(event);\n        reject(event.target.error);\n        return false;\n    });\n}\nfunction preventDefault(event) {\n    if (event.stopPropagation)\n        event.stopPropagation();\n    if (event.preventDefault)\n        event.preventDefault();\n}\n\nvar DEXIE_STORAGE_MUTATED_EVENT_NAME = 'storagemutated';\nvar STORAGE_MUTATED_DOM_EVENT_NAME = 'x-storagemutated-1';\nvar globalEvents = Events(null, DEXIE_STORAGE_MUTATED_EVENT_NAME);\n\nvar Transaction =  (function () {\n    function Transaction() {\n    }\n    Transaction.prototype._lock = function () {\n        assert(!PSD.global);\n        ++this._reculock;\n        if (this._reculock === 1 && !PSD.global)\n            PSD.lockOwnerFor = this;\n        return this;\n    };\n    Transaction.prototype._unlock = function () {\n        assert(!PSD.global);\n        if (--this._reculock === 0) {\n            if (!PSD.global)\n                PSD.lockOwnerFor = null;\n            while (this._blockedFuncs.length > 0 && !this._locked()) {\n                var fnAndPSD = this._blockedFuncs.shift();\n                try {\n                    usePSD(fnAndPSD[1], fnAndPSD[0]);\n                }\n                catch (e) { }\n            }\n        }\n        return this;\n    };\n    Transaction.prototype._locked = function () {\n        return this._reculock && PSD.lockOwnerFor !== this;\n    };\n    Transaction.prototype.create = function (idbtrans) {\n        var _this = this;\n        if (!this.mode)\n            return this;\n        var idbdb = this.db.idbdb;\n        var dbOpenError = this.db._state.dbOpenError;\n        assert(!this.idbtrans);\n        if (!idbtrans && !idbdb) {\n            switch (dbOpenError && dbOpenError.name) {\n                case \"DatabaseClosedError\":\n                    throw new exceptions.DatabaseClosed(dbOpenError);\n                case \"MissingAPIError\":\n                    throw new exceptions.MissingAPI(dbOpenError.message, dbOpenError);\n                default:\n                    throw new exceptions.OpenFailed(dbOpenError);\n            }\n        }\n        if (!this.active)\n            throw new exceptions.TransactionInactive();\n        assert(this._completion._state === null);\n        idbtrans = this.idbtrans = idbtrans ||\n            (this.db.core\n                ? this.db.core.transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability })\n                : idbdb.transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability }));\n        idbtrans.onerror = wrap(function (ev) {\n            preventDefault(ev);\n            _this._reject(idbtrans.error);\n        });\n        idbtrans.onabort = wrap(function (ev) {\n            preventDefault(ev);\n            _this.active && _this._reject(new exceptions.Abort(idbtrans.error));\n            _this.active = false;\n            _this.on(\"abort\").fire(ev);\n        });\n        idbtrans.oncomplete = wrap(function () {\n            _this.active = false;\n            _this._resolve();\n            if ('mutatedParts' in idbtrans) {\n                globalEvents.storagemutated.fire(idbtrans[\"mutatedParts\"]);\n            }\n        });\n        return this;\n    };\n    Transaction.prototype._promise = function (mode, fn, bWriteLock) {\n        var _this = this;\n        if (mode === 'readwrite' && this.mode !== 'readwrite')\n            return rejection(new exceptions.ReadOnly(\"Transaction is readonly\"));\n        if (!this.active)\n            return rejection(new exceptions.TransactionInactive());\n        if (this._locked()) {\n            return new DexiePromise(function (resolve, reject) {\n                _this._blockedFuncs.push([function () {\n                        _this._promise(mode, fn, bWriteLock).then(resolve, reject);\n                    }, PSD]);\n            });\n        }\n        else if (bWriteLock) {\n            return newScope(function () {\n                var p = new DexiePromise(function (resolve, reject) {\n                    _this._lock();\n                    var rv = fn(resolve, reject, _this);\n                    if (rv && rv.then)\n                        rv.then(resolve, reject);\n                });\n                p.finally(function () { return _this._unlock(); });\n                p._lib = true;\n                return p;\n            });\n        }\n        else {\n            var p = new DexiePromise(function (resolve, reject) {\n                var rv = fn(resolve, reject, _this);\n                if (rv && rv.then)\n                    rv.then(resolve, reject);\n            });\n            p._lib = true;\n            return p;\n        }\n    };\n    Transaction.prototype._root = function () {\n        return this.parent ? this.parent._root() : this;\n    };\n    Transaction.prototype.waitFor = function (promiseLike) {\n        var root = this._root();\n        var promise = DexiePromise.resolve(promiseLike);\n        if (root._waitingFor) {\n            root._waitingFor = root._waitingFor.then(function () { return promise; });\n        }\n        else {\n            root._waitingFor = promise;\n            root._waitingQueue = [];\n            var store = root.idbtrans.objectStore(root.storeNames[0]);\n            (function spin() {\n                ++root._spinCount;\n                while (root._waitingQueue.length)\n                    (root._waitingQueue.shift())();\n                if (root._waitingFor)\n                    store.get(-Infinity).onsuccess = spin;\n            }());\n        }\n        var currentWaitPromise = root._waitingFor;\n        return new DexiePromise(function (resolve, reject) {\n            promise.then(function (res) { return root._waitingQueue.push(wrap(resolve.bind(null, res))); }, function (err) { return root._waitingQueue.push(wrap(reject.bind(null, err))); }).finally(function () {\n                if (root._waitingFor === currentWaitPromise) {\n                    root._waitingFor = null;\n                }\n            });\n        });\n    };\n    Transaction.prototype.abort = function () {\n        if (this.active) {\n            this.active = false;\n            if (this.idbtrans)\n                this.idbtrans.abort();\n            this._reject(new exceptions.Abort());\n        }\n    };\n    Transaction.prototype.table = function (tableName) {\n        var memoizedTables = (this._memoizedTables || (this._memoizedTables = {}));\n        if (hasOwn(memoizedTables, tableName))\n            return memoizedTables[tableName];\n        var tableSchema = this.schema[tableName];\n        if (!tableSchema) {\n            throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n        }\n        var transactionBoundTable = new this.db.Table(tableName, tableSchema, this);\n        transactionBoundTable.core = this.db.core.table(tableName);\n        memoizedTables[tableName] = transactionBoundTable;\n        return transactionBoundTable;\n    };\n    return Transaction;\n}());\n\nfunction createTransactionConstructor(db) {\n    return makeClassConstructor(Transaction.prototype, function Transaction(mode, storeNames, dbschema, chromeTransactionDurability, parent) {\n        var _this = this;\n        this.db = db;\n        this.mode = mode;\n        this.storeNames = storeNames;\n        this.schema = dbschema;\n        this.chromeTransactionDurability = chromeTransactionDurability;\n        this.idbtrans = null;\n        this.on = Events(this, \"complete\", \"error\", \"abort\");\n        this.parent = parent || null;\n        this.active = true;\n        this._reculock = 0;\n        this._blockedFuncs = [];\n        this._resolve = null;\n        this._reject = null;\n        this._waitingFor = null;\n        this._waitingQueue = null;\n        this._spinCount = 0;\n        this._completion = new DexiePromise(function (resolve, reject) {\n            _this._resolve = resolve;\n            _this._reject = reject;\n        });\n        this._completion.then(function () {\n            _this.active = false;\n            _this.on.complete.fire();\n        }, function (e) {\n            var wasActive = _this.active;\n            _this.active = false;\n            _this.on.error.fire(e);\n            _this.parent ?\n                _this.parent._reject(e) :\n                wasActive && _this.idbtrans && _this.idbtrans.abort();\n            return rejection(e);\n        });\n    });\n}\n\nfunction createIndexSpec(name, keyPath, unique, multi, auto, compound, isPrimKey) {\n    return {\n        name: name,\n        keyPath: keyPath,\n        unique: unique,\n        multi: multi,\n        auto: auto,\n        compound: compound,\n        src: (unique && !isPrimKey ? '&' : '') + (multi ? '*' : '') + (auto ? \"++\" : \"\") + nameFromKeyPath(keyPath)\n    };\n}\nfunction nameFromKeyPath(keyPath) {\n    return typeof keyPath === 'string' ?\n        keyPath :\n        keyPath ? ('[' + [].join.call(keyPath, '+') + ']') : \"\";\n}\n\nfunction createTableSchema(name, primKey, indexes) {\n    return {\n        name: name,\n        primKey: primKey,\n        indexes: indexes,\n        mappedClass: null,\n        idxByName: arrayToObject(indexes, function (index) { return [index.name, index]; })\n    };\n}\n\nfunction safariMultiStoreFix(storeNames) {\n    return storeNames.length === 1 ? storeNames[0] : storeNames;\n}\nvar getMaxKey = function (IdbKeyRange) {\n    try {\n        IdbKeyRange.only([[]]);\n        getMaxKey = function () { return [[]]; };\n        return [[]];\n    }\n    catch (e) {\n        getMaxKey = function () { return maxString; };\n        return maxString;\n    }\n};\n\nfunction getKeyExtractor(keyPath) {\n    if (keyPath == null) {\n        return function () { return undefined; };\n    }\n    else if (typeof keyPath === 'string') {\n        return getSinglePathKeyExtractor(keyPath);\n    }\n    else {\n        return function (obj) { return getByKeyPath(obj, keyPath); };\n    }\n}\nfunction getSinglePathKeyExtractor(keyPath) {\n    var split = keyPath.split('.');\n    if (split.length === 1) {\n        return function (obj) { return obj[keyPath]; };\n    }\n    else {\n        return function (obj) { return getByKeyPath(obj, keyPath); };\n    }\n}\n\nfunction arrayify(arrayLike) {\n    return [].slice.call(arrayLike);\n}\nvar _id_counter = 0;\nfunction getKeyPathAlias(keyPath) {\n    return keyPath == null ?\n        \":id\" :\n        typeof keyPath === 'string' ?\n            keyPath :\n            \"[\" + keyPath.join('+') + \"]\";\n}\nfunction createDBCore(db, IdbKeyRange, tmpTrans) {\n    function extractSchema(db, trans) {\n        var tables = arrayify(db.objectStoreNames);\n        return {\n            schema: {\n                name: db.name,\n                tables: tables.map(function (table) { return trans.objectStore(table); }).map(function (store) {\n                    var keyPath = store.keyPath, autoIncrement = store.autoIncrement;\n                    var compound = isArray(keyPath);\n                    var outbound = keyPath == null;\n                    var indexByKeyPath = {};\n                    var result = {\n                        name: store.name,\n                        primaryKey: {\n                            name: null,\n                            isPrimaryKey: true,\n                            outbound: outbound,\n                            compound: compound,\n                            keyPath: keyPath,\n                            autoIncrement: autoIncrement,\n                            unique: true,\n                            extractKey: getKeyExtractor(keyPath)\n                        },\n                        indexes: arrayify(store.indexNames).map(function (indexName) { return store.index(indexName); })\n                            .map(function (index) {\n                            var name = index.name, unique = index.unique, multiEntry = index.multiEntry, keyPath = index.keyPath;\n                            var compound = isArray(keyPath);\n                            var result = {\n                                name: name,\n                                compound: compound,\n                                keyPath: keyPath,\n                                unique: unique,\n                                multiEntry: multiEntry,\n                                extractKey: getKeyExtractor(keyPath)\n                            };\n                            indexByKeyPath[getKeyPathAlias(keyPath)] = result;\n                            return result;\n                        }),\n                        getIndexByKeyPath: function (keyPath) { return indexByKeyPath[getKeyPathAlias(keyPath)]; }\n                    };\n                    indexByKeyPath[\":id\"] = result.primaryKey;\n                    if (keyPath != null) {\n                        indexByKeyPath[getKeyPathAlias(keyPath)] = result.primaryKey;\n                    }\n                    return result;\n                })\n            },\n            hasGetAll: tables.length > 0 && ('getAll' in trans.objectStore(tables[0])) &&\n                !(typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n                    !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n                    [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604)\n        };\n    }\n    function makeIDBKeyRange(range) {\n        if (range.type === 3 )\n            return null;\n        if (range.type === 4 )\n            throw new Error(\"Cannot convert never type to IDBKeyRange\");\n        var lower = range.lower, upper = range.upper, lowerOpen = range.lowerOpen, upperOpen = range.upperOpen;\n        var idbRange = lower === undefined ?\n            upper === undefined ?\n                null :\n                IdbKeyRange.upperBound(upper, !!upperOpen) :\n            upper === undefined ?\n                IdbKeyRange.lowerBound(lower, !!lowerOpen) :\n                IdbKeyRange.bound(lower, upper, !!lowerOpen, !!upperOpen);\n        return idbRange;\n    }\n    function createDbCoreTable(tableSchema) {\n        var tableName = tableSchema.name;\n        function mutate(_a) {\n            var trans = _a.trans, type = _a.type, keys = _a.keys, values = _a.values, range = _a.range;\n            return new Promise(function (resolve, reject) {\n                resolve = wrap(resolve);\n                var store = trans.objectStore(tableName);\n                var outbound = store.keyPath == null;\n                var isAddOrPut = type === \"put\" || type === \"add\";\n                if (!isAddOrPut && type !== 'delete' && type !== 'deleteRange')\n                    throw new Error(\"Invalid operation type: \" + type);\n                var length = (keys || values || { length: 1 }).length;\n                if (keys && values && keys.length !== values.length) {\n                    throw new Error(\"Given keys array must have same length as given values array.\");\n                }\n                if (length === 0)\n                    return resolve({ numFailures: 0, failures: {}, results: [], lastResult: undefined });\n                var req;\n                var reqs = [];\n                var failures = [];\n                var numFailures = 0;\n                var errorHandler = function (event) {\n                    ++numFailures;\n                    preventDefault(event);\n                };\n                if (type === 'deleteRange') {\n                    if (range.type === 4 )\n                        return resolve({ numFailures: numFailures, failures: failures, results: [], lastResult: undefined });\n                    if (range.type === 3 )\n                        reqs.push(req = store.clear());\n                    else\n                        reqs.push(req = store.delete(makeIDBKeyRange(range)));\n                }\n                else {\n                    var _a = isAddOrPut ?\n                        outbound ?\n                            [values, keys] :\n                            [values, null] :\n                        [keys, null], args1 = _a[0], args2 = _a[1];\n                    if (isAddOrPut) {\n                        for (var i = 0; i < length; ++i) {\n                            reqs.push(req = (args2 && args2[i] !== undefined ?\n                                store[type](args1[i], args2[i]) :\n                                store[type](args1[i])));\n                            req.onerror = errorHandler;\n                        }\n                    }\n                    else {\n                        for (var i = 0; i < length; ++i) {\n                            reqs.push(req = store[type](args1[i]));\n                            req.onerror = errorHandler;\n                        }\n                    }\n                }\n                var done = function (event) {\n                    var lastResult = event.target.result;\n                    reqs.forEach(function (req, i) { return req.error != null && (failures[i] = req.error); });\n                    resolve({\n                        numFailures: numFailures,\n                        failures: failures,\n                        results: type === \"delete\" ? keys : reqs.map(function (req) { return req.result; }),\n                        lastResult: lastResult\n                    });\n                };\n                req.onerror = function (event) {\n                    errorHandler(event);\n                    done(event);\n                };\n                req.onsuccess = done;\n            });\n        }\n        function openCursor(_a) {\n            var trans = _a.trans, values = _a.values, query = _a.query, reverse = _a.reverse, unique = _a.unique;\n            return new Promise(function (resolve, reject) {\n                resolve = wrap(resolve);\n                var index = query.index, range = query.range;\n                var store = trans.objectStore(tableName);\n                var source = index.isPrimaryKey ?\n                    store :\n                    store.index(index.name);\n                var direction = reverse ?\n                    unique ?\n                        \"prevunique\" :\n                        \"prev\" :\n                    unique ?\n                        \"nextunique\" :\n                        \"next\";\n                var req = values || !('openKeyCursor' in source) ?\n                    source.openCursor(makeIDBKeyRange(range), direction) :\n                    source.openKeyCursor(makeIDBKeyRange(range), direction);\n                req.onerror = eventRejectHandler(reject);\n                req.onsuccess = wrap(function (ev) {\n                    var cursor = req.result;\n                    if (!cursor) {\n                        resolve(null);\n                        return;\n                    }\n                    cursor.___id = ++_id_counter;\n                    cursor.done = false;\n                    var _cursorContinue = cursor.continue.bind(cursor);\n                    var _cursorContinuePrimaryKey = cursor.continuePrimaryKey;\n                    if (_cursorContinuePrimaryKey)\n                        _cursorContinuePrimaryKey = _cursorContinuePrimaryKey.bind(cursor);\n                    var _cursorAdvance = cursor.advance.bind(cursor);\n                    var doThrowCursorIsNotStarted = function () { throw new Error(\"Cursor not started\"); };\n                    var doThrowCursorIsStopped = function () { throw new Error(\"Cursor not stopped\"); };\n                    cursor.trans = trans;\n                    cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsNotStarted;\n                    cursor.fail = wrap(reject);\n                    cursor.next = function () {\n                        var _this = this;\n                        var gotOne = 1;\n                        return this.start(function () { return gotOne-- ? _this.continue() : _this.stop(); }).then(function () { return _this; });\n                    };\n                    cursor.start = function (callback) {\n                        var iterationPromise = new Promise(function (resolveIteration, rejectIteration) {\n                            resolveIteration = wrap(resolveIteration);\n                            req.onerror = eventRejectHandler(rejectIteration);\n                            cursor.fail = rejectIteration;\n                            cursor.stop = function (value) {\n                                cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsStopped;\n                                resolveIteration(value);\n                            };\n                        });\n                        var guardedCallback = function () {\n                            if (req.result) {\n                                try {\n                                    callback();\n                                }\n                                catch (err) {\n                                    cursor.fail(err);\n                                }\n                            }\n                            else {\n                                cursor.done = true;\n                                cursor.start = function () { throw new Error(\"Cursor behind last entry\"); };\n                                cursor.stop();\n                            }\n                        };\n                        req.onsuccess = wrap(function (ev) {\n                            req.onsuccess = guardedCallback;\n                            guardedCallback();\n                        });\n                        cursor.continue = _cursorContinue;\n                        cursor.continuePrimaryKey = _cursorContinuePrimaryKey;\n                        cursor.advance = _cursorAdvance;\n                        guardedCallback();\n                        return iterationPromise;\n                    };\n                    resolve(cursor);\n                }, reject);\n            });\n        }\n        function query(hasGetAll) {\n            return function (request) {\n                return new Promise(function (resolve, reject) {\n                    resolve = wrap(resolve);\n                    var trans = request.trans, values = request.values, limit = request.limit, query = request.query;\n                    var nonInfinitLimit = limit === Infinity ? undefined : limit;\n                    var index = query.index, range = query.range;\n                    var store = trans.objectStore(tableName);\n                    var source = index.isPrimaryKey ? store : store.index(index.name);\n                    var idbKeyRange = makeIDBKeyRange(range);\n                    if (limit === 0)\n                        return resolve({ result: [] });\n                    if (hasGetAll) {\n                        var req = values ?\n                            source.getAll(idbKeyRange, nonInfinitLimit) :\n                            source.getAllKeys(idbKeyRange, nonInfinitLimit);\n                        req.onsuccess = function (event) { return resolve({ result: event.target.result }); };\n                        req.onerror = eventRejectHandler(reject);\n                    }\n                    else {\n                        var count_1 = 0;\n                        var req_1 = values || !('openKeyCursor' in source) ?\n                            source.openCursor(idbKeyRange) :\n                            source.openKeyCursor(idbKeyRange);\n                        var result_1 = [];\n                        req_1.onsuccess = function (event) {\n                            var cursor = req_1.result;\n                            if (!cursor)\n                                return resolve({ result: result_1 });\n                            result_1.push(values ? cursor.value : cursor.primaryKey);\n                            if (++count_1 === limit)\n                                return resolve({ result: result_1 });\n                            cursor.continue();\n                        };\n                        req_1.onerror = eventRejectHandler(reject);\n                    }\n                });\n            };\n        }\n        return {\n            name: tableName,\n            schema: tableSchema,\n            mutate: mutate,\n            getMany: function (_a) {\n                var trans = _a.trans, keys = _a.keys;\n                return new Promise(function (resolve, reject) {\n                    resolve = wrap(resolve);\n                    var store = trans.objectStore(tableName);\n                    var length = keys.length;\n                    var result = new Array(length);\n                    var keyCount = 0;\n                    var callbackCount = 0;\n                    var req;\n                    var successHandler = function (event) {\n                        var req = event.target;\n                        if ((result[req._pos] = req.result) != null)\n                            ;\n                        if (++callbackCount === keyCount)\n                            resolve(result);\n                    };\n                    var errorHandler = eventRejectHandler(reject);\n                    for (var i = 0; i < length; ++i) {\n                        var key = keys[i];\n                        if (key != null) {\n                            req = store.get(keys[i]);\n                            req._pos = i;\n                            req.onsuccess = successHandler;\n                            req.onerror = errorHandler;\n                            ++keyCount;\n                        }\n                    }\n                    if (keyCount === 0)\n                        resolve(result);\n                });\n            },\n            get: function (_a) {\n                var trans = _a.trans, key = _a.key;\n                return new Promise(function (resolve, reject) {\n                    resolve = wrap(resolve);\n                    var store = trans.objectStore(tableName);\n                    var req = store.get(key);\n                    req.onsuccess = function (event) { return resolve(event.target.result); };\n                    req.onerror = eventRejectHandler(reject);\n                });\n            },\n            query: query(hasGetAll),\n            openCursor: openCursor,\n            count: function (_a) {\n                var query = _a.query, trans = _a.trans;\n                var index = query.index, range = query.range;\n                return new Promise(function (resolve, reject) {\n                    var store = trans.objectStore(tableName);\n                    var source = index.isPrimaryKey ? store : store.index(index.name);\n                    var idbKeyRange = makeIDBKeyRange(range);\n                    var req = idbKeyRange ? source.count(idbKeyRange) : source.count();\n                    req.onsuccess = wrap(function (ev) { return resolve(ev.target.result); });\n                    req.onerror = eventRejectHandler(reject);\n                });\n            }\n        };\n    }\n    var _a = extractSchema(db, tmpTrans), schema = _a.schema, hasGetAll = _a.hasGetAll;\n    var tables = schema.tables.map(function (tableSchema) { return createDbCoreTable(tableSchema); });\n    var tableMap = {};\n    tables.forEach(function (table) { return tableMap[table.name] = table; });\n    return {\n        stack: \"dbcore\",\n        transaction: db.transaction.bind(db),\n        table: function (name) {\n            var result = tableMap[name];\n            if (!result)\n                throw new Error(\"Table '\" + name + \"' not found\");\n            return tableMap[name];\n        },\n        MIN_KEY: -Infinity,\n        MAX_KEY: getMaxKey(IdbKeyRange),\n        schema: schema\n    };\n}\n\nfunction createMiddlewareStack(stackImpl, middlewares) {\n    return middlewares.reduce(function (down, _a) {\n        var create = _a.create;\n        return (__assign(__assign({}, down), create(down)));\n    }, stackImpl);\n}\nfunction createMiddlewareStacks(middlewares, idbdb, _a, tmpTrans) {\n    var IDBKeyRange = _a.IDBKeyRange; _a.indexedDB;\n    var dbcore = createMiddlewareStack(createDBCore(idbdb, IDBKeyRange, tmpTrans), middlewares.dbcore);\n    return {\n        dbcore: dbcore\n    };\n}\nfunction generateMiddlewareStacks(_a, tmpTrans) {\n    var db = _a._novip;\n    var idbdb = tmpTrans.db;\n    var stacks = createMiddlewareStacks(db._middlewares, idbdb, db._deps, tmpTrans);\n    db.core = stacks.dbcore;\n    db.tables.forEach(function (table) {\n        var tableName = table.name;\n        if (db.core.schema.tables.some(function (tbl) { return tbl.name === tableName; })) {\n            table.core = db.core.table(tableName);\n            if (db[tableName] instanceof db.Table) {\n                db[tableName].core = table.core;\n            }\n        }\n    });\n}\n\nfunction setApiOnPlace(_a, objs, tableNames, dbschema) {\n    var db = _a._novip;\n    tableNames.forEach(function (tableName) {\n        var schema = dbschema[tableName];\n        objs.forEach(function (obj) {\n            var propDesc = getPropertyDescriptor(obj, tableName);\n            if (!propDesc || (\"value\" in propDesc && propDesc.value === undefined)) {\n                if (obj === db.Transaction.prototype || obj instanceof db.Transaction) {\n                    setProp(obj, tableName, {\n                        get: function () { return this.table(tableName); },\n                        set: function (value) {\n                            defineProperty(this, tableName, { value: value, writable: true, configurable: true, enumerable: true });\n                        }\n                    });\n                }\n                else {\n                    obj[tableName] = new db.Table(tableName, schema);\n                }\n            }\n        });\n    });\n}\nfunction removeTablesApi(_a, objs) {\n    var db = _a._novip;\n    objs.forEach(function (obj) {\n        for (var key in obj) {\n            if (obj[key] instanceof db.Table)\n                delete obj[key];\n        }\n    });\n}\nfunction lowerVersionFirst(a, b) {\n    return a._cfg.version - b._cfg.version;\n}\nfunction runUpgraders(db, oldVersion, idbUpgradeTrans, reject) {\n    var globalSchema = db._dbSchema;\n    var trans = db._createTransaction('readwrite', db._storeNames, globalSchema);\n    trans.create(idbUpgradeTrans);\n    trans._completion.catch(reject);\n    var rejectTransaction = trans._reject.bind(trans);\n    var transless = PSD.transless || PSD;\n    newScope(function () {\n        PSD.trans = trans;\n        PSD.transless = transless;\n        if (oldVersion === 0) {\n            keys(globalSchema).forEach(function (tableName) {\n                createTable(idbUpgradeTrans, tableName, globalSchema[tableName].primKey, globalSchema[tableName].indexes);\n            });\n            generateMiddlewareStacks(db, idbUpgradeTrans);\n            DexiePromise.follow(function () { return db.on.populate.fire(trans); }).catch(rejectTransaction);\n        }\n        else\n            updateTablesAndIndexes(db, oldVersion, trans, idbUpgradeTrans).catch(rejectTransaction);\n    });\n}\nfunction updateTablesAndIndexes(_a, oldVersion, trans, idbUpgradeTrans) {\n    var db = _a._novip;\n    var queue = [];\n    var versions = db._versions;\n    var globalSchema = db._dbSchema = buildGlobalSchema(db, db.idbdb, idbUpgradeTrans);\n    var anyContentUpgraderHasRun = false;\n    var versToRun = versions.filter(function (v) { return v._cfg.version >= oldVersion; });\n    versToRun.forEach(function (version) {\n        queue.push(function () {\n            var oldSchema = globalSchema;\n            var newSchema = version._cfg.dbschema;\n            adjustToExistingIndexNames(db, oldSchema, idbUpgradeTrans);\n            adjustToExistingIndexNames(db, newSchema, idbUpgradeTrans);\n            globalSchema = db._dbSchema = newSchema;\n            var diff = getSchemaDiff(oldSchema, newSchema);\n            diff.add.forEach(function (tuple) {\n                createTable(idbUpgradeTrans, tuple[0], tuple[1].primKey, tuple[1].indexes);\n            });\n            diff.change.forEach(function (change) {\n                if (change.recreate) {\n                    throw new exceptions.Upgrade(\"Not yet support for changing primary key\");\n                }\n                else {\n                    var store_1 = idbUpgradeTrans.objectStore(change.name);\n                    change.add.forEach(function (idx) { return addIndex(store_1, idx); });\n                    change.change.forEach(function (idx) {\n                        store_1.deleteIndex(idx.name);\n                        addIndex(store_1, idx);\n                    });\n                    change.del.forEach(function (idxName) { return store_1.deleteIndex(idxName); });\n                }\n            });\n            var contentUpgrade = version._cfg.contentUpgrade;\n            if (contentUpgrade && version._cfg.version > oldVersion) {\n                generateMiddlewareStacks(db, idbUpgradeTrans);\n                trans._memoizedTables = {};\n                anyContentUpgraderHasRun = true;\n                var upgradeSchema_1 = shallowClone(newSchema);\n                diff.del.forEach(function (table) {\n                    upgradeSchema_1[table] = oldSchema[table];\n                });\n                removeTablesApi(db, [db.Transaction.prototype]);\n                setApiOnPlace(db, [db.Transaction.prototype], keys(upgradeSchema_1), upgradeSchema_1);\n                trans.schema = upgradeSchema_1;\n                var contentUpgradeIsAsync_1 = isAsyncFunction(contentUpgrade);\n                if (contentUpgradeIsAsync_1) {\n                    incrementExpectedAwaits();\n                }\n                var returnValue_1;\n                var promiseFollowed = DexiePromise.follow(function () {\n                    returnValue_1 = contentUpgrade(trans);\n                    if (returnValue_1) {\n                        if (contentUpgradeIsAsync_1) {\n                            var decrementor = decrementExpectedAwaits.bind(null, null);\n                            returnValue_1.then(decrementor, decrementor);\n                        }\n                    }\n                });\n                return (returnValue_1 && typeof returnValue_1.then === 'function' ?\n                    DexiePromise.resolve(returnValue_1) : promiseFollowed.then(function () { return returnValue_1; }));\n            }\n        });\n        queue.push(function (idbtrans) {\n            if (!anyContentUpgraderHasRun || !hasIEDeleteObjectStoreBug) {\n                var newSchema = version._cfg.dbschema;\n                deleteRemovedTables(newSchema, idbtrans);\n            }\n            removeTablesApi(db, [db.Transaction.prototype]);\n            setApiOnPlace(db, [db.Transaction.prototype], db._storeNames, db._dbSchema);\n            trans.schema = db._dbSchema;\n        });\n    });\n    function runQueue() {\n        return queue.length ? DexiePromise.resolve(queue.shift()(trans.idbtrans)).then(runQueue) :\n            DexiePromise.resolve();\n    }\n    return runQueue().then(function () {\n        createMissingTables(globalSchema, idbUpgradeTrans);\n    });\n}\nfunction getSchemaDiff(oldSchema, newSchema) {\n    var diff = {\n        del: [],\n        add: [],\n        change: []\n    };\n    var table;\n    for (table in oldSchema) {\n        if (!newSchema[table])\n            diff.del.push(table);\n    }\n    for (table in newSchema) {\n        var oldDef = oldSchema[table], newDef = newSchema[table];\n        if (!oldDef) {\n            diff.add.push([table, newDef]);\n        }\n        else {\n            var change = {\n                name: table,\n                def: newDef,\n                recreate: false,\n                del: [],\n                add: [],\n                change: []\n            };\n            if ((\n            '' + (oldDef.primKey.keyPath || '')) !== ('' + (newDef.primKey.keyPath || '')) ||\n                (oldDef.primKey.auto !== newDef.primKey.auto && !isIEOrEdge))\n             {\n                change.recreate = true;\n                diff.change.push(change);\n            }\n            else {\n                var oldIndexes = oldDef.idxByName;\n                var newIndexes = newDef.idxByName;\n                var idxName = void 0;\n                for (idxName in oldIndexes) {\n                    if (!newIndexes[idxName])\n                        change.del.push(idxName);\n                }\n                for (idxName in newIndexes) {\n                    var oldIdx = oldIndexes[idxName], newIdx = newIndexes[idxName];\n                    if (!oldIdx)\n                        change.add.push(newIdx);\n                    else if (oldIdx.src !== newIdx.src)\n                        change.change.push(newIdx);\n                }\n                if (change.del.length > 0 || change.add.length > 0 || change.change.length > 0) {\n                    diff.change.push(change);\n                }\n            }\n        }\n    }\n    return diff;\n}\nfunction createTable(idbtrans, tableName, primKey, indexes) {\n    var store = idbtrans.db.createObjectStore(tableName, primKey.keyPath ?\n        { keyPath: primKey.keyPath, autoIncrement: primKey.auto } :\n        { autoIncrement: primKey.auto });\n    indexes.forEach(function (idx) { return addIndex(store, idx); });\n    return store;\n}\nfunction createMissingTables(newSchema, idbtrans) {\n    keys(newSchema).forEach(function (tableName) {\n        if (!idbtrans.db.objectStoreNames.contains(tableName)) {\n            createTable(idbtrans, tableName, newSchema[tableName].primKey, newSchema[tableName].indexes);\n        }\n    });\n}\nfunction deleteRemovedTables(newSchema, idbtrans) {\n    [].slice.call(idbtrans.db.objectStoreNames).forEach(function (storeName) {\n        return newSchema[storeName] == null && idbtrans.db.deleteObjectStore(storeName);\n    });\n}\nfunction addIndex(store, idx) {\n    store.createIndex(idx.name, idx.keyPath, { unique: idx.unique, multiEntry: idx.multi });\n}\nfunction buildGlobalSchema(db, idbdb, tmpTrans) {\n    var globalSchema = {};\n    var dbStoreNames = slice(idbdb.objectStoreNames, 0);\n    dbStoreNames.forEach(function (storeName) {\n        var store = tmpTrans.objectStore(storeName);\n        var keyPath = store.keyPath;\n        var primKey = createIndexSpec(nameFromKeyPath(keyPath), keyPath || \"\", false, false, !!store.autoIncrement, keyPath && typeof keyPath !== \"string\", true);\n        var indexes = [];\n        for (var j = 0; j < store.indexNames.length; ++j) {\n            var idbindex = store.index(store.indexNames[j]);\n            keyPath = idbindex.keyPath;\n            var index = createIndexSpec(idbindex.name, keyPath, !!idbindex.unique, !!idbindex.multiEntry, false, keyPath && typeof keyPath !== \"string\", false);\n            indexes.push(index);\n        }\n        globalSchema[storeName] = createTableSchema(storeName, primKey, indexes);\n    });\n    return globalSchema;\n}\nfunction readGlobalSchema(_a, idbdb, tmpTrans) {\n    var db = _a._novip;\n    db.verno = idbdb.version / 10;\n    var globalSchema = db._dbSchema = buildGlobalSchema(db, idbdb, tmpTrans);\n    db._storeNames = slice(idbdb.objectStoreNames, 0);\n    setApiOnPlace(db, [db._allTables], keys(globalSchema), globalSchema);\n}\nfunction verifyInstalledSchema(db, tmpTrans) {\n    var installedSchema = buildGlobalSchema(db, db.idbdb, tmpTrans);\n    var diff = getSchemaDiff(installedSchema, db._dbSchema);\n    return !(diff.add.length || diff.change.some(function (ch) { return ch.add.length || ch.change.length; }));\n}\nfunction adjustToExistingIndexNames(_a, schema, idbtrans) {\n    var db = _a._novip;\n    var storeNames = idbtrans.db.objectStoreNames;\n    for (var i = 0; i < storeNames.length; ++i) {\n        var storeName = storeNames[i];\n        var store = idbtrans.objectStore(storeName);\n        db._hasGetAll = 'getAll' in store;\n        for (var j = 0; j < store.indexNames.length; ++j) {\n            var indexName = store.indexNames[j];\n            var keyPath = store.index(indexName).keyPath;\n            var dexieName = typeof keyPath === 'string' ? keyPath : \"[\" + slice(keyPath).join('+') + \"]\";\n            if (schema[storeName]) {\n                var indexSpec = schema[storeName].idxByName[dexieName];\n                if (indexSpec) {\n                    indexSpec.name = indexName;\n                    delete schema[storeName].idxByName[dexieName];\n                    schema[storeName].idxByName[indexName] = indexSpec;\n                }\n            }\n        }\n    }\n    if (typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n        !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n        _global.WorkerGlobalScope && _global instanceof _global.WorkerGlobalScope &&\n        [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604) {\n        db._hasGetAll = false;\n    }\n}\nfunction parseIndexSyntax(primKeyAndIndexes) {\n    return primKeyAndIndexes.split(',').map(function (index, indexNum) {\n        index = index.trim();\n        var name = index.replace(/([&*]|\\+\\+)/g, \"\");\n        var keyPath = /^\\[/.test(name) ? name.match(/^\\[(.*)\\]$/)[1].split('+') : name;\n        return createIndexSpec(name, keyPath || null, /\\&/.test(index), /\\*/.test(index), /\\+\\+/.test(index), isArray(keyPath), indexNum === 0);\n    });\n}\n\nvar Version =  (function () {\n    function Version() {\n    }\n    Version.prototype._parseStoresSpec = function (stores, outSchema) {\n        keys(stores).forEach(function (tableName) {\n            if (stores[tableName] !== null) {\n                var indexes = parseIndexSyntax(stores[tableName]);\n                var primKey = indexes.shift();\n                if (primKey.multi)\n                    throw new exceptions.Schema(\"Primary key cannot be multi-valued\");\n                indexes.forEach(function (idx) {\n                    if (idx.auto)\n                        throw new exceptions.Schema(\"Only primary key can be marked as autoIncrement (++)\");\n                    if (!idx.keyPath)\n                        throw new exceptions.Schema(\"Index must have a name and cannot be an empty string\");\n                });\n                outSchema[tableName] = createTableSchema(tableName, primKey, indexes);\n            }\n        });\n    };\n    Version.prototype.stores = function (stores) {\n        var db = this.db;\n        this._cfg.storesSource = this._cfg.storesSource ?\n            extend(this._cfg.storesSource, stores) :\n            stores;\n        var versions = db._versions;\n        var storesSpec = {};\n        var dbschema = {};\n        versions.forEach(function (version) {\n            extend(storesSpec, version._cfg.storesSource);\n            dbschema = (version._cfg.dbschema = {});\n            version._parseStoresSpec(storesSpec, dbschema);\n        });\n        db._dbSchema = dbschema;\n        removeTablesApi(db, [db._allTables, db, db.Transaction.prototype]);\n        setApiOnPlace(db, [db._allTables, db, db.Transaction.prototype, this._cfg.tables], keys(dbschema), dbschema);\n        db._storeNames = keys(dbschema);\n        return this;\n    };\n    Version.prototype.upgrade = function (upgradeFunction) {\n        this._cfg.contentUpgrade = promisableChain(this._cfg.contentUpgrade || nop, upgradeFunction);\n        return this;\n    };\n    return Version;\n}());\n\nfunction createVersionConstructor(db) {\n    return makeClassConstructor(Version.prototype, function Version(versionNumber) {\n        this.db = db;\n        this._cfg = {\n            version: versionNumber,\n            storesSource: null,\n            dbschema: {},\n            tables: {},\n            contentUpgrade: null\n        };\n    });\n}\n\nfunction getDbNamesTable(indexedDB, IDBKeyRange) {\n    var dbNamesDB = indexedDB[\"_dbNamesDB\"];\n    if (!dbNamesDB) {\n        dbNamesDB = indexedDB[\"_dbNamesDB\"] = new Dexie$1(DBNAMES_DB, {\n            addons: [],\n            indexedDB: indexedDB,\n            IDBKeyRange: IDBKeyRange,\n        });\n        dbNamesDB.version(1).stores({ dbnames: \"name\" });\n    }\n    return dbNamesDB.table(\"dbnames\");\n}\nfunction hasDatabasesNative(indexedDB) {\n    return indexedDB && typeof indexedDB.databases === \"function\";\n}\nfunction getDatabaseNames(_a) {\n    var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n    return hasDatabasesNative(indexedDB)\n        ? Promise.resolve(indexedDB.databases()).then(function (infos) {\n            return infos\n                .map(function (info) { return info.name; })\n                .filter(function (name) { return name !== DBNAMES_DB; });\n        })\n        : getDbNamesTable(indexedDB, IDBKeyRange).toCollection().primaryKeys();\n}\nfunction _onDatabaseCreated(_a, name) {\n    var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n    !hasDatabasesNative(indexedDB) &&\n        name !== DBNAMES_DB &&\n        getDbNamesTable(indexedDB, IDBKeyRange).put({ name: name }).catch(nop);\n}\nfunction _onDatabaseDeleted(_a, name) {\n    var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n    !hasDatabasesNative(indexedDB) &&\n        name !== DBNAMES_DB &&\n        getDbNamesTable(indexedDB, IDBKeyRange).delete(name).catch(nop);\n}\n\nfunction vip(fn) {\n    return newScope(function () {\n        PSD.letThrough = true;\n        return fn();\n    });\n}\n\nfunction idbReady() {\n    var isSafari = !navigator.userAgentData &&\n        /Safari\\//.test(navigator.userAgent) &&\n        !/Chrom(e|ium)\\//.test(navigator.userAgent);\n    if (!isSafari || !indexedDB.databases)\n        return Promise.resolve();\n    var intervalId;\n    return new Promise(function (resolve) {\n        var tryIdb = function () { return indexedDB.databases().finally(resolve); };\n        intervalId = setInterval(tryIdb, 100);\n        tryIdb();\n    }).finally(function () { return clearInterval(intervalId); });\n}\n\nfunction dexieOpen(db) {\n    var state = db._state;\n    var indexedDB = db._deps.indexedDB;\n    if (state.isBeingOpened || db.idbdb)\n        return state.dbReadyPromise.then(function () { return state.dbOpenError ?\n            rejection(state.dbOpenError) :\n            db; });\n    debug && (state.openCanceller._stackHolder = getErrorWithStack());\n    state.isBeingOpened = true;\n    state.dbOpenError = null;\n    state.openComplete = false;\n    var openCanceller = state.openCanceller;\n    function throwIfCancelled() {\n        if (state.openCanceller !== openCanceller)\n            throw new exceptions.DatabaseClosed('db.open() was cancelled');\n    }\n    var resolveDbReady = state.dbReadyResolve,\n    upgradeTransaction = null, wasCreated = false;\n    return DexiePromise.race([openCanceller, (typeof navigator === 'undefined' ? DexiePromise.resolve() : idbReady()).then(function () { return new DexiePromise(function (resolve, reject) {\n            throwIfCancelled();\n            if (!indexedDB)\n                throw new exceptions.MissingAPI();\n            var dbName = db.name;\n            var req = state.autoSchema ?\n                indexedDB.open(dbName) :\n                indexedDB.open(dbName, Math.round(db.verno * 10));\n            if (!req)\n                throw new exceptions.MissingAPI();\n            req.onerror = eventRejectHandler(reject);\n            req.onblocked = wrap(db._fireOnBlocked);\n            req.onupgradeneeded = wrap(function (e) {\n                upgradeTransaction = req.transaction;\n                if (state.autoSchema && !db._options.allowEmptyDB) {\n                    req.onerror = preventDefault;\n                    upgradeTransaction.abort();\n                    req.result.close();\n                    var delreq = indexedDB.deleteDatabase(dbName);\n                    delreq.onsuccess = delreq.onerror = wrap(function () {\n                        reject(new exceptions.NoSuchDatabase(\"Database \" + dbName + \" doesnt exist\"));\n                    });\n                }\n                else {\n                    upgradeTransaction.onerror = eventRejectHandler(reject);\n                    var oldVer = e.oldVersion > Math.pow(2, 62) ? 0 : e.oldVersion;\n                    wasCreated = oldVer < 1;\n                    db._novip.idbdb = req.result;\n                    runUpgraders(db, oldVer / 10, upgradeTransaction, reject);\n                }\n            }, reject);\n            req.onsuccess = wrap(function () {\n                upgradeTransaction = null;\n                var idbdb = db._novip.idbdb = req.result;\n                var objectStoreNames = slice(idbdb.objectStoreNames);\n                if (objectStoreNames.length > 0)\n                    try {\n                        var tmpTrans = idbdb.transaction(safariMultiStoreFix(objectStoreNames), 'readonly');\n                        if (state.autoSchema)\n                            readGlobalSchema(db, idbdb, tmpTrans);\n                        else {\n                            adjustToExistingIndexNames(db, db._dbSchema, tmpTrans);\n                            if (!verifyInstalledSchema(db, tmpTrans)) {\n                                console.warn(\"Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.\");\n                            }\n                        }\n                        generateMiddlewareStacks(db, tmpTrans);\n                    }\n                    catch (e) {\n                    }\n                connections.push(db);\n                idbdb.onversionchange = wrap(function (ev) {\n                    state.vcFired = true;\n                    db.on(\"versionchange\").fire(ev);\n                });\n                idbdb.onclose = wrap(function (ev) {\n                    db.on(\"close\").fire(ev);\n                });\n                if (wasCreated)\n                    _onDatabaseCreated(db._deps, dbName);\n                resolve();\n            }, reject);\n        }); })]).then(function () {\n        throwIfCancelled();\n        state.onReadyBeingFired = [];\n        return DexiePromise.resolve(vip(function () { return db.on.ready.fire(db.vip); })).then(function fireRemainders() {\n            if (state.onReadyBeingFired.length > 0) {\n                var remainders_1 = state.onReadyBeingFired.reduce(promisableChain, nop);\n                state.onReadyBeingFired = [];\n                return DexiePromise.resolve(vip(function () { return remainders_1(db.vip); })).then(fireRemainders);\n            }\n        });\n    }).finally(function () {\n        state.onReadyBeingFired = null;\n        state.isBeingOpened = false;\n    }).then(function () {\n        return db;\n    }).catch(function (err) {\n        state.dbOpenError = err;\n        try {\n            upgradeTransaction && upgradeTransaction.abort();\n        }\n        catch (_a) { }\n        if (openCanceller === state.openCanceller) {\n            db._close();\n        }\n        return rejection(err);\n    }).finally(function () {\n        state.openComplete = true;\n        resolveDbReady();\n    });\n}\n\nfunction awaitIterator(iterator) {\n    var callNext = function (result) { return iterator.next(result); }, doThrow = function (error) { return iterator.throw(error); }, onSuccess = step(callNext), onError = step(doThrow);\n    function step(getNext) {\n        return function (val) {\n            var next = getNext(val), value = next.value;\n            return next.done ? value :\n                (!value || typeof value.then !== 'function' ?\n                    isArray(value) ? Promise.all(value).then(onSuccess, onError) : onSuccess(value) :\n                    value.then(onSuccess, onError));\n        };\n    }\n    return step(callNext)();\n}\n\nfunction extractTransactionArgs(mode, _tableArgs_, scopeFunc) {\n    var i = arguments.length;\n    if (i < 2)\n        throw new exceptions.InvalidArgument(\"Too few arguments\");\n    var args = new Array(i - 1);\n    while (--i)\n        args[i - 1] = arguments[i];\n    scopeFunc = args.pop();\n    var tables = flatten(args);\n    return [mode, tables, scopeFunc];\n}\nfunction enterTransactionScope(db, mode, storeNames, parentTransaction, scopeFunc) {\n    return DexiePromise.resolve().then(function () {\n        var transless = PSD.transless || PSD;\n        var trans = db._createTransaction(mode, storeNames, db._dbSchema, parentTransaction);\n        var zoneProps = {\n            trans: trans,\n            transless: transless\n        };\n        if (parentTransaction) {\n            trans.idbtrans = parentTransaction.idbtrans;\n        }\n        else {\n            try {\n                trans.create();\n                db._state.PR1398_maxLoop = 3;\n            }\n            catch (ex) {\n                if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n                    console.warn('Dexie: Need to reopen db');\n                    db._close();\n                    return db.open().then(function () { return enterTransactionScope(db, mode, storeNames, null, scopeFunc); });\n                }\n                return rejection(ex);\n            }\n        }\n        var scopeFuncIsAsync = isAsyncFunction(scopeFunc);\n        if (scopeFuncIsAsync) {\n            incrementExpectedAwaits();\n        }\n        var returnValue;\n        var promiseFollowed = DexiePromise.follow(function () {\n            returnValue = scopeFunc.call(trans, trans);\n            if (returnValue) {\n                if (scopeFuncIsAsync) {\n                    var decrementor = decrementExpectedAwaits.bind(null, null);\n                    returnValue.then(decrementor, decrementor);\n                }\n                else if (typeof returnValue.next === 'function' && typeof returnValue.throw === 'function') {\n                    returnValue = awaitIterator(returnValue);\n                }\n            }\n        }, zoneProps);\n        return (returnValue && typeof returnValue.then === 'function' ?\n            DexiePromise.resolve(returnValue).then(function (x) { return trans.active ?\n                x\n                : rejection(new exceptions.PrematureCommit(\"Transaction committed too early. See http://bit.ly/2kdckMn\")); })\n            : promiseFollowed.then(function () { return returnValue; })).then(function (x) {\n            if (parentTransaction)\n                trans._resolve();\n            return trans._completion.then(function () { return x; });\n        }).catch(function (e) {\n            trans._reject(e);\n            return rejection(e);\n        });\n    });\n}\n\nfunction pad(a, value, count) {\n    var result = isArray(a) ? a.slice() : [a];\n    for (var i = 0; i < count; ++i)\n        result.push(value);\n    return result;\n}\nfunction createVirtualIndexMiddleware(down) {\n    return __assign(__assign({}, down), { table: function (tableName) {\n            var table = down.table(tableName);\n            var schema = table.schema;\n            var indexLookup = {};\n            var allVirtualIndexes = [];\n            function addVirtualIndexes(keyPath, keyTail, lowLevelIndex) {\n                var keyPathAlias = getKeyPathAlias(keyPath);\n                var indexList = (indexLookup[keyPathAlias] = indexLookup[keyPathAlias] || []);\n                var keyLength = keyPath == null ? 0 : typeof keyPath === 'string' ? 1 : keyPath.length;\n                var isVirtual = keyTail > 0;\n                var virtualIndex = __assign(__assign({}, lowLevelIndex), { isVirtual: isVirtual, keyTail: keyTail, keyLength: keyLength, extractKey: getKeyExtractor(keyPath), unique: !isVirtual && lowLevelIndex.unique });\n                indexList.push(virtualIndex);\n                if (!virtualIndex.isPrimaryKey) {\n                    allVirtualIndexes.push(virtualIndex);\n                }\n                if (keyLength > 1) {\n                    var virtualKeyPath = keyLength === 2 ?\n                        keyPath[0] :\n                        keyPath.slice(0, keyLength - 1);\n                    addVirtualIndexes(virtualKeyPath, keyTail + 1, lowLevelIndex);\n                }\n                indexList.sort(function (a, b) { return a.keyTail - b.keyTail; });\n                return virtualIndex;\n            }\n            var primaryKey = addVirtualIndexes(schema.primaryKey.keyPath, 0, schema.primaryKey);\n            indexLookup[\":id\"] = [primaryKey];\n            for (var _i = 0, _a = schema.indexes; _i < _a.length; _i++) {\n                var index = _a[_i];\n                addVirtualIndexes(index.keyPath, 0, index);\n            }\n            function findBestIndex(keyPath) {\n                var result = indexLookup[getKeyPathAlias(keyPath)];\n                return result && result[0];\n            }\n            function translateRange(range, keyTail) {\n                return {\n                    type: range.type === 1  ?\n                        2  :\n                        range.type,\n                    lower: pad(range.lower, range.lowerOpen ? down.MAX_KEY : down.MIN_KEY, keyTail),\n                    lowerOpen: true,\n                    upper: pad(range.upper, range.upperOpen ? down.MIN_KEY : down.MAX_KEY, keyTail),\n                    upperOpen: true\n                };\n            }\n            function translateRequest(req) {\n                var index = req.query.index;\n                return index.isVirtual ? __assign(__assign({}, req), { query: {\n                        index: index,\n                        range: translateRange(req.query.range, index.keyTail)\n                    } }) : req;\n            }\n            var result = __assign(__assign({}, table), { schema: __assign(__assign({}, schema), { primaryKey: primaryKey, indexes: allVirtualIndexes, getIndexByKeyPath: findBestIndex }), count: function (req) {\n                    return table.count(translateRequest(req));\n                }, query: function (req) {\n                    return table.query(translateRequest(req));\n                }, openCursor: function (req) {\n                    var _a = req.query.index, keyTail = _a.keyTail, isVirtual = _a.isVirtual, keyLength = _a.keyLength;\n                    if (!isVirtual)\n                        return table.openCursor(req);\n                    function createVirtualCursor(cursor) {\n                        function _continue(key) {\n                            key != null ?\n                                cursor.continue(pad(key, req.reverse ? down.MAX_KEY : down.MIN_KEY, keyTail)) :\n                                req.unique ?\n                                    cursor.continue(cursor.key.slice(0, keyLength)\n                                        .concat(req.reverse\n                                        ? down.MIN_KEY\n                                        : down.MAX_KEY, keyTail)) :\n                                    cursor.continue();\n                        }\n                        var virtualCursor = Object.create(cursor, {\n                            continue: { value: _continue },\n                            continuePrimaryKey: {\n                                value: function (key, primaryKey) {\n                                    cursor.continuePrimaryKey(pad(key, down.MAX_KEY, keyTail), primaryKey);\n                                }\n                            },\n                            primaryKey: {\n                                get: function () {\n                                    return cursor.primaryKey;\n                                }\n                            },\n                            key: {\n                                get: function () {\n                                    var key = cursor.key;\n                                    return keyLength === 1 ?\n                                        key[0] :\n                                        key.slice(0, keyLength);\n                                }\n                            },\n                            value: {\n                                get: function () {\n                                    return cursor.value;\n                                }\n                            }\n                        });\n                        return virtualCursor;\n                    }\n                    return table.openCursor(translateRequest(req))\n                        .then(function (cursor) { return cursor && createVirtualCursor(cursor); });\n                } });\n            return result;\n        } });\n}\nvar virtualIndexMiddleware = {\n    stack: \"dbcore\",\n    name: \"VirtualIndexMiddleware\",\n    level: 1,\n    create: createVirtualIndexMiddleware\n};\n\nfunction getObjectDiff(a, b, rv, prfx) {\n    rv = rv || {};\n    prfx = prfx || '';\n    keys(a).forEach(function (prop) {\n        if (!hasOwn(b, prop)) {\n            rv[prfx + prop] = undefined;\n        }\n        else {\n            var ap = a[prop], bp = b[prop];\n            if (typeof ap === 'object' && typeof bp === 'object' && ap && bp) {\n                var apTypeName = toStringTag(ap);\n                var bpTypeName = toStringTag(bp);\n                if (apTypeName !== bpTypeName) {\n                    rv[prfx + prop] = b[prop];\n                }\n                else if (apTypeName === 'Object') {\n                    getObjectDiff(ap, bp, rv, prfx + prop + '.');\n                }\n                else if (ap !== bp) {\n                    rv[prfx + prop] = b[prop];\n                }\n            }\n            else if (ap !== bp)\n                rv[prfx + prop] = b[prop];\n        }\n    });\n    keys(b).forEach(function (prop) {\n        if (!hasOwn(a, prop)) {\n            rv[prfx + prop] = b[prop];\n        }\n    });\n    return rv;\n}\n\nfunction getEffectiveKeys(primaryKey, req) {\n    if (req.type === 'delete')\n        return req.keys;\n    return req.keys || req.values.map(primaryKey.extractKey);\n}\n\nvar hooksMiddleware = {\n    stack: \"dbcore\",\n    name: \"HooksMiddleware\",\n    level: 2,\n    create: function (downCore) { return (__assign(__assign({}, downCore), { table: function (tableName) {\n            var downTable = downCore.table(tableName);\n            var primaryKey = downTable.schema.primaryKey;\n            var tableMiddleware = __assign(__assign({}, downTable), { mutate: function (req) {\n                    var dxTrans = PSD.trans;\n                    var _a = dxTrans.table(tableName).hook, deleting = _a.deleting, creating = _a.creating, updating = _a.updating;\n                    switch (req.type) {\n                        case 'add':\n                            if (creating.fire === nop)\n                                break;\n                            return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                        case 'put':\n                            if (creating.fire === nop && updating.fire === nop)\n                                break;\n                            return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                        case 'delete':\n                            if (deleting.fire === nop)\n                                break;\n                            return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                        case 'deleteRange':\n                            if (deleting.fire === nop)\n                                break;\n                            return dxTrans._promise('readwrite', function () { return deleteRange(req); }, true);\n                    }\n                    return downTable.mutate(req);\n                    function addPutOrDelete(req) {\n                        var dxTrans = PSD.trans;\n                        var keys = req.keys || getEffectiveKeys(primaryKey, req);\n                        if (!keys)\n                            throw new Error(\"Keys missing\");\n                        req = req.type === 'add' || req.type === 'put' ? __assign(__assign({}, req), { keys: keys }) : __assign({}, req);\n                        if (req.type !== 'delete')\n                            req.values = __spreadArray([], req.values, true);\n                        if (req.keys)\n                            req.keys = __spreadArray([], req.keys, true);\n                        return getExistingValues(downTable, req, keys).then(function (existingValues) {\n                            var contexts = keys.map(function (key, i) {\n                                var existingValue = existingValues[i];\n                                var ctx = { onerror: null, onsuccess: null };\n                                if (req.type === 'delete') {\n                                    deleting.fire.call(ctx, key, existingValue, dxTrans);\n                                }\n                                else if (req.type === 'add' || existingValue === undefined) {\n                                    var generatedPrimaryKey = creating.fire.call(ctx, key, req.values[i], dxTrans);\n                                    if (key == null && generatedPrimaryKey != null) {\n                                        key = generatedPrimaryKey;\n                                        req.keys[i] = key;\n                                        if (!primaryKey.outbound) {\n                                            setByKeyPath(req.values[i], primaryKey.keyPath, key);\n                                        }\n                                    }\n                                }\n                                else {\n                                    var objectDiff = getObjectDiff(existingValue, req.values[i]);\n                                    var additionalChanges_1 = updating.fire.call(ctx, objectDiff, key, existingValue, dxTrans);\n                                    if (additionalChanges_1) {\n                                        var requestedValue_1 = req.values[i];\n                                        Object.keys(additionalChanges_1).forEach(function (keyPath) {\n                                            if (hasOwn(requestedValue_1, keyPath)) {\n                                                requestedValue_1[keyPath] = additionalChanges_1[keyPath];\n                                            }\n                                            else {\n                                                setByKeyPath(requestedValue_1, keyPath, additionalChanges_1[keyPath]);\n                                            }\n                                        });\n                                    }\n                                }\n                                return ctx;\n                            });\n                            return downTable.mutate(req).then(function (_a) {\n                                var failures = _a.failures, results = _a.results, numFailures = _a.numFailures, lastResult = _a.lastResult;\n                                for (var i = 0; i < keys.length; ++i) {\n                                    var primKey = results ? results[i] : keys[i];\n                                    var ctx = contexts[i];\n                                    if (primKey == null) {\n                                        ctx.onerror && ctx.onerror(failures[i]);\n                                    }\n                                    else {\n                                        ctx.onsuccess && ctx.onsuccess(req.type === 'put' && existingValues[i] ?\n                                            req.values[i] :\n                                            primKey\n                                        );\n                                    }\n                                }\n                                return { failures: failures, results: results, numFailures: numFailures, lastResult: lastResult };\n                            }).catch(function (error) {\n                                contexts.forEach(function (ctx) { return ctx.onerror && ctx.onerror(error); });\n                                return Promise.reject(error);\n                            });\n                        });\n                    }\n                    function deleteRange(req) {\n                        return deleteNextChunk(req.trans, req.range, 10000);\n                    }\n                    function deleteNextChunk(trans, range, limit) {\n                        return downTable.query({ trans: trans, values: false, query: { index: primaryKey, range: range }, limit: limit })\n                            .then(function (_a) {\n                            var result = _a.result;\n                            return addPutOrDelete({ type: 'delete', keys: result, trans: trans }).then(function (res) {\n                                if (res.numFailures > 0)\n                                    return Promise.reject(res.failures[0]);\n                                if (result.length < limit) {\n                                    return { failures: [], numFailures: 0, lastResult: undefined };\n                                }\n                                else {\n                                    return deleteNextChunk(trans, __assign(__assign({}, range), { lower: result[result.length - 1], lowerOpen: true }), limit);\n                                }\n                            });\n                        });\n                    }\n                } });\n            return tableMiddleware;\n        } })); }\n};\nfunction getExistingValues(table, req, effectiveKeys) {\n    return req.type === \"add\"\n        ? Promise.resolve([])\n        : table.getMany({ trans: req.trans, keys: effectiveKeys, cache: \"immutable\" });\n}\n\nfunction getFromTransactionCache(keys, cache, clone) {\n    try {\n        if (!cache)\n            return null;\n        if (cache.keys.length < keys.length)\n            return null;\n        var result = [];\n        for (var i = 0, j = 0; i < cache.keys.length && j < keys.length; ++i) {\n            if (cmp(cache.keys[i], keys[j]) !== 0)\n                continue;\n            result.push(clone ? deepClone(cache.values[i]) : cache.values[i]);\n            ++j;\n        }\n        return result.length === keys.length ? result : null;\n    }\n    catch (_a) {\n        return null;\n    }\n}\nvar cacheExistingValuesMiddleware = {\n    stack: \"dbcore\",\n    level: -1,\n    create: function (core) {\n        return {\n            table: function (tableName) {\n                var table = core.table(tableName);\n                return __assign(__assign({}, table), { getMany: function (req) {\n                        if (!req.cache) {\n                            return table.getMany(req);\n                        }\n                        var cachedResult = getFromTransactionCache(req.keys, req.trans[\"_cache\"], req.cache === \"clone\");\n                        if (cachedResult) {\n                            return DexiePromise.resolve(cachedResult);\n                        }\n                        return table.getMany(req).then(function (res) {\n                            req.trans[\"_cache\"] = {\n                                keys: req.keys,\n                                values: req.cache === \"clone\" ? deepClone(res) : res,\n                            };\n                            return res;\n                        });\n                    }, mutate: function (req) {\n                        if (req.type !== \"add\")\n                            req.trans[\"_cache\"] = null;\n                        return table.mutate(req);\n                    } });\n            },\n        };\n    },\n};\n\nvar _a;\nfunction isEmptyRange(node) {\n    return !(\"from\" in node);\n}\nvar RangeSet = function (fromOrTree, to) {\n    if (this) {\n        extend(this, arguments.length ? { d: 1, from: fromOrTree, to: arguments.length > 1 ? to : fromOrTree } : { d: 0 });\n    }\n    else {\n        var rv = new RangeSet();\n        if (fromOrTree && (\"d\" in fromOrTree)) {\n            extend(rv, fromOrTree);\n        }\n        return rv;\n    }\n};\nprops(RangeSet.prototype, (_a = {\n        add: function (rangeSet) {\n            mergeRanges(this, rangeSet);\n            return this;\n        },\n        addKey: function (key) {\n            addRange(this, key, key);\n            return this;\n        },\n        addKeys: function (keys) {\n            var _this = this;\n            keys.forEach(function (key) { return addRange(_this, key, key); });\n            return this;\n        }\n    },\n    _a[iteratorSymbol] = function () {\n        return getRangeSetIterator(this);\n    },\n    _a));\nfunction addRange(target, from, to) {\n    var diff = cmp(from, to);\n    if (isNaN(diff))\n        return;\n    if (diff > 0)\n        throw RangeError();\n    if (isEmptyRange(target))\n        return extend(target, { from: from, to: to, d: 1 });\n    var left = target.l;\n    var right = target.r;\n    if (cmp(to, target.from) < 0) {\n        left\n            ? addRange(left, from, to)\n            : (target.l = { from: from, to: to, d: 1, l: null, r: null });\n        return rebalance(target);\n    }\n    if (cmp(from, target.to) > 0) {\n        right\n            ? addRange(right, from, to)\n            : (target.r = { from: from, to: to, d: 1, l: null, r: null });\n        return rebalance(target);\n    }\n    if (cmp(from, target.from) < 0) {\n        target.from = from;\n        target.l = null;\n        target.d = right ? right.d + 1 : 1;\n    }\n    if (cmp(to, target.to) > 0) {\n        target.to = to;\n        target.r = null;\n        target.d = target.l ? target.l.d + 1 : 1;\n    }\n    var rightWasCutOff = !target.r;\n    if (left && !target.l) {\n        mergeRanges(target, left);\n    }\n    if (right && rightWasCutOff) {\n        mergeRanges(target, right);\n    }\n}\nfunction mergeRanges(target, newSet) {\n    function _addRangeSet(target, _a) {\n        var from = _a.from, to = _a.to, l = _a.l, r = _a.r;\n        addRange(target, from, to);\n        if (l)\n            _addRangeSet(target, l);\n        if (r)\n            _addRangeSet(target, r);\n    }\n    if (!isEmptyRange(newSet))\n        _addRangeSet(target, newSet);\n}\nfunction rangesOverlap(rangeSet1, rangeSet2) {\n    var i1 = getRangeSetIterator(rangeSet2);\n    var nextResult1 = i1.next();\n    if (nextResult1.done)\n        return false;\n    var a = nextResult1.value;\n    var i2 = getRangeSetIterator(rangeSet1);\n    var nextResult2 = i2.next(a.from);\n    var b = nextResult2.value;\n    while (!nextResult1.done && !nextResult2.done) {\n        if (cmp(b.from, a.to) <= 0 && cmp(b.to, a.from) >= 0)\n            return true;\n        cmp(a.from, b.from) < 0\n            ? (a = (nextResult1 = i1.next(b.from)).value)\n            : (b = (nextResult2 = i2.next(a.from)).value);\n    }\n    return false;\n}\nfunction getRangeSetIterator(node) {\n    var state = isEmptyRange(node) ? null : { s: 0, n: node };\n    return {\n        next: function (key) {\n            var keyProvided = arguments.length > 0;\n            while (state) {\n                switch (state.s) {\n                    case 0:\n                        state.s = 1;\n                        if (keyProvided) {\n                            while (state.n.l && cmp(key, state.n.from) < 0)\n                                state = { up: state, n: state.n.l, s: 1 };\n                        }\n                        else {\n                            while (state.n.l)\n                                state = { up: state, n: state.n.l, s: 1 };\n                        }\n                    case 1:\n                        state.s = 2;\n                        if (!keyProvided || cmp(key, state.n.to) <= 0)\n                            return { value: state.n, done: false };\n                    case 2:\n                        if (state.n.r) {\n                            state.s = 3;\n                            state = { up: state, n: state.n.r, s: 0 };\n                            continue;\n                        }\n                    case 3:\n                        state = state.up;\n                }\n            }\n            return { done: true };\n        },\n    };\n}\nfunction rebalance(target) {\n    var _a, _b;\n    var diff = (((_a = target.r) === null || _a === void 0 ? void 0 : _a.d) || 0) - (((_b = target.l) === null || _b === void 0 ? void 0 : _b.d) || 0);\n    var r = diff > 1 ? \"r\" : diff < -1 ? \"l\" : \"\";\n    if (r) {\n        var l = r === \"r\" ? \"l\" : \"r\";\n        var rootClone = __assign({}, target);\n        var oldRootRight = target[r];\n        target.from = oldRootRight.from;\n        target.to = oldRootRight.to;\n        target[r] = oldRootRight[r];\n        rootClone[r] = oldRootRight[l];\n        target[l] = rootClone;\n        rootClone.d = computeDepth(rootClone);\n    }\n    target.d = computeDepth(target);\n}\nfunction computeDepth(_a) {\n    var r = _a.r, l = _a.l;\n    return (r ? (l ? Math.max(r.d, l.d) : r.d) : l ? l.d : 0) + 1;\n}\n\nvar observabilityMiddleware = {\n    stack: \"dbcore\",\n    level: 0,\n    create: function (core) {\n        var dbName = core.schema.name;\n        var FULL_RANGE = new RangeSet(core.MIN_KEY, core.MAX_KEY);\n        return __assign(__assign({}, core), { table: function (tableName) {\n                var table = core.table(tableName);\n                var schema = table.schema;\n                var primaryKey = schema.primaryKey;\n                var extractKey = primaryKey.extractKey, outbound = primaryKey.outbound;\n                var tableClone = __assign(__assign({}, table), { mutate: function (req) {\n                        var trans = req.trans;\n                        var mutatedParts = trans.mutatedParts || (trans.mutatedParts = {});\n                        var getRangeSet = function (indexName) {\n                            var part = \"idb://\" + dbName + \"/\" + tableName + \"/\" + indexName;\n                            return (mutatedParts[part] ||\n                                (mutatedParts[part] = new RangeSet()));\n                        };\n                        var pkRangeSet = getRangeSet(\"\");\n                        var delsRangeSet = getRangeSet(\":dels\");\n                        var type = req.type;\n                        var _a = req.type === \"deleteRange\"\n                            ? [req.range]\n                            : req.type === \"delete\"\n                                ? [req.keys]\n                                : req.values.length < 50\n                                    ? [[], req.values]\n                                    : [], keys = _a[0], newObjs = _a[1];\n                        var oldCache = req.trans[\"_cache\"];\n                        return table.mutate(req).then(function (res) {\n                            if (isArray(keys)) {\n                                if (type !== \"delete\")\n                                    keys = res.results;\n                                pkRangeSet.addKeys(keys);\n                                var oldObjs = getFromTransactionCache(keys, oldCache);\n                                if (!oldObjs && type !== \"add\") {\n                                    delsRangeSet.addKeys(keys);\n                                }\n                                if (oldObjs || newObjs) {\n                                    trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs);\n                                }\n                            }\n                            else if (keys) {\n                                var range = { from: keys.lower, to: keys.upper };\n                                delsRangeSet.add(range);\n                                pkRangeSet.add(range);\n                            }\n                            else {\n                                pkRangeSet.add(FULL_RANGE);\n                                delsRangeSet.add(FULL_RANGE);\n                                schema.indexes.forEach(function (idx) { return getRangeSet(idx.name).add(FULL_RANGE); });\n                            }\n                            return res;\n                        });\n                    } });\n                var getRange = function (_a) {\n                    var _b, _c;\n                    var _d = _a.query, index = _d.index, range = _d.range;\n                    return [\n                        index,\n                        new RangeSet((_b = range.lower) !== null && _b !== void 0 ? _b : core.MIN_KEY, (_c = range.upper) !== null && _c !== void 0 ? _c : core.MAX_KEY),\n                    ];\n                };\n                var readSubscribers = {\n                    get: function (req) { return [primaryKey, new RangeSet(req.key)]; },\n                    getMany: function (req) { return [primaryKey, new RangeSet().addKeys(req.keys)]; },\n                    count: getRange,\n                    query: getRange,\n                    openCursor: getRange,\n                };\n                keys(readSubscribers).forEach(function (method) {\n                    tableClone[method] = function (req) {\n                        var subscr = PSD.subscr;\n                        if (subscr) {\n                            var getRangeSet = function (indexName) {\n                                var part = \"idb://\" + dbName + \"/\" + tableName + \"/\" + indexName;\n                                return (subscr[part] ||\n                                    (subscr[part] = new RangeSet()));\n                            };\n                            var pkRangeSet_1 = getRangeSet(\"\");\n                            var delsRangeSet_1 = getRangeSet(\":dels\");\n                            var _a = readSubscribers[method](req), queriedIndex = _a[0], queriedRanges = _a[1];\n                            getRangeSet(queriedIndex.name || \"\").add(queriedRanges);\n                            if (!queriedIndex.isPrimaryKey) {\n                                if (method === \"count\") {\n                                    delsRangeSet_1.add(FULL_RANGE);\n                                }\n                                else {\n                                    var keysPromise_1 = method === \"query\" &&\n                                        outbound &&\n                                        req.values &&\n                                        table.query(__assign(__assign({}, req), { values: false }));\n                                    return table[method].apply(this, arguments).then(function (res) {\n                                        if (method === \"query\") {\n                                            if (outbound && req.values) {\n                                                return keysPromise_1.then(function (_a) {\n                                                    var resultingKeys = _a.result;\n                                                    pkRangeSet_1.addKeys(resultingKeys);\n                                                    return res;\n                                                });\n                                            }\n                                            var pKeys = req.values\n                                                ? res.result.map(extractKey)\n                                                : res.result;\n                                            if (req.values) {\n                                                pkRangeSet_1.addKeys(pKeys);\n                                            }\n                                            else {\n                                                delsRangeSet_1.addKeys(pKeys);\n                                            }\n                                        }\n                                        else if (method === \"openCursor\") {\n                                            var cursor_1 = res;\n                                            var wantValues_1 = req.values;\n                                            return (cursor_1 &&\n                                                Object.create(cursor_1, {\n                                                    key: {\n                                                        get: function () {\n                                                            delsRangeSet_1.addKey(cursor_1.primaryKey);\n                                                            return cursor_1.key;\n                                                        },\n                                                    },\n                                                    primaryKey: {\n                                                        get: function () {\n                                                            var pkey = cursor_1.primaryKey;\n                                                            delsRangeSet_1.addKey(pkey);\n                                                            return pkey;\n                                                        },\n                                                    },\n                                                    value: {\n                                                        get: function () {\n                                                            wantValues_1 && pkRangeSet_1.addKey(cursor_1.primaryKey);\n                                                            return cursor_1.value;\n                                                        },\n                                                    },\n                                                }));\n                                        }\n                                        return res;\n                                    });\n                                }\n                            }\n                        }\n                        return table[method].apply(this, arguments);\n                    };\n                });\n                return tableClone;\n            } });\n    },\n};\nfunction trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs) {\n    function addAffectedIndex(ix) {\n        var rangeSet = getRangeSet(ix.name || \"\");\n        function extractKey(obj) {\n            return obj != null ? ix.extractKey(obj) : null;\n        }\n        var addKeyOrKeys = function (key) { return ix.multiEntry && isArray(key)\n            ? key.forEach(function (key) { return rangeSet.addKey(key); })\n            : rangeSet.addKey(key); };\n        (oldObjs || newObjs).forEach(function (_, i) {\n            var oldKey = oldObjs && extractKey(oldObjs[i]);\n            var newKey = newObjs && extractKey(newObjs[i]);\n            if (cmp(oldKey, newKey) !== 0) {\n                if (oldKey != null)\n                    addKeyOrKeys(oldKey);\n                if (newKey != null)\n                    addKeyOrKeys(newKey);\n            }\n        });\n    }\n    schema.indexes.forEach(addAffectedIndex);\n}\n\nvar Dexie$1 =  (function () {\n    function Dexie(name, options) {\n        var _this = this;\n        this._middlewares = {};\n        this.verno = 0;\n        var deps = Dexie.dependencies;\n        this._options = options = __assign({\n            addons: Dexie.addons, autoOpen: true,\n            indexedDB: deps.indexedDB, IDBKeyRange: deps.IDBKeyRange }, options);\n        this._deps = {\n            indexedDB: options.indexedDB,\n            IDBKeyRange: options.IDBKeyRange\n        };\n        var addons = options.addons;\n        this._dbSchema = {};\n        this._versions = [];\n        this._storeNames = [];\n        this._allTables = {};\n        this.idbdb = null;\n        this._novip = this;\n        var state = {\n            dbOpenError: null,\n            isBeingOpened: false,\n            onReadyBeingFired: null,\n            openComplete: false,\n            dbReadyResolve: nop,\n            dbReadyPromise: null,\n            cancelOpen: nop,\n            openCanceller: null,\n            autoSchema: true,\n            PR1398_maxLoop: 3\n        };\n        state.dbReadyPromise = new DexiePromise(function (resolve) {\n            state.dbReadyResolve = resolve;\n        });\n        state.openCanceller = new DexiePromise(function (_, reject) {\n            state.cancelOpen = reject;\n        });\n        this._state = state;\n        this.name = name;\n        this.on = Events(this, \"populate\", \"blocked\", \"versionchange\", \"close\", { ready: [promisableChain, nop] });\n        this.on.ready.subscribe = override(this.on.ready.subscribe, function (subscribe) {\n            return function (subscriber, bSticky) {\n                Dexie.vip(function () {\n                    var state = _this._state;\n                    if (state.openComplete) {\n                        if (!state.dbOpenError)\n                            DexiePromise.resolve().then(subscriber);\n                        if (bSticky)\n                            subscribe(subscriber);\n                    }\n                    else if (state.onReadyBeingFired) {\n                        state.onReadyBeingFired.push(subscriber);\n                        if (bSticky)\n                            subscribe(subscriber);\n                    }\n                    else {\n                        subscribe(subscriber);\n                        var db_1 = _this;\n                        if (!bSticky)\n                            subscribe(function unsubscribe() {\n                                db_1.on.ready.unsubscribe(subscriber);\n                                db_1.on.ready.unsubscribe(unsubscribe);\n                            });\n                    }\n                });\n            };\n        });\n        this.Collection = createCollectionConstructor(this);\n        this.Table = createTableConstructor(this);\n        this.Transaction = createTransactionConstructor(this);\n        this.Version = createVersionConstructor(this);\n        this.WhereClause = createWhereClauseConstructor(this);\n        this.on(\"versionchange\", function (ev) {\n            if (ev.newVersion > 0)\n                console.warn(\"Another connection wants to upgrade database '\" + _this.name + \"'. Closing db now to resume the upgrade.\");\n            else\n                console.warn(\"Another connection wants to delete database '\" + _this.name + \"'. Closing db now to resume the delete request.\");\n            _this.close();\n        });\n        this.on(\"blocked\", function (ev) {\n            if (!ev.newVersion || ev.newVersion < ev.oldVersion)\n                console.warn(\"Dexie.delete('\" + _this.name + \"') was blocked\");\n            else\n                console.warn(\"Upgrade '\" + _this.name + \"' blocked by other connection holding version \" + ev.oldVersion / 10);\n        });\n        this._maxKey = getMaxKey(options.IDBKeyRange);\n        this._createTransaction = function (mode, storeNames, dbschema, parentTransaction) { return new _this.Transaction(mode, storeNames, dbschema, _this._options.chromeTransactionDurability, parentTransaction); };\n        this._fireOnBlocked = function (ev) {\n            _this.on(\"blocked\").fire(ev);\n            connections\n                .filter(function (c) { return c.name === _this.name && c !== _this && !c._state.vcFired; })\n                .map(function (c) { return c.on(\"versionchange\").fire(ev); });\n        };\n        this.use(virtualIndexMiddleware);\n        this.use(hooksMiddleware);\n        this.use(observabilityMiddleware);\n        this.use(cacheExistingValuesMiddleware);\n        this.vip = Object.create(this, { _vip: { value: true } });\n        addons.forEach(function (addon) { return addon(_this); });\n    }\n    Dexie.prototype.version = function (versionNumber) {\n        if (isNaN(versionNumber) || versionNumber < 0.1)\n            throw new exceptions.Type(\"Given version is not a positive number\");\n        versionNumber = Math.round(versionNumber * 10) / 10;\n        if (this.idbdb || this._state.isBeingOpened)\n            throw new exceptions.Schema(\"Cannot add version when database is open\");\n        this.verno = Math.max(this.verno, versionNumber);\n        var versions = this._versions;\n        var versionInstance = versions.filter(function (v) { return v._cfg.version === versionNumber; })[0];\n        if (versionInstance)\n            return versionInstance;\n        versionInstance = new this.Version(versionNumber);\n        versions.push(versionInstance);\n        versions.sort(lowerVersionFirst);\n        versionInstance.stores({});\n        this._state.autoSchema = false;\n        return versionInstance;\n    };\n    Dexie.prototype._whenReady = function (fn) {\n        var _this = this;\n        return (this.idbdb && (this._state.openComplete || PSD.letThrough || this._vip)) ? fn() : new DexiePromise(function (resolve, reject) {\n            if (_this._state.openComplete) {\n                return reject(new exceptions.DatabaseClosed(_this._state.dbOpenError));\n            }\n            if (!_this._state.isBeingOpened) {\n                if (!_this._options.autoOpen) {\n                    reject(new exceptions.DatabaseClosed());\n                    return;\n                }\n                _this.open().catch(nop);\n            }\n            _this._state.dbReadyPromise.then(resolve, reject);\n        }).then(fn);\n    };\n    Dexie.prototype.use = function (_a) {\n        var stack = _a.stack, create = _a.create, level = _a.level, name = _a.name;\n        if (name)\n            this.unuse({ stack: stack, name: name });\n        var middlewares = this._middlewares[stack] || (this._middlewares[stack] = []);\n        middlewares.push({ stack: stack, create: create, level: level == null ? 10 : level, name: name });\n        middlewares.sort(function (a, b) { return a.level - b.level; });\n        return this;\n    };\n    Dexie.prototype.unuse = function (_a) {\n        var stack = _a.stack, name = _a.name, create = _a.create;\n        if (stack && this._middlewares[stack]) {\n            this._middlewares[stack] = this._middlewares[stack].filter(function (mw) {\n                return create ? mw.create !== create :\n                    name ? mw.name !== name :\n                        false;\n            });\n        }\n        return this;\n    };\n    Dexie.prototype.open = function () {\n        return dexieOpen(this);\n    };\n    Dexie.prototype._close = function () {\n        var state = this._state;\n        var idx = connections.indexOf(this);\n        if (idx >= 0)\n            connections.splice(idx, 1);\n        if (this.idbdb) {\n            try {\n                this.idbdb.close();\n            }\n            catch (e) { }\n            this._novip.idbdb = null;\n        }\n        state.dbReadyPromise = new DexiePromise(function (resolve) {\n            state.dbReadyResolve = resolve;\n        });\n        state.openCanceller = new DexiePromise(function (_, reject) {\n            state.cancelOpen = reject;\n        });\n    };\n    Dexie.prototype.close = function () {\n        this._close();\n        var state = this._state;\n        this._options.autoOpen = false;\n        state.dbOpenError = new exceptions.DatabaseClosed();\n        if (state.isBeingOpened)\n            state.cancelOpen(state.dbOpenError);\n    };\n    Dexie.prototype.delete = function () {\n        var _this = this;\n        var hasArguments = arguments.length > 0;\n        var state = this._state;\n        return new DexiePromise(function (resolve, reject) {\n            var doDelete = function () {\n                _this.close();\n                var req = _this._deps.indexedDB.deleteDatabase(_this.name);\n                req.onsuccess = wrap(function () {\n                    _onDatabaseDeleted(_this._deps, _this.name);\n                    resolve();\n                });\n                req.onerror = eventRejectHandler(reject);\n                req.onblocked = _this._fireOnBlocked;\n            };\n            if (hasArguments)\n                throw new exceptions.InvalidArgument(\"Arguments not allowed in db.delete()\");\n            if (state.isBeingOpened) {\n                state.dbReadyPromise.then(doDelete);\n            }\n            else {\n                doDelete();\n            }\n        });\n    };\n    Dexie.prototype.backendDB = function () {\n        return this.idbdb;\n    };\n    Dexie.prototype.isOpen = function () {\n        return this.idbdb !== null;\n    };\n    Dexie.prototype.hasBeenClosed = function () {\n        var dbOpenError = this._state.dbOpenError;\n        return dbOpenError && (dbOpenError.name === 'DatabaseClosed');\n    };\n    Dexie.prototype.hasFailed = function () {\n        return this._state.dbOpenError !== null;\n    };\n    Dexie.prototype.dynamicallyOpened = function () {\n        return this._state.autoSchema;\n    };\n    Object.defineProperty(Dexie.prototype, \"tables\", {\n        get: function () {\n            var _this = this;\n            return keys(this._allTables).map(function (name) { return _this._allTables[name]; });\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Dexie.prototype.transaction = function () {\n        var args = extractTransactionArgs.apply(this, arguments);\n        return this._transaction.apply(this, args);\n    };\n    Dexie.prototype._transaction = function (mode, tables, scopeFunc) {\n        var _this = this;\n        var parentTransaction = PSD.trans;\n        if (!parentTransaction || parentTransaction.db !== this || mode.indexOf('!') !== -1)\n            parentTransaction = null;\n        var onlyIfCompatible = mode.indexOf('?') !== -1;\n        mode = mode.replace('!', '').replace('?', '');\n        var idbMode, storeNames;\n        try {\n            storeNames = tables.map(function (table) {\n                var storeName = table instanceof _this.Table ? table.name : table;\n                if (typeof storeName !== 'string')\n                    throw new TypeError(\"Invalid table argument to Dexie.transaction(). Only Table or String are allowed\");\n                return storeName;\n            });\n            if (mode == \"r\" || mode === READONLY)\n                idbMode = READONLY;\n            else if (mode == \"rw\" || mode == READWRITE)\n                idbMode = READWRITE;\n            else\n                throw new exceptions.InvalidArgument(\"Invalid transaction mode: \" + mode);\n            if (parentTransaction) {\n                if (parentTransaction.mode === READONLY && idbMode === READWRITE) {\n                    if (onlyIfCompatible) {\n                        parentTransaction = null;\n                    }\n                    else\n                        throw new exceptions.SubTransaction(\"Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY\");\n                }\n                if (parentTransaction) {\n                    storeNames.forEach(function (storeName) {\n                        if (parentTransaction && parentTransaction.storeNames.indexOf(storeName) === -1) {\n                            if (onlyIfCompatible) {\n                                parentTransaction = null;\n                            }\n                            else\n                                throw new exceptions.SubTransaction(\"Table \" + storeName +\n                                    \" not included in parent transaction.\");\n                        }\n                    });\n                }\n                if (onlyIfCompatible && parentTransaction && !parentTransaction.active) {\n                    parentTransaction = null;\n                }\n            }\n        }\n        catch (e) {\n            return parentTransaction ?\n                parentTransaction._promise(null, function (_, reject) { reject(e); }) :\n                rejection(e);\n        }\n        var enterTransaction = enterTransactionScope.bind(null, this, idbMode, storeNames, parentTransaction, scopeFunc);\n        return (parentTransaction ?\n            parentTransaction._promise(idbMode, enterTransaction, \"lock\") :\n            PSD.trans ?\n                usePSD(PSD.transless, function () { return _this._whenReady(enterTransaction); }) :\n                this._whenReady(enterTransaction));\n    };\n    Dexie.prototype.table = function (tableName) {\n        if (!hasOwn(this._allTables, tableName)) {\n            throw new exceptions.InvalidTable(\"Table \" + tableName + \" does not exist\");\n        }\n        return this._allTables[tableName];\n    };\n    return Dexie;\n}());\n\nvar symbolObservable = typeof Symbol !== \"undefined\" && \"observable\" in Symbol\n    ? Symbol.observable\n    : \"@@observable\";\nvar Observable =  (function () {\n    function Observable(subscribe) {\n        this._subscribe = subscribe;\n    }\n    Observable.prototype.subscribe = function (x, error, complete) {\n        return this._subscribe(!x || typeof x === \"function\" ? { next: x, error: error, complete: complete } : x);\n    };\n    Observable.prototype[symbolObservable] = function () {\n        return this;\n    };\n    return Observable;\n}());\n\nfunction extendObservabilitySet(target, newSet) {\n    keys(newSet).forEach(function (part) {\n        var rangeSet = target[part] || (target[part] = new RangeSet());\n        mergeRanges(rangeSet, newSet[part]);\n    });\n    return target;\n}\n\nfunction liveQuery(querier) {\n    return new Observable(function (observer) {\n        var scopeFuncIsAsync = isAsyncFunction(querier);\n        function execute(subscr) {\n            if (scopeFuncIsAsync) {\n                incrementExpectedAwaits();\n            }\n            var exec = function () { return newScope(querier, { subscr: subscr, trans: null }); };\n            var rv = PSD.trans\n                ?\n                    usePSD(PSD.transless, exec)\n                : exec();\n            if (scopeFuncIsAsync) {\n                rv.then(decrementExpectedAwaits, decrementExpectedAwaits);\n            }\n            return rv;\n        }\n        var closed = false;\n        var accumMuts = {};\n        var currentObs = {};\n        var subscription = {\n            get closed() {\n                return closed;\n            },\n            unsubscribe: function () {\n                closed = true;\n                globalEvents.storagemutated.unsubscribe(mutationListener);\n            },\n        };\n        observer.start && observer.start(subscription);\n        var querying = false, startedListening = false;\n        function shouldNotify() {\n            return keys(currentObs).some(function (key) {\n                return accumMuts[key] && rangesOverlap(accumMuts[key], currentObs[key]);\n            });\n        }\n        var mutationListener = function (parts) {\n            extendObservabilitySet(accumMuts, parts);\n            if (shouldNotify()) {\n                doQuery();\n            }\n        };\n        var doQuery = function () {\n            if (querying || closed)\n                return;\n            accumMuts = {};\n            var subscr = {};\n            var ret = execute(subscr);\n            if (!startedListening) {\n                globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, mutationListener);\n                startedListening = true;\n            }\n            querying = true;\n            Promise.resolve(ret).then(function (result) {\n                querying = false;\n                if (closed)\n                    return;\n                if (shouldNotify()) {\n                    doQuery();\n                }\n                else {\n                    accumMuts = {};\n                    currentObs = subscr;\n                    observer.next && observer.next(result);\n                }\n            }, function (err) {\n                querying = false;\n                observer.error && observer.error(err);\n                subscription.unsubscribe();\n            });\n        };\n        doQuery();\n        return subscription;\n    });\n}\n\nvar domDeps;\ntry {\n    domDeps = {\n        indexedDB: _global.indexedDB || _global.mozIndexedDB || _global.webkitIndexedDB || _global.msIndexedDB,\n        IDBKeyRange: _global.IDBKeyRange || _global.webkitIDBKeyRange\n    };\n}\ncatch (e) {\n    domDeps = { indexedDB: null, IDBKeyRange: null };\n}\n\nvar Dexie = Dexie$1;\nprops(Dexie, __assign(__assign({}, fullNameExceptions), {\n    delete: function (databaseName) {\n        var db = new Dexie(databaseName, { addons: [] });\n        return db.delete();\n    },\n    exists: function (name) {\n        return new Dexie(name, { addons: [] }).open().then(function (db) {\n            db.close();\n            return true;\n        }).catch('NoSuchDatabaseError', function () { return false; });\n    },\n    getDatabaseNames: function (cb) {\n        try {\n            return getDatabaseNames(Dexie.dependencies).then(cb);\n        }\n        catch (_a) {\n            return rejection(new exceptions.MissingAPI());\n        }\n    },\n    defineClass: function () {\n        function Class(content) {\n            extend(this, content);\n        }\n        return Class;\n    }, ignoreTransaction: function (scopeFunc) {\n        return PSD.trans ?\n            usePSD(PSD.transless, scopeFunc) :\n            scopeFunc();\n    }, vip: vip, async: function (generatorFn) {\n        return function () {\n            try {\n                var rv = awaitIterator(generatorFn.apply(this, arguments));\n                if (!rv || typeof rv.then !== 'function')\n                    return DexiePromise.resolve(rv);\n                return rv;\n            }\n            catch (e) {\n                return rejection(e);\n            }\n        };\n    }, spawn: function (generatorFn, args, thiz) {\n        try {\n            var rv = awaitIterator(generatorFn.apply(thiz, args || []));\n            if (!rv || typeof rv.then !== 'function')\n                return DexiePromise.resolve(rv);\n            return rv;\n        }\n        catch (e) {\n            return rejection(e);\n        }\n    },\n    currentTransaction: {\n        get: function () { return PSD.trans || null; }\n    }, waitFor: function (promiseOrFunction, optionalTimeout) {\n        var promise = DexiePromise.resolve(typeof promiseOrFunction === 'function' ?\n            Dexie.ignoreTransaction(promiseOrFunction) :\n            promiseOrFunction)\n            .timeout(optionalTimeout || 60000);\n        return PSD.trans ?\n            PSD.trans.waitFor(promise) :\n            promise;\n    },\n    Promise: DexiePromise,\n    debug: {\n        get: function () { return debug; },\n        set: function (value) {\n            setDebug(value, value === 'dexie' ? function () { return true; } : dexieStackFrameFilter);\n        }\n    },\n    derive: derive, extend: extend, props: props, override: override,\n    Events: Events, on: globalEvents, liveQuery: liveQuery, extendObservabilitySet: extendObservabilitySet,\n    getByKeyPath: getByKeyPath, setByKeyPath: setByKeyPath, delByKeyPath: delByKeyPath, shallowClone: shallowClone, deepClone: deepClone, getObjectDiff: getObjectDiff, cmp: cmp, asap: asap$1,\n    minKey: minKey,\n    addons: [],\n    connections: connections,\n    errnames: errnames,\n    dependencies: domDeps,\n    semVer: DEXIE_VERSION, version: DEXIE_VERSION.split('.')\n        .map(function (n) { return parseInt(n); })\n        .reduce(function (p, c, i) { return p + (c / Math.pow(10, i * 2)); }) }));\nDexie.maxKey = getMaxKey(Dexie.dependencies.IDBKeyRange);\n\nif (typeof dispatchEvent !== 'undefined' && typeof addEventListener !== 'undefined') {\n    globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, function (updatedParts) {\n        if (!propagatingLocally) {\n            var event_1;\n            if (isIEOrEdge) {\n                event_1 = document.createEvent('CustomEvent');\n                event_1.initCustomEvent(STORAGE_MUTATED_DOM_EVENT_NAME, true, true, updatedParts);\n            }\n            else {\n                event_1 = new CustomEvent(STORAGE_MUTATED_DOM_EVENT_NAME, {\n                    detail: updatedParts\n                });\n            }\n            propagatingLocally = true;\n            dispatchEvent(event_1);\n            propagatingLocally = false;\n        }\n    });\n    addEventListener(STORAGE_MUTATED_DOM_EVENT_NAME, function (_a) {\n        var detail = _a.detail;\n        if (!propagatingLocally) {\n            propagateLocally(detail);\n        }\n    });\n}\nfunction propagateLocally(updateParts) {\n    var wasMe = propagatingLocally;\n    try {\n        propagatingLocally = true;\n        globalEvents.storagemutated.fire(updateParts);\n    }\n    finally {\n        propagatingLocally = wasMe;\n    }\n}\nvar propagatingLocally = false;\n\nif (typeof BroadcastChannel !== 'undefined') {\n    var bc_1 = new BroadcastChannel(STORAGE_MUTATED_DOM_EVENT_NAME);\n    if (typeof bc_1.unref === 'function') {\n        bc_1.unref();\n    }\n    globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, function (changedParts) {\n        if (!propagatingLocally) {\n            bc_1.postMessage(changedParts);\n        }\n    });\n    bc_1.onmessage = function (ev) {\n        if (ev.data)\n            propagateLocally(ev.data);\n    };\n}\nelse if (typeof self !== 'undefined' && typeof navigator !== 'undefined') {\n    globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, function (changedParts) {\n        try {\n            if (!propagatingLocally) {\n                if (typeof localStorage !== 'undefined') {\n                    localStorage.setItem(STORAGE_MUTATED_DOM_EVENT_NAME, JSON.stringify({\n                        trig: Math.random(),\n                        changedParts: changedParts,\n                    }));\n                }\n                if (typeof self['clients'] === 'object') {\n                    __spreadArray([], self['clients'].matchAll({ includeUncontrolled: true }), true).forEach(function (client) {\n                        return client.postMessage({\n                            type: STORAGE_MUTATED_DOM_EVENT_NAME,\n                            changedParts: changedParts,\n                        });\n                    });\n                }\n            }\n        }\n        catch (_a) { }\n    });\n    if (typeof addEventListener !== 'undefined') {\n        addEventListener('storage', function (ev) {\n            if (ev.key === STORAGE_MUTATED_DOM_EVENT_NAME) {\n                var data = JSON.parse(ev.newValue);\n                if (data)\n                    propagateLocally(data.changedParts);\n            }\n        });\n    }\n    var swContainer = self.document && navigator.serviceWorker;\n    if (swContainer) {\n        swContainer.addEventListener('message', propagateMessageLocally);\n    }\n}\nfunction propagateMessageLocally(_a) {\n    var data = _a.data;\n    if (data && data.type === STORAGE_MUTATED_DOM_EVENT_NAME) {\n        propagateLocally(data.changedParts);\n    }\n}\n\nDexiePromise.rejectionMapper = mapError;\nsetDebug(debug, dexieStackFrameFilter);\n\nexport { Dexie$1 as Dexie, RangeSet, Dexie$1 as default, liveQuery, mergeRanges, rangesOverlap };\n//# sourceMappingURL=dexie.mjs.map\n"],"names":["root","factory","exports","module","define","amd","a","i","self","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","__assign","assign","t","s","n","arguments","length","p","apply","this","__spreadArray","to","from","pack","ar","l","Array","slice","concat","_global","globalThis","window","global","keys","isArray","extend","extension","forEach","Promise","getProto","getPrototypeOf","_hasOwn","hasOwn","props","proto","Reflect","ownKeys","setProp","functionOrGetSet","options","set","configurable","writable","derive","Child","Parent","create","bind","getOwnPropertyDescriptor","getPropertyDescriptor","_slice","args","start","end","override","origFunc","overridedFactory","assert","b","Error","asap$1","fn","setImmediate","setTimeout","arrayToObject","array","extractor","reduce","result","item","nameAndValue","getByKeyPath","keyPath","rv","val","push","period","indexOf","innerObj","substr","undefined","setByKeyPath","isFrozen","currentKeyPath","remainingKeyPath","isNaN","parseInt","splice","shallowClone","m","flatten","intrinsicTypeNames","split","map","num","filter","intrinsicTypes","x","circularRefs","deepClone","any","WeakMap","innerDeepClone","constructor","toString","iteratorSymbol","iterator","getIteratorOf","NO_CHAR_ARRAY","getArrayOf","arrayLike","it","next","done","isAsyncFunction","debug","location","test","href","setDebug","libraryFilter","NEEDS_THROW_FOR_STACK","stack","getErrorWithStack","e","prettyStack","exception","numIgnoredFrames","name","message","frame","join","idbDomErrorNames","errorList","defaultTexts","VersionChanged","DatabaseClosed","Abort","TransactionInactive","MissingAPI","DexieError","msg","_e","getMultiErrorMessage","failures","v","ModifyError","successCount","failedKeys","BulkError","pos","failuresByPos","_stack","errnames","BaseException","exceptions","fullName","msgOrInner","inner","Syntax","SyntaxError","Type","TypeError","Range","RangeError","exceptionMap","fullNameExceptions","nop","mirror","pureFunctionChain","f1","f2","callBoth","on1","on2","hookCreatingChain","res","onsuccess","onerror","res2","hookDeletingChain","hookUpdatingChain","modifications","reverseStoppableEventChain","promisableChain","then","thiz","INTERNAL","ZONE_ECHO_LIMIT","_a$1","globalP","resolve","crypto","subtle","nativeP","digest","Uint8Array","resolvedNativePromise","nativePromiseProto","resolvedGlobalPromise","nativePromiseThen","NativePromise","patchGlobalPromise","stack_being_generated","schedulePhysicalTick","physicalTick","MutationObserver","hiddenDiv","document","createElement","observe","attributes","setAttribute","asap","callback","microtickQueue","needsNewPhysicalTick","isOutsideMicroTick","unhandledErrors","rejectingErrors","currentFulfiller","rejectionMapper","globalPSD","id","ref","unhandleds","onunhandled","globalError","pgp","env","finalize","uh","PSD","numScheduledCalls","tickFinalizers","DexiePromise","_listeners","onuncatched","_lib","psd","_PSD","_stackHolder","_prev","_numPrev","_state","_value","handleRejection","executePromiseTask","thenProp","microTaskId","totalEchoes","onFulfilled","onRejected","_this","possibleAwait","cleanup","decrementExpectedAwaits","reject","propagateToListener","Listener","nativeAwaitCompatibleWrap","linkToPreviousPromise","zone","promise","shouldExecuteTick","beginMicroTickScope","_then","propagateAllListeners","endMicroTickScope","ex","reason","_promise","origProp","tryCatch","some","addPossiblyUnhandledError","listeners","len","finalizePhysicalTick","listener","cb","callListener","ret","markErrorAsHandled","getStack","stacks","limit","errorName","failure","prev","numPrev","wasRootExec","callbacks","unhandledErrs","finalizers","PromiseReject","wrap","errorCatcher","outerScope","switchToZone","catch","type","handler","err","finally","onFinally","timeout","ms","Infinity","handle","Timeout","clearTimeout","snapShot","all","values","onPossibleParallellAsync","remaining","race","newPSD","newScope","usePSD","scheduler","follow","zoneProps","finalizer","allSettled","possiblePromises","results","status","AggregateError","task","awaits","echoes","taskCounter","zoneStack","zoneEchoes","zone_id_counter","a1","a2","parent","globalEnv","PromiseProp","nthen","getPatchedPromiseThen","gthen","incrementExpectedAwaits","possiblePromise","rejection","zoneEnterEcho","targetZone","zoneLeaveEcho","pop","bEnteringZone","currentZone","enqueueNativeMicroTask","GlobalPromise_1","targetEnv","GlobalPromise","a3","job","outerZone","origThen","onResolved","UNHANDLEDREJECTION","event","eventData","createEvent","initEvent","CustomEvent","detail","dispatchEvent","PromiseRejectionEvent","onunhandledrejection","_","defaultPrevented","console","warn","tempTransaction","db","mode","storeNames","idbdb","openComplete","letThrough","_vip","trans","_createTransaction","_dbSchema","PR1398_maxLoop","InvalidState","isOpen","_close","open","_completion","dbOpenError","isBeingOpened","_options","autoOpen","dbReadyPromise","DEXIE_VERSION","maxString","String","fromCharCode","minKey","INVALID_KEY_ARGUMENT","STRING_EXPECTED","connections","isIEOrEdge","navigator","userAgent","hasIEDeleteObjectStoreBug","hangsOnDeleteLargeKeyRange","dexieStackFrameFilter","DBNAMES_DB","READONLY","READWRITE","combine","filter1","filter2","AnyRange","lower","lowerOpen","upper","upperOpen","workaroundForUndefinedPrimKey","Table","_trans","writeLocked","_tx","tableName","checkTableInTransaction","schema","NotFound","idbtrans","transless","keyOrCrit","where","first","core","hook","reading","fire","indexOrCrit","WhereClause","keyPaths","equals","compoundIndex","indexes","primKey","ix","compound","every","_maxKey","kp","JSON","stringify","idxByName","idb","_deps","indexedDB","cmp","_a","prevIndex","prevFilterFn","index","multi","idx","filterFunction","toCollection","and","count","thenShortcut","offset","numRows","each","toArray","Collection","orderBy","reverse","mapToClass","mappedClass","readHook","unsubscribe","defineClass","content","add","auto","objToAdd","mutate","numFailures","lastResult","update","keyOrObject","modify","InvalidArgument","put","delete","clear","range","bulkGet","getMany","bulkAdd","objects","keysOrOptions","wantResults","allKeys","numObjects","objectsToAdd","bulkPut","objectsToPut","bulkDelete","numKeys","Events","ctx","evs","eventName","subscriber","subscribe","addEventType","chainFunction","defaultFunction","cfg","context","subscribers","makeClassConstructor","isPlainKeyRange","ignoreLimitFilter","algorithm","or","justLimit","replayFilter","addFilter","addReplayFilter","isLimitFilter","curr","getIndexOrStore","coreSchema","isPrimKey","primaryKey","getIndexByKeyPath","Schema","openCursor","coreTable","keysOnly","dir","unique","query","iter","coreTrans","set_1","union","cursor","advance","stop","fail","_iterate","iterate","valueMapper","cursorPromise","wrappedFn","c","continue","advancer","ta","tb","NaN","al","bl","compareUint8Arrays","getUint8Array","compareArrays","ArrayBuffer","isView","tsTag","buffer","byteOffset","byteLength","_read","_ctx","error","table","_write","_addAlgorithm","clone","raw","Math","min","sortBy","parts","lastPart","lastIndex","getval","order","sorter","aVal","bVal","sort","valueMapper_1","a_1","offsetLeft","rowsLeft","until","bIncludeStopEntry","last","isMatch","indexName","_ondirectionchange","desc","eachKey","eachUniqueKey","eachPrimaryKey","primaryKeys","uniqueKeys","firstKey","lastKey","distinct","strKey","found","changes","modifyer","anythingModified","outbound","extractKey","modifyChunkSize","totalFailures","applyMutateResult","expectedCount","_i","nextChunk","cache","addValues","putValues","putKeys","deleteKeys","origValue","ctx_1","criteria","deleteCallback","changeSpec","coreRange","simpleCompare","simpleCompareReverse","collectionOrWhereClause","T","collection","emptyCollection","whereClause","rangeEqual","nextCasing","lowerKey","upperNeedle","lowerNeedle","llp","lwrKeyChar","addIgnoreCaseAlgorithm","match","needles","suffix","compare","upperNeedles","lowerNeedles","direction","nextKeySuffix","needlesLen","initDirection","toUpperCase","toLowerCase","upperFactory","lowerFactory","needleBounds","needle","nb","createRange","firstPossibleNeedle","lowestPossibleCasing","casing","between","includeLower","includeUpper","_cmp","above","aboveOrEqual","below","belowOrEqual","startsWith","str","startsWithIgnoreCase","equalsIgnoreCase","anyOfIgnoreCase","startsWithAnyOfIgnoreCase","anyOf","_ascending","_descending","notEqual","inAnyRange","includeLowers","includeUppers","noneOf","ranges","ascending","descending","_min","max","_max","sortDirection","rangeSorter","newRange","rangePos","keyIsBeyondCurrentEntry","keyIsBeforeCurrentEntry","checkKey","keyWithinCurrentRange","startsWithAnyOf","eventRejectHandler","preventDefault","target","stopPropagation","DEXIE_STORAGE_MUTATED_EVENT_NAME","STORAGE_MUTATED_DOM_EVENT_NAME","globalEvents","Transaction","_lock","_reculock","lockOwnerFor","_unlock","_blockedFuncs","_locked","fnAndPSD","shift","OpenFailed","active","transaction","durability","chromeTransactionDurability","ev","_reject","onabort","on","oncomplete","_resolve","storagemutated","bWriteLock","ReadOnly","_root","waitFor","promiseLike","_waitingFor","_waitingQueue","store","objectStore","spin","_spinCount","currentWaitPromise","abort","memoizedTables","_memoizedTables","tableSchema","transactionBoundTable","createIndexSpec","src","nameFromKeyPath","createTableSchema","getMaxKey","IdbKeyRange","only","getKeyExtractor","getSinglePathKeyExtractor","arrayify","_id_counter","getKeyPathAlias","createMiddlewareStacks","middlewares","tmpTrans","IDBKeyRange","dbcore","stackImpl","down","createMiddlewareStack","makeIDBKeyRange","upperBound","lowerBound","bound","tables","objectStoreNames","autoIncrement","indexByKeyPath","isPrimaryKey","indexNames","multiEntry","hasGetAll","extractSchema","isAddOrPut","req","reqs","errorHandler","args1","args2","keyCount","callbackCount","successHandler","_pos","request","nonInfinitLimit","source","idbKeyRange","getAll","getAllKeys","count_1","req_1","openKeyCursor","result_1","___id","_cursorContinue","_cursorContinuePrimaryKey","continuePrimaryKey","_cursorAdvance","doThrowCursorIsStopped","gotOne","iterationPromise","resolveIteration","rejectIteration","guardedCallback","createDbCoreTable","tableMap","MIN_KEY","MAX_KEY","createDBCore","generateMiddlewareStacks","_novip","_middlewares","tbl","setApiOnPlace","objs","tableNames","dbschema","propDesc","removeTablesApi","lowerVersionFirst","_cfg","version","getSchemaDiff","oldSchema","newSchema","diff","del","change","oldDef","newDef","def","recreate","oldIndexes","newIndexes","idxName","oldIdx","newIdx","createTable","createObjectStore","addIndex","createIndex","buildGlobalSchema","globalSchema","storeName","j","idbindex","adjustToExistingIndexNames","_hasGetAll","dexieName","indexSpec","WorkerGlobalScope","Version","_parseStoresSpec","stores","outSchema","indexNum","trim","replace","storesSource","versions","_versions","storesSpec","_allTables","_storeNames","upgrade","upgradeFunction","contentUpgrade","getDbNamesTable","dbNamesDB","Dexie$1","addons","dbnames","hasDatabasesNative","databases","vip","idbReady","intervalId","userAgentData","tryIdb","setInterval","clearInterval","dexieOpen","state","openCanceller","throwIfCancelled","resolveDbReady","dbReadyResolve","upgradeTransaction","wasCreated","dbName","autoSchema","round","verno","onblocked","_fireOnBlocked","onupgradeneeded","allowEmptyDB","close","delreq","deleteDatabase","NoSuchDatabase","oldVer","oldVersion","pow","idbUpgradeTrans","rejectTransaction","populate","queue","anyContentUpgraderHasRun","tuple","Upgrade","store_1","deleteIndex","upgradeSchema_1","returnValue_1","contentUpgradeIsAsync_1","promiseFollowed","decrementor","deleteObjectStore","deleteRemovedTables","runQueue","contains","updateTablesAndIndexes","runUpgraders","readGlobalSchema","ch","verifyInstalledSchema","onversionchange","vcFired","onclose","_onDatabaseCreated","onReadyBeingFired","ready","fireRemainders","remainders_1","awaitIterator","callNext","onSuccess","step","onError","throw","getNext","extractTransactionArgs","_tableArgs_","scopeFunc","enterTransactionScope","parentTransaction","returnValue","scopeFuncIsAsync","PrematureCommit","pad","virtualIndexMiddleware","level","indexLookup","allVirtualIndexes","addVirtualIndexes","keyTail","lowLevelIndex","keyPathAlias","indexList","keyLength","isVirtual","virtualIndex","translateRequest","virtualCursor","createVirtualCursor","getObjectDiff","prfx","ap","bp","apTypeName","hooksMiddleware","downCore","downTable","tableMiddleware","dxTrans","deleting","creating","updating","addPutOrDelete","deleteNextChunk","deleteRange","getEffectiveKeys","effectiveKeys","getExistingValues","existingValues","contexts","existingValue","generatedPrimaryKey","objectDiff","additionalChanges_1","requestedValue_1","getFromTransactionCache","cacheExistingValuesMiddleware","cachedResult","isEmptyRange","node","RangeSet","fromOrTree","d","addRange","left","right","r","rebalance","rightWasCutOff","mergeRanges","newSet","_addRangeSet","rangesOverlap","rangeSet1","rangeSet2","i1","getRangeSetIterator","nextResult1","i2","nextResult2","keyProvided","up","_b","rootClone","oldRootRight","computeDepth","rangeSet","addKey","addKeys","domDeps","observabilityMiddleware","FULL_RANGE","tableClone","mutatedParts","getRangeSet","part","pkRangeSet","delsRangeSet","newObjs","oldCache","oldObjs","addKeyOrKeys","oldKey","newKey","trackAffectedIndexes","getRange","_c","_d","readSubscribers","method","subscr","pkRangeSet_1","delsRangeSet_1","queriedIndex","queriedRanges","keysPromise_1","resultingKeys","pKeys","cursor_1","wantValues_1","pkey","Dexie","deps","dependencies","cancelOpen","bSticky","db_1","keyRangeGenerator","keyRange","whereCtx","readingHook","createTableConstructor","complete","wasActive","createTransactionConstructor","versionNumber","createVersionConstructor","orCollection","_IDBKeyRange","createWhereClauseConstructor","newVersion","use","addon","versionInstance","_whenReady","unuse","mw","hasArguments","doDelete","_onDatabaseDeleted","backendDB","hasBeenClosed","hasFailed","dynamicallyOpened","_transaction","idbMode","onlyIfCompatible","SubTransaction","enterTransaction","InvalidTable","symbolObservable","observable","Observable","_subscribe","extendObservabilitySet","liveQuery","querier","observer","closed","accumMuts","currentObs","subscription","mutationListener","querying","startedListening","shouldNotify","doQuery","exec","execute","mozIndexedDB","webkitIndexedDB","msIndexedDB","webkitIDBKeyRange","propagateLocally","updateParts","wasMe","propagatingLocally","databaseName","exists","getDatabaseNames","infos","info","ignoreTransaction","async","generatorFn","spawn","currentTransaction","promiseOrFunction","optionalTimeout","delByKeyPath","semVer","maxKey","addEventListener","updatedParts","event_1","initCustomEvent","BroadcastChannel","bc_1","unref","changedParts","postMessage","onmessage","data","localStorage","setItem","trig","random","matchAll","includeUncontrolled","client","parse","newValue","swContainer","serviceWorker","domError"],"sourceRoot":""}