/*! For license information please see dexie-export-import.js.LICENSE.txt */
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var t={};function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}e.r(t),e.d(t,{default:()=>gn,exportDB:()=>sn,importDB:()=>yn,importInto:()=>bn,peakImportFile:()=>vn});var r=Object.keys,i=Array.isArray,o="undefined"!=typeof self?self:"undefined"!=typeof window?window:e.g;function a(e,t){return"object"!==n(t)||r(t).forEach((function(n){e[n]=t[n]})),e}var u=Object.getPrototypeOf,c={}.hasOwnProperty;function s(e,t){return c.call(e,t)}function f(e,t){"function"==typeof t&&(t=t(u(e))),r(t).forEach((function(n){h(e,n,t[n])}))}var l=Object.defineProperty;function h(e,t,n,r){l(e,t,a(n&&s(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function p(e){return{from:function(t){return e.prototype=Object.create(t.prototype),h(e.prototype,"constructor",e),{extend:f.bind(null,e.prototype)}}}}var d=Object.getOwnPropertyDescriptor;function y(e,t){var n;return d(e,t)||(n=u(e))&&y(n,t)}var v=[].slice;function b(e,t,n){return v.call(e,t,n)}function m(e,t){return t(e)}function g(e){if(!e)throw new Error("Assertion Failed")}function w(e){o.setImmediate?setImmediate(e):setTimeout(e,0)}function _(e,t){return e.reduce((function(e,n,r){var i=t(n,r);return i&&(e[i[0]]=i[1]),e}),{})}function O(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}function S(e,t){if(s(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=S(e,t[r]);n.push(o)}return n}var a=t.indexOf(".");if(-1!==a){var u=e[t.substr(0,a)];return void 0===u?void 0:S(u,t.substr(a+1))}}function k(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){g("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)k(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var a=t.substr(0,o),u=t.substr(o+1);if(""===u)void 0===n?delete e[a]:e[a]=n;else{var c=e[a];c||(c=e[a]={}),k(c,u,n)}}else void 0===n?delete e[t]:e[t]=n}}function E(e){var t={};for(var n in e)s(e,n)&&(t[n]=e[n]);return t}var A=[].concat;function j(e){return A.apply([],e)}var x="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(j([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return o[e]})).map((function(e){return o[e]}));function T(e){if(!e||"object"!==n(e))return e;var t;if(i(e)){t=[];for(var r=0,o=e.length;r<o;++r)t.push(T(e[r]))}else if(x.indexOf(e.constructor)>=0)t=e;else for(var a in t=e.constructor?Object.create(e.constructor.prototype):{},e)s(e,a)&&(t[a]=T(e[a]));return t}function N(e,t,i,o){return i=i||{},o=o||"",r(e).forEach((function(r){if(s(t,r)){var a=e[r],u=t[r];"object"===n(a)&&"object"===n(u)&&a&&u&&""+a.constructor==""+u.constructor?N(a,u,i,o+r+"."):a!==u&&(i[o+r]=t[r])}else i[o+r]=void 0})),r(t).forEach((function(n){s(e,n)||(i[o+n]=t[n])})),i}var P="undefined"!=typeof Symbol&&Symbol.iterator,I=P?function(e){var t;return null!=e&&(t=e[P])&&t.apply(e)}:function(){return null},B={};function C(e){var t,n,r,o;if(1===arguments.length){if(i(e))return e.slice();if(this===B&&"string"==typeof e)return[e];if(o=I(e)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var D="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function R(e,t){D=e,U=t}var U=function(){return!0},F=!new Error("").stack;function L(){if(F)try{throw L.arguments,new Error}catch(e){return e}return new Error}function K(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(U).map((function(e){return"\n"+e})).join("")):""}var M=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],q=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(M),V={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function J(e,t){this._e=L(),this.name=e,this.message=t}function $(e,t,n,r){this._e=L(),this.failures=t,this.failedKeys=r,this.successCount=n}function G(e,t){this._e=L(),this.name="BulkError",this.failures=t,this.message=function(e,t){return e+". Errors: "+t.map((function(e){return e.toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}(e,t)}p(J).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+K(this._e,2))}},toString:function(){return this.name+": "+this.message}}),p($).from(J),p(G).from(J);var Y=q.reduce((function(e,t){return e[t]=t+"Error",e}),{}),z=J,H=q.reduce((function(e,t){var r=t+"Error";function i(e,i){this._e=L(),this.name=r,e?"string"==typeof e?(this.message=e,this.inner=i||null):"object"===n(e)&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=V[t]||r,this.inner=null)}return p(i).from(z),e[t]=i,e}),{});H.Syntax=SyntaxError,H.Type=TypeError,H.Range=RangeError;var Q=M.reduce((function(e,t){return e[t+"Error"]=H[t],e}),{}),W=q.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=H[t]),e}),{});function X(){}function Z(e){return e}function ee(e,t){return null==e||e===Z?t:function(n){return t(e(n))}}function te(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ne(e,t){return e===X?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?te(r,this.onsuccess):r),i&&(this.onerror=this.onerror?te(i,this.onerror):i),void 0!==o?o:n}}function re(e,t){return e===X?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?te(n,this.onsuccess):n),r&&(this.onerror=this.onerror?te(r,this.onerror):r)}}function ie(e,t){return e===X?t:function(n){var r=e.apply(this,arguments);a(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var u=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?te(i,this.onsuccess):i),o&&(this.onerror=this.onerror?te(o,this.onerror):o),void 0===r?void 0===u?void 0:u:a(r,u)}}function oe(e,t){return e===X?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function ae(e,t){return e===X?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}W.ModifyError=$,W.DexieError=J,W.BulkError=G;var ue={},ce=7,se=function(){try{return new Function("let F=async ()=>{},p=F();return [p,Object.getPrototypeOf(p),Promise.resolve(),F.constructor];")()}catch(t){var e=o.Promise;return e?[e.resolve(),e.prototype,e.resolve()]:[]}}(),fe=se[0],le=se[1],he=se[2],pe=le&&le.then,de=fe&&fe.constructor,ye=se[3],ve=!!he,be=!1,me=he?function(){he.then(Me)}:o.setImmediate?setImmediate.bind(null,Me):o.MutationObserver?function(){var e=document.createElement("div");new MutationObserver((function(){Me(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(Me,0)},ge=function(e,t){xe.push([e,t]),_e&&(me(),_e=!1)},we=!0,_e=!0,Oe=[],Se=[],ke=null,Ee=Z,Ae={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:lt,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(e){try{lt(e[0],e[1])}catch(e){}}))}},je=Ae,xe=[],Te=0,Ne=[];function Pe(e){if("object"!==n(this))throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=X,this._lib=!1;var t=this._PSD=je;if(D&&(this._stackHolder=L(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==ue)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&De(this,this._value))}this._state=null,this._value=null,++t.ref,Ce(this,e)}var Ie={get:function(){var e=je,t=We;function n(n,r){var i=this,o=!e.global&&(e!==je||t!==We);o&&tt();var a=new Pe((function(t,a){Ue(i,new Be(ct(n,e,o),ct(r,e,o),t,a,e))}));return D&&Ke(a,this),a}return n.prototype=ue,n},set:function(e){h(this,"then",e&&e.prototype===ue?Ie:{get:function(){return e},set:Ie.set})}};function Be(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function Ce(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&qe();t&&"function"==typeof t.then?Ce(e,(function(e,n){t instanceof Pe?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,Re(e)),n&&Ve()}}),De.bind(null,e))}catch(t){De(e,t)}}function De(e,t){if(Se.push(t),null===e._state){var r=e._lib&&qe();t=Ee(t),e._state=!1,e._value=t,D&&null!==t&&"object"===n(t)&&!t._promise&&O((function(){var n=y(t,"stack");t._promise=e,h(t,"stack",{get:function(){return be?n&&(n.get?n.get.apply(t):n.value):e.stack}})})),function(e){Oe.some((function(t){return t._value===e._value}))||Oe.push(e)}(e),Re(e),r&&Ve()}}function Re(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ue(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===Te&&(++Te,ge((function(){0==--Te&&Je()}),[]))}function Ue(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Te,ge(Fe,[n,e,t])}else e._listeners.push(t)}function Fe(e,t,n){try{ke=t;var r,i=t._value;t._state?r=e(i):(Se.length&&(Se=[]),r=e(i),-1===Se.indexOf(i)&&function(e){for(var t=Oe.length;t;)if(Oe[--t]._value===e._value)return void Oe.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{ke=null,0==--Te&&Je(),--n.psd.ref||n.psd.finalize()}}function Le(e,t,n){if(t.length===n)return t;var r="";if(!1===e._state){var i,o,a=e._value;null!=a?(i=a.name||"Error",o=a.message||a,r=K(a,0)):(i=a,o=""),t.push(i+(o?": "+o:"")+r)}return D&&((r=K(e._stackHolder,2))&&-1===t.indexOf(r)&&t.push(r),e._prev&&Le(e._prev,t,n)),t}function Ke(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function Me(){qe()&&Ve()}function qe(){var e=we;return we=!1,_e=!1,e}function Ve(){var e,t,n;do{for(;xe.length>0;)for(e=xe,xe=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(xe.length>0);we=!0,_e=!0}function Je(){var e=Oe;Oe=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=Ne.slice(0),n=t.length;n;)t[--n]()}function $e(e){return new Pe(ue,!1,e)}function Ge(e,t){var n=je;return function(){var r=qe(),i=je;try{return ot(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{ot(i,!1),r&&Ve()}}}f(Pe.prototype,{then:Ie,_then:function(e,t){Ue(this,new Be(null,null,e,t,je))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(function(e){return e instanceof t?n(e):$e(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):$e(e)}))},finally:function(e){return this.then((function(t){return e(),t}),(function(t){return e(),$e(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{be=!0;var e=Le(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{be=!1}}},timeout:function(e,t){var n=this;return e<1/0?new Pe((function(r,i){var o=setTimeout((function(){return i(new H.Timeout(t))}),e);n.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&h(Pe.prototype,Symbol.toStringTag,"Promise"),Ae.env=at(),f(Pe,{all:function(){var e=C.apply(null,arguments).map(nt);return new Pe((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(i,o){return Pe.resolve(i).then((function(n){e[o]=n,--r||t(e)}),n)}))}))},resolve:function(e){if(e instanceof Pe)return e;if(e&&"function"==typeof e.then)return new Pe((function(t,n){e.then(t,n)}));var t=new Pe(ue,!0,e);return Ke(t,ke),t},reject:$e,race:function(){var e=C.apply(null,arguments).map(nt);return new Pe((function(t,n){e.map((function(e){return Pe.resolve(e).then(t,n)}))}))},PSD:{get:function(){return je},set:function(e){return je=e}},newPSD:Ze,usePSD:ut,scheduler:{get:function(){return ge},set:function(e){ge=e}},rejectionMapper:{get:function(){return Ee},set:function(e){Ee=e}},follow:function(e,t){return new Pe((function(n,r){return Ze((function(t,n){var r=je;r.unhandleds=[],r.onunhandled=n,r.finalize=te((function(){var e=this;Ne.push((function r(){0===e.unhandleds.length?t():n(e.unhandleds[0]),Ne.splice(Ne.indexOf(r),1)})),++Te,ge((function(){0==--Te&&Je()}),[])}),r.finalize),e()}),t,n,r)}))}});var Ye={awaits:0,echoes:0,id:0},ze=0,He=[],Qe=0,We=0,Xe=0;function Ze(e,t,n,r){var i=je,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++Xe;var u=Ae.env;o.env=ve?{Promise:Pe,PromiseProp:{value:Pe,configurable:!0,writable:!0},all:Pe.all,race:Pe.race,resolve:Pe.resolve,reject:Pe.reject,nthen:st(u.nthen,o),gthen:st(u.gthen,o)}:{},t&&a(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var c=ut(o,e,n,r);return 0===o.ref&&o.finalize(),c}function et(){return Ye.id||(Ye.id=++ze),++Ye.awaits,Ye.echoes+=ce,Ye.id}function tt(e){!Ye.awaits||e&&e!==Ye.id||(0==--Ye.awaits&&(Ye.id=0),Ye.echoes=Ye.awaits*ce)}function nt(e){return Ye.echoes&&e&&e.constructor===de?(et(),e.then((function(e){return tt(),e}),(function(e){return tt(),ht(e)}))):e}function rt(e){++We,Ye.echoes&&0!=--Ye.echoes||(Ye.echoes=Ye.id=0),He.push(je),ot(e,!0)}function it(){var e=He[He.length-1];He.pop(),ot(e,!1)}function ot(e,t){var n,r=je;if((t?!Ye.echoes||Qe++&&e===je:!Qe||--Qe&&e===je)||(n=t?rt.bind(null,e):it,pe.call(fe,n)),e!==je&&(je=e,r===Ae&&(Ae.env=at()),ve)){var i=Ae.env.Promise,a=e.env;le.then=a.nthen,i.prototype.then=a.gthen,(r.global||e.global)&&(Object.defineProperty(o,"Promise",a.PromiseProp),i.all=a.all,i.race=a.race,i.resolve=a.resolve,i.reject=a.reject)}}function at(){var e=o.Promise;return ve?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:e.all,race:e.race,resolve:e.resolve,reject:e.reject,nthen:le.then,gthen:e.prototype.then}:{}}function ut(e,t,n,r,i){var o=je;try{return ot(e,!0),t(n,r,i)}finally{ot(o,!1)}}function ct(e,t,n){return"function"!=typeof e?e:function(){var r=je;n&&et(),ot(t,!0);try{return e.apply(this,arguments)}finally{ot(r,!1)}}}function st(e,t){return function(n,r){return e.call(this,ct(n,t,!1),ct(r,t,!1))}}var ft="unhandledrejection";function lt(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var r,i={promise:t,reason:e};if(o.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(ft,!0,!0),a(r,i)):o.CustomEvent&&a(r=new CustomEvent(ft,{detail:i}),i),r&&o.dispatchEvent&&(dispatchEvent(r),!o.PromiseRejectionEvent&&o.onunhandledrejection))try{o.onunhandledrejection(r)}catch(e){}r.defaultPrevented||console.warn("Unhandled rejection: "+(e.stack||e))}catch(e){}}var ht=Pe.reject;function pt(e){var t={},o=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return t[n].subscribe.apply(null,o),e}if("string"==typeof n)return t[n]};o.addEventType=c;for(var a=1,u=arguments.length;a<u;++a)c(arguments[a]);return o;function c(e,a,u){if("object"!==n(e)){var s;a||(a=oe),u||(u=X);var f={subscribers:[],fire:u,subscribe:function(e){-1===f.subscribers.indexOf(e)&&(f.subscribers.push(e),f.fire=a(f.fire,e))},unsubscribe:function(e){f.subscribers=f.subscribers.filter((function(t){return t!==e})),f.fire=f.subscribers.reduce(a,u)}};return t[e]=o[e]=f,f}r(s=e).forEach((function(e){var t=s[e];if(i(t))c(e,s[e][0],s[e][1]);else{if("asap"!==t)throw new H.InvalidArgument("Invalid event config");var n=c(e,Z,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];n.subscribers.forEach((function(e){w((function(){e.apply(null,t)}))}))}))}}))}}var dt,yt="{version}",vt=String.fromCharCode(65535),bt=function(){try{return IDBKeyRange.only([[]]),[[]]}catch(e){return vt}}(),mt=-1/0,gt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",wt="String expected.",_t=[],Ot="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),St=Ot,kt=Ot,Et=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};function At(e,t){var u,c,l,p,d=At.dependencies,y=a({addons:At.addons,autoOpen:!0,indexedDB:d.indexedDB,IDBKeyRange:d.IDBKeyRange},t),v=y.addons,w=y.autoOpen,A=y.indexedDB,x=y.IDBKeyRange,P=this._dbSchema={},I=[],R=[],U={},F=null,M=null,q=!1,V=null,J=!1,Y="readonly",z="readwrite",Q=this,W=new Pe((function(e){u=e})),te=new Pe((function(e,t){c=t})),oe=!0,ue=!!Ft(A);function ce(e){this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function se(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){fe(i,e)})),i}function fe(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function le(e,t,n){if(J||je.letThrough){var r=Q._createTransaction(e,t,P);try{r.create()}catch(e){return ht(e)}return r._promise(e,(function(e,t){return Ze((function(){return je.trans=r,n(e,t,r)}))})).then((function(e){return r._completion.then((function(){return e}))}))}if(!q){if(!w)return ht(new H.DatabaseClosed);Q.open().catch(X)}return W.then((function(){return le(e,t,n)}))}function he(e,t,n){var r=arguments.length;if(r<2)throw new H.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];return n=i.pop(),[e,j(i),n]}function pe(e,t,n){this.name=e,this.schema=t,this._tx=n,this.hook=U[e]?U[e].hook:pt(null,{creating:[ne,X],reading:[ee,Z],updating:[ie,X],deleting:[re,X]})}function ve(e,t,n){return(n?It:Nt)((function(n){e.push(n),t&&t()}))}function be(e,t,n,r,i){return new Pe((function(o,a){var u=n.length,c=u-1;if(0===u)return o();if(r){var s,f=It(a),l=Tt(null);O((function(){for(var r=0;r<u;++r){s={onsuccess:null,onerror:null};var a=n[r];i.call(s,a[0],a[1],t);var h=e.delete(a[0]);h._hookCtx=s,h.onerror=f,h.onsuccess=r===c?Tt(o):l}}),(function(e){throw s.onerror&&s.onerror(e),e}))}else for(var h=0;h<u;++h){var p=e.delete(n[h]);p.onerror=Nt(a),h===c&&(p.onsuccess=Ge((function(){return o()})))}}))}function me(e,t,n,r){var i=this;this.db=Q,this.mode=e,this.storeNames=t,this.idbtrans=null,this.on=pt(this,"complete","error","abort"),this.parent=r||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Pe((function(e,t){i._resolve=e,i._reject=t})),this._completion.then((function(){i.active=!1,i.on.complete.fire()}),(function(e){var t=i.active;return i.active=!1,i.on.error.fire(e),i.parent?i.parent._reject(e):t&&i.idbtrans&&i.idbtrans.abort(),ht(e)}))}function ge(e,t,n){this._ctx={table:e,index:":id"===t?null:t,or:n}}function we(e,t){var n=null,r=null;if(t)try{n=t()}catch(e){r=e}var i=e._ctx,o=i.table;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:o.hook.reading.fire}}function _e(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Oe(e,t){return e._cfg.version-t._cfg.version}function Se(e,t,n){t.forEach((function(t){var r=n[t];e.forEach((function(e){t in e||(e===me.prototype||e instanceof me?h(e,t,{get:function(){return this.table(t)}}):e[t]=new pe(t,r))}))}))}function ke(e,t,n,r,i,o){var a=Ge(o?function(e,t,r){return n(o(e),t,r)}:n,i);e.onerror||(e.onerror=Nt(i)),e.onsuccess=function(e,t){return function(){try{e.apply(this,arguments)}catch(e){t(e)}}}(t?function(){var n=e.result;if(n){var o=function(){n.continue()};t(n,(function(e){o=e}),r,i)&&a(n.value,n,(function(e){o=e})),o()}else r()}:function(){var t=e.result;if(t){var n=function(){t.continue()};a(t.value,t,(function(e){n=e})),n()}else r()},i)}function Ee(e,t){return A.cmp(e,t)}function Ae(e,t){return Ee(e,t)>0?e:t}function xe(e,t){return A.cmp(e,t)}function Te(e,t){return A.cmp(t,e)}function Ne(e,t){return e<t?-1:e===t?0:1}function Ie(e,t){return e>t?-1:e===t?0:1}function Be(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}function Ce(e,t){for(var n=t.db.objectStoreNames,r=0;r<n.length;++r){var i=n[r],a=t.objectStore(i);l="getAll"in a;for(var u=0;u<a.indexNames.length;++u){var c=a.indexNames[u],s=a.index(c).keyPath,f="string"==typeof s?s:"["+b(s).join("+")+"]";if(e[i]){var h=e[i].idxByName[f];h&&(h.name=c)}}}/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(l=!1)}function De(e){Q.on("blocked").fire(e),_t.filter((function(e){return e.name===Q.name&&e!==Q&&!e._vcFired})).map((function(t){return t.on("versionchange").fire(e)}))}this.version=function(e){if(F||q)throw new H.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=I.filter((function(t){return t._cfg.version===e}))[0];return t||(t=new ce(e),I.push(t),I.sort(Oe),oe=!1,t)},a(ce.prototype,{stores:function(e){this._cfg.storesSource=this._cfg.storesSource?a(this._cfg.storesSource,e):e;var t={};I.forEach((function(e){a(t,e._cfg.storesSource)}));var n=this._cfg.dbschema={};return this._parseStoresSpec(t,n),P=Q._dbSchema=n,[U,Q,me.prototype].forEach((function(e){for(var t in e)e[t]instanceof pe&&delete e[t]})),Se([U,Q,me.prototype,this._cfg.tables],r(n),n),R=r(n),this},upgrade:function(e){return this._cfg.contentUpgrade=e,this},_parseStoresSpec:function(e,t){r(e).forEach((function(n){if(null!==e[n]){var r={},o=function(e){var t=[];return e.split(",").forEach((function(e){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;t.push(new Dt(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),i(r),/\./.test(e)))})),t}(e[n]),a=o.shift();if(a.multi)throw new H.Schema("Primary key cannot be multi-valued");a.keyPath&&k(r,a.keyPath,a.auto?0:a.keyPath),o.forEach((function(e){if(e.auto)throw new H.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new H.Schema("Index must have a name and cannot be an empty string");k(r,e.keyPath,e.compound?e.keyPath.map((function(){return""})):"")})),t[n]=new Rt(n,a,o,r)}}))}}),this._allTables=U,this._createTransaction=function(e,t,n,r){return new me(e,t,n,r)},this._whenReady=function(e){return J||je.letThrough?e():new Pe((function(e,t){if(!q){if(!w)return void t(new H.DatabaseClosed);Q.open().catch(X)}W.then(e,t)})).then(e)},this.verno=0,this.open=function(){if(q||F)return W.then((function(){return M?ht(M):Q}));D&&(te._stackHolder=L()),q=!0,M=null,J=!1;var t=u,n=null;return Pe.race([te,new Pe((function(t,i){if(!A)throw new H.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var o=oe?A.open(e):A.open(e,Math.round(10*Q.verno));if(!o)throw new H.MissingAPI("IndexedDB API not available");o.onerror=Nt(i),o.onblocked=Ge(De),o.onupgradeneeded=Ge((function(t){if(n=o.transaction,oe&&!Q._allowEmptyDB){o.onerror=Bt,n.abort(),o.result.close();var a=A.deleteDatabase(e);a.onsuccess=a.onerror=Ge((function(){i(new H.NoSuchDatabase("Database "+e+" doesnt exist"))}))}else n.onerror=Nt(i),function(e,t,n){var i=Q._createTransaction(z,R,P);i.create(t),i._completion.catch(n);var o=i._reject.bind(i);Ze((function(){je.trans=i,0===e?(r(P).forEach((function(e){se(t,e,P[e].primKey,P[e].indexes)})),Pe.follow((function(){return Q.on.populate.fire(i)})).catch(o)):function(e,t,n){var i=[],o=I.filter((function(t){return t._cfg.version===e}))[0];if(!o)throw new H.Upgrade("Dexie specification of currently installed DB version is missing");P=Q._dbSchema=o._cfg.dbschema;var a=!1;return I.filter((function(t){return t._cfg.version>e})).forEach((function(e){i.push((function(){var r=P,i=e._cfg.dbschema;Ce(r,n),Ce(i,n),P=Q._dbSchema=i;var o=function(e,t){var n={del:[],add:[],change:[]};for(var r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],o=t[r];if(i){var a={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src!==o.primKey.src)a.recreate=!0,n.change.push(a);else{var u=i.idxByName,c=o.idxByName;for(var s in u)c[s]||a.del.push(s);for(s in c){var f=u[s],l=c[s];f?f.src!==l.src&&a.change.push(l):a.add.push(l)}(a.del.length>0||a.add.length>0||a.change.length>0)&&n.change.push(a)}}else n.add.push([r,o])}return n}(r,i);if(o.add.forEach((function(e){se(n,e[0],e[1].primKey,e[1].indexes)})),o.change.forEach((function(e){if(e.recreate)throw new H.Upgrade("Not yet support for changing primary key");var t=n.objectStore(e.name);e.add.forEach((function(e){fe(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),fe(t,e)})),e.del.forEach((function(e){t.deleteIndex(e)}))})),e._cfg.contentUpgrade)return a=!0,Pe.follow((function(){e._cfg.contentUpgrade(t)}))})),i.push((function(t){a&&St||function(e,t){for(var n=0;n<t.db.objectStoreNames.length;++n){var r=t.db.objectStoreNames[n];null==e[r]&&t.db.deleteObjectStore(r)}}(e._cfg.dbschema,t)}))})),function e(){return i.length?Pe.resolve(i.shift()(t.idbtrans)).then(e):Pe.resolve()}().then((function(){!function(e,t){r(e).forEach((function(n){t.db.objectStoreNames.contains(n)||se(t,n,e[n].primKey,e[n].indexes)}))}(P,n)}))}(e,i,t).catch(o)}))}((t.oldVersion>Math.pow(2,62)?0:t.oldVersion)/10,n,i)}),i),o.onsuccess=Ge((function(){if(n=null,F=o.result,_t.push(Q),oe)!function(){if(Q.verno=F.version/10,Q._dbSchema=P={},0!==(R=b(F.objectStoreNames,0)).length){var e=F.transaction(Ut(R),"readonly");R.forEach((function(t){for(var n=e.objectStore(t),r=n.keyPath,i=r&&"string"==typeof r&&-1!==r.indexOf("."),o=new Dt(r,r||"",!1,!1,!!n.autoIncrement,r&&"string"!=typeof r,i),a=[],u=0;u<n.indexNames.length;++u){var c=n.index(n.indexNames[u]);i=(r=c.keyPath)&&"string"==typeof r&&-1!==r.indexOf(".");var s=new Dt(c.name,r,!!c.unique,!!c.multiEntry,!1,r&&"string"!=typeof r,i);a.push(s)}P[t]=new Rt(t,o,a,{})})),Se([U],r(P),P)}}();else if(F.objectStoreNames.length>0)try{Ce(P,F.transaction(Ut(F.objectStoreNames),Y))}catch(e){}F.onversionchange=Ge((function(e){Q._vcFired=!0,Q.on("versionchange").fire(e)})),ue||"__dbnames"===e||dt.dbnames.put({name:e}).catch(X),t()}),i)}))]).then((function(){return V=[],Pe.resolve(At.vip(Q.on.ready.fire)).then((function e(){if(V.length>0){var t=V.reduce(ae,X);return V=[],Pe.resolve(At.vip(t)).then(e)}}))})).finally((function(){V=null})).then((function(){return q=!1,Q})).catch((function(e){try{n&&n.abort()}catch(e){}return q=!1,Q.close(),ht(M=e)})).finally((function(){J=!0,t()}))},this.close=function(){var e=_t.indexOf(Q);if(e>=0&&_t.splice(e,1),F){try{F.close()}catch(e){}F=null}w=!1,M=new H.DatabaseClosed,q&&c(M),W=new Pe((function(e){u=e})),te=new Pe((function(e,t){c=t}))},this.delete=function(){var t=arguments.length>0;return new Pe((function(n,r){if(t)throw new H.InvalidArgument("Arguments not allowed in db.delete()");function i(){Q.close();var t=A.deleteDatabase(e);t.onsuccess=Ge((function(){ue||dt.dbnames.delete(e).catch(X),n()})),t.onerror=Nt(r),t.onblocked=De}q?W.then(i):i()}))},this.backendDB=function(){return F},this.isOpen=function(){return null!==F},this.hasBeenClosed=function(){return M&&M instanceof H.DatabaseClosed},this.hasFailed=function(){return null!==M},this.dynamicallyOpened=function(){return oe},this.name=e,f(this,{tables:{get:function(){return r(U).map((function(e){return U[e]}))}}}),this.on=pt(this,"populate","blocked","versionchange",{ready:[ae,X]}),this.on.ready.subscribe=m(this.on.ready.subscribe,(function(e){return function(t,n){At.vip((function(){J?(M||Pe.resolve().then(t),n&&e(t)):V?(V.push(t),n&&e(t)):(e(t),n||e((function e(){Q.on.ready.unsubscribe(t),Q.on.ready.unsubscribe(e)})))}))}})),this.transaction=function(){var e=he.apply(this,arguments);return this._transaction.apply(this,e)},this._transaction=function(e,t,n){var r=je.trans;r&&r.db===Q&&-1===e.indexOf("!")||(r=null);var i=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{var o=t.map((function(e){var t=e instanceof pe?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t}));if("r"==e||e==Y)e=Y;else{if("rw"!=e&&e!=z)throw new H.InvalidArgument("Invalid transaction mode: "+e);e=z}if(r){if(r.mode===Y&&e===z){if(!i)throw new H.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");r=null}r&&o.forEach((function(e){if(r&&-1===r.storeNames.indexOf(e)){if(!i)throw new H.SubTransaction("Table "+e+" not included in parent transaction.");r=null}})),i&&r&&!r.active&&(r=null)}}catch(e){return r?r._promise(null,(function(t,n){n(e)})):ht(e)}return r?r._promise(e,a,"lock"):je.trans?ut(je.transless,(function(){return Q._whenReady(a)})):Q._whenReady(a);function a(){return Pe.resolve().then((function(){var t,i=je.transless||je,a=Q._createTransaction(e,o,P,r),u={trans:a,transless:i};r?a.idbtrans=r.idbtrans:a.create(),n.constructor===ye&&et();var c=Pe.follow((function(){if(t=n.call(a,a))if(t.constructor===de){var e=tt.bind(null,null);t.then(e,e)}else"function"==typeof t.next&&"function"==typeof t.throw&&(t=Ct(t))}),u);return(t&&"function"==typeof t.then?Pe.resolve(t).then((function(e){return a.active?e:ht(new H.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):c.then((function(){return t}))).then((function(e){return r&&a._resolve(),a._completion.then((function(){return e}))})).catch((function(e){return a._reject(e),ht(e)}))}))}},this.table=function(e){if(!s(U,e))throw new H.InvalidTable("Table "+e+" does not exist");return U[e]},f(pe.prototype,{_trans:function(e,t,n){var r=this._tx||je.trans;return r&&r.db===Q?r===je.trans?r._promise(e,t,n):Ze((function(){return r._promise(e,t,n)}),{trans:r,transless:je.transless||je}):le(e,[this.name],t)},_idbstore:function(e,t,n){var r=this.name;return this._trans(e,(function(e,n,i){if(-1===i.storeNames.indexOf(r))throw new H.NotFound("Table"+r+" not part of transaction");return t(e,n,i.idbtrans.objectStore(r),i)}),n)},get:function(e,t){if(e&&e.constructor===Object)return this.where(e).first(t);var n=this;return this._idbstore(Y,(function(t,r,i){var o=i.get(e);o.onerror=Nt(r),o.onsuccess=Ge((function(){t(n.hook.reading.fire(o.result))}),r)})).then(t)},where:function(e){if("string"==typeof e)return new ge(this,e);if(i(e))return new ge(this,"["+e.join("+")+"]");var t=r(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){return e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))&&e.keyPath.every((function(e){return t.indexOf(e)>=0}))}))[0];if(n&&bt!==vt)return this.where(n.name).equals(n.keyPath.map((function(t){return e[t]})));n||console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var o=this.schema.idxByName,a=t.reduce((function(t,n){return[t[0]||o[n],t[0]||!o[n]?Be(t[1],(function(t){return""+S(t,n)==""+e[n]})):t[1]]}),[null,null]),u=a[0];return u?this.where(u.name).equals(e[u.keyPath]).filter(a[1]):n?this.filter(a[1]):this.where(t).equals("")},count:function(e){return this.toCollection().count(e)},offset:function(e){return this.toCollection().offset(e)},limit:function(e){return this.toCollection().limit(e)},reverse:function(){return this.toCollection().reverse()},filter:function(e){return this.toCollection().and(e)},each:function(e){return this.toCollection().each(e)},toArray:function(e){return this.toCollection().toArray(e)},orderBy:function(e){return new we(new ge(this,i(e)?"["+e.join("+")+"]":e))},toCollection:function(){return new we(new ge(this))},mapToClass:function(e,t){this.schema.mappedClass=e;var n=Object.create(e.prototype);t&&xt(n,t),this.schema.instanceTemplate=n;var r=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(s(t,r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),e},defineClass:function(e){return this.mapToClass(At.defineClass(e),e)},bulkDelete:function(e){return this.hook.deleting.fire===X?this._idbstore(z,(function(t,n,r,i){t(be(r,i,e,!1,X))})):this.where(":id").anyOf(e).delete().then((function(){}))},bulkPut:function(e,t){var n=this;return this._idbstore(z,(function(r,i,o){if(!o.keyPath&&!n.schema.primKey.auto&&!t)throw new H.InvalidArgument("bulkPut() with non-inbound keys requires keys array in second argument");if(o.keyPath&&t)throw new H.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new H.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return r();var a,u,c=function(e){0===s.length?r(e):i(new G(n.name+".bulkPut(): "+s.length+" of "+f+" operations failed",s))},s=[],f=e.length,l=n;if(n.hook.creating.fire===X&&n.hook.updating.fire===X){u=ve(s);for(var h=0,p=e.length;h<p;++h)(a=t?o.put(e[h],t[h]):o.put(e[h])).onerror=u;a.onerror=ve(s,c),a.onsuccess=Pt(c)}else{var d=t||o.keyPath&&e.map((function(e){return S(e,o.keyPath)})),y=d&&_(d,(function(t,n){return null!=t&&[t,e[n]]})),v=d?l.where(":id").anyOf(d.filter((function(e){return null!=e}))).modify((function(){this.value=y[this.primKey],y[this.primKey]=null})).catch($,(function(e){s=e.failures})).then((function(){for(var n=[],r=t&&[],i=d.length-1;i>=0;--i){var o=d[i];(null==o||y[o])&&(n.push(e[i]),t&&r.push(o),null!=o&&(y[o]=null))}return n.reverse(),t&&r.reverse(),l.bulkAdd(n,r)})).then((function(e){var t=d[d.length-1];return null!=t?t:e})):l.bulkAdd(e);v.then(c).catch(G,(function(e){s=s.concat(e.failures),c()})).catch(i)}}),"locked")},bulkAdd:function(e,t){var n=this,r=this.hook.creating.fire;return this._idbstore(z,(function(i,o,a,u){if(!a.keyPath&&!n.schema.primKey.auto&&!t)throw new H.InvalidArgument("bulkAdd() with non-inbound keys requires keys array in second argument");if(a.keyPath&&t)throw new H.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new H.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return i();function c(e){0===h.length?i(e):o(new G(n.name+".bulkAdd(): "+h.length+" of "+p+" operations failed",h))}var s,f,l,h=[],p=e.length;if(r!==X){var d,y=a.keyPath;f=ve(h,null,!0),l=Tt(null),O((function(){for(var n=0,i=e.length;n<i;++n){d={onerror:null,onsuccess:null};var o=t&&t[n],c=e[n],h=t?o:y?S(c,y):void 0,p=r.call(d,h,c,u);null==h&&null!=p&&(y?k(c=T(c),y,p):o=p),(s=null!=o?a.add(c,o):a.add(c))._hookCtx=d,n<i-1&&(s.onerror=f,d.onsuccess&&(s.onsuccess=l))}}),(function(e){throw d.onerror&&d.onerror(e),e})),s.onerror=ve(h,c,!0),s.onsuccess=Tt(c)}else{f=ve(h);for(var v=0,b=e.length;v<b;++v)(s=t?a.add(e[v],t[v]):a.add(e[v])).onerror=f;s.onerror=ve(h,c),s.onsuccess=Pt(c)}}))},add:function(e,t){var n=this.hook.creating.fire;return this._idbstore(z,(function(r,i,o,a){var u={onsuccess:null,onerror:null};if(n!==X){var c=null!=t?t:o.keyPath?S(e,o.keyPath):void 0,s=n.call(u,c,e,a);null==c&&null!=s&&(o.keyPath?k(e,o.keyPath,s):t=s)}try{var f=null!=t?o.add(e,t):o.add(e);f._hookCtx=u,f.onerror=It(i),f.onsuccess=Tt((function(t){var n=o.keyPath;n&&k(e,n,t),r(t)}))}catch(e){throw u.onerror&&u.onerror(e),e}}))},put:function(e,t){var n=this,r=this.hook.creating.fire,i=this.hook.updating.fire;if(r!==X||i!==X){var o=this.schema.primKey.keyPath,a=void 0!==t?t:o&&S(e,o);return null==a?this.add(e):(e=T(e),this._trans(z,(function(){return n.where(":id").equals(a).modify((function(){this.value=e})).then((function(r){return 0===r?n.add(e,t):a}))}),"locked"))}return this._idbstore(z,(function(n,r,i){var o=void 0!==t?i.put(e,t):i.put(e);o.onerror=Nt(r),o.onsuccess=Ge((function(t){var r=i.keyPath;r&&k(e,r,t.target.result),n(o.result)}))}))},delete:function(e){return this.hook.deleting.subscribers.length?this.where(":id").equals(e).delete():this._idbstore(z,(function(t,n,r){var i=r.delete(e);i.onerror=Nt(n),i.onsuccess=Ge((function(){t(i.result)}))}))},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection().delete():this._idbstore(z,(function(e,t,n){var r=n.clear();r.onerror=Nt(t),r.onsuccess=Ge((function(){e(r.result)}))}))},update:function(e,t){if("object"!==n(t)||i(t))throw new H.InvalidArgument("Modifications must be an object.");if("object"!==n(e)||i(e))return this.where(":id").equals(e).modify(t);r(t).forEach((function(n){k(e,n,t[n])}));var o=S(e,this.schema.primKey.keyPath);return void 0===o?ht(new H.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(o).modify(t)}}),f(me.prototype,{_lock:function(){return g(!je.global),++this._reculock,1!==this._reculock||je.global||(je.lockOwnerFor=this),this},_unlock:function(){if(g(!je.global),0==--this._reculock)for(je.global||(je.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{ut(e[1],e[0])}catch(e){}}return this},_locked:function(){return this._reculock&&je.lockOwnerFor!==this},create:function(e){var t=this;if(!this.mode)return this;if(g(!this.idbtrans),!e&&!F)switch(M&&M.name){case"DatabaseClosedError":throw new H.DatabaseClosed(M);case"MissingAPIError":throw new H.MissingAPI(M.message,M);default:throw new H.OpenFailed(M)}if(!this.active)throw new H.TransactionInactive;return g(null===this._completion._state),(e=this.idbtrans=e||F.transaction(Ut(this.storeNames),this.mode)).onerror=Ge((function(n){Bt(n),t._reject(e.error)})),e.onabort=Ge((function(n){Bt(n),t.active&&t._reject(new H.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=Ge((function(){t.active=!1,t._resolve()})),this},_promise:function(e,t,n){var r=this;if(e===z&&this.mode!==z)return ht(new H.ReadOnly("Transaction is readonly"));if(!this.active)return ht(new H.TransactionInactive);if(this._locked())return new Pe((function(i,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,o)},je])}));if(n)return Ze((function(){var e=new Pe((function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var i=new Pe((function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return i._lib=!0,i},_root:function(){return this.parent?this.parent._root():this},waitFor:function(e){var t=this._root();if(e=Pe.resolve(e),t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return e}));else{t._waitingFor=e,t._waitingQueue=[];var n=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(n.get(-1/0).onsuccess=e)}()}var r=t._waitingFor;return new Pe((function(n,i){e.then((function(e){return t._waitingQueue.push(Ge(n.bind(null,e)))}),(function(e){return t._waitingQueue.push(Ge(i.bind(null,e)))})).finally((function(){t._waitingFor===r&&(t._waitingFor=null)}))}))},abort:function(){this.active&&this._reject(new H.Abort),this.active=!1},tables:{get:("Transaction.tables",p=function(){return U},function(){return console.warn("Transaction.tables is deprecated. See https://github.com/dfahlander/Dexie.js/wiki/Deprecations. "+K(L(),1)),p.apply(this,arguments)})},table:function(e){return new pe(e,Q.table(e).schema,this)}}),f(ge.prototype,(function(){function e(e,t,n){var r=e instanceof ge?new we(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function t(e){return new we(e,(function(){return x.only("")})).limit(0)}function n(e,t,n,r,i,o){for(var a=Math.min(e.length,r.length),u=-1,c=0;c<a;++c){var s=t[c];if(s!==r[c])return i(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):i(e[c],r[c])<0?e.substr(0,c)+r[c]+n.substr(c+1):u>=0?e.substr(0,u)+t[u]+n.substr(u+1):null;i(e[c],s)<0&&(u=c)}return a<r.length&&"next"===o?e+n.substr(e.length):a<e.length&&"prev"===o?e.substr(0,n.length):u<0?null:e.substr(0,u)+r[u]+n.substr(u+1)}function r(t,r,i,o){var a,u,c,s,f,l,h,p=i.length;if(!i.every((function(e){return"string"==typeof e})))return e(t,wt);function d(e){a=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),u=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),c="next"===e?Ne:Ie;var t=i.map((function(e){return{lower:u(e),upper:a(e)}})).sort((function(e,t){return c(e.lower,t.lower)}));s=t.map((function(e){return e.upper})),f=t.map((function(e){return e.lower})),l=e,h="next"===e?"":o}d("next");var y=new we(t,(function(){return x.bound(s[0],f[p-1]+o)}));y._ondirectionchange=function(e){d(e)};var v=0;return y._addAlgorithm((function(e,t,i){var o=e.key;if("string"!=typeof o)return!1;var a=u(o);if(r(a,f,v))return!0;for(var d=null,y=v;y<p;++y){var b=n(o,a,s[y],f[y],c,l);null===b&&null===d?v=y+1:(null===d||c(d,b)>0)&&(d=b)}return t(null!==d?function(){e.continue(d+h)}:i),!1})),y}return{between:function(n,r,i,o){i=!1!==i,o=!0===o;try{return Ee(n,r)>0||0===Ee(n,r)&&(i||o)&&(!i||!o)?t(this):new we(this,(function(){return x.bound(n,r,!i,!o)}))}catch(t){return e(this,gt)}},equals:function(e){return new we(this,(function(){return x.only(e)}))},above:function(e){return new we(this,(function(){return x.lowerBound(e,!0)}))},aboveOrEqual:function(e){return new we(this,(function(){return x.lowerBound(e)}))},below:function(e){return new we(this,(function(){return x.upperBound(e,!0)}))},belowOrEqual:function(e){return new we(this,(function(){return x.upperBound(e)}))},startsWith:function(t){return"string"!=typeof t?e(this,wt):this.between(t,t+vt,!0,!0)},startsWithIgnoreCase:function(e){return""===e?this.startsWith(e):r(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],vt)},equalsIgnoreCase:function(e){return r(this,(function(e,t){return e===t[0]}),[e],"")},anyOfIgnoreCase:function(){var e=C.apply(B,arguments);return 0===e.length?t(this):r(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},startsWithAnyOfIgnoreCase:function(){var e=C.apply(B,arguments);return 0===e.length?t(this):r(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,vt)},anyOf:function(){var n=C.apply(B,arguments),r=xe;try{n.sort(r)}catch(t){return e(this,gt)}if(0===n.length)return t(this);var i=new we(this,(function(){return x.bound(n[0],n[n.length-1])}));i._ondirectionchange=function(e){r="next"===e?xe:Te,n.sort(r)};var o=0;return i._addAlgorithm((function(e,t,i){for(var a=e.key;r(a,n[o])>0;)if(++o===n.length)return t(i),!1;return 0===r(a,n[o])||(t((function(){e.continue(n[o])})),!1)})),i},notEqual:function(e){return this.inAnyRange([[mt,e],[e,bt]],{includeLowers:!1,includeUppers:!1})},noneOf:function(){var t=C.apply(B,arguments);if(0===t.length)return new we(this);try{t.sort(xe)}catch(t){return e(this,gt)}var n=t.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[mt,t]]}),null);return n.push([t[t.length-1],bt]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},inAnyRange:function(n,r){if(0===n.length)return t(this);if(!n.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&xe(e[0],e[1])<=0})))return e(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",H.InvalidArgument);var i,o=!r||!1!==r.includeLowers,a=r&&!0===r.includeUppers,u=xe;function c(e,t){return u(e[0],t[0])}try{i=n.reduce((function(e,t){for(var n=0,r=e.length;n<r;++n){var i=e[n];if(Ee(t[0],i[1])<0&&Ee(t[1],i[0])>0){i[0]=Ee(o=i[0],a=t[0])<0?o:a,i[1]=Ae(i[1],t[1]);break}}var o,a;return n===r&&e.push(t),e}),[]),i.sort(c)}catch(t){return e(this,gt)}var s=0,f=a?function(e){return xe(e,i[s][1])>0}:function(e){return xe(e,i[s][1])>=0},l=o?function(e){return Te(e,i[s][0])>0}:function(e){return Te(e,i[s][0])>=0},h=f,p=new we(this,(function(){return x.bound(i[0][0],i[i.length-1][1],!o,!a)}));return p._ondirectionchange=function(e){"next"===e?(h=f,u=xe):(h=l,u=Te),i.sort(c)},p._addAlgorithm((function(e,t,n){for(var r=e.key;h(r);)if(++s===i.length)return t(n),!1;return!!function(e){return!f(e)&&!l(e)}(r)||(0===Ee(r,i[s][1])||0===Ee(r,i[s][0])||t((function(){u===xe?e.continue(i[s][0]):e.continue(i[s][1])})),!1)})),p},startsWithAnyOf:function(){var n=C.apply(B,arguments);return n.every((function(e){return"string"==typeof e}))?0===n.length?t(this):this.inAnyRange(n.map((function(e){return[e,e+vt]}))):e(this,"startsWithAnyOf() only works with strings")}}})),f(we.prototype,(function(){function e(e,t){e.filter=Be(e.filter,t)}function t(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Be(r(),t())}:t,e.justLimit=n&&!r}function n(e,t){if(e.isPrimKey)return t;var n=e.table.schema.idxByName[e.index];if(!n)throw new H.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return t.index(n.name)}function i(e,t){var r=n(e,t);return e.keysOnly&&"openKeyCursor"in r?r.openKeyCursor(e.range||null,e.dir+e.unique):r.openCursor(e.range||null,e.dir+e.unique)}function o(e,t,n,r,o){var a=e.replayFilter?Be(e.filter,e.replayFilter()):e.filter;e.or?function(){var u={},c=0;function f(){2==++c&&n()}function l(e,n,i){if(!a||a(n,i,f,r)){var o=n.primaryKey,c=""+o;"[object ArrayBuffer]"===c&&(c=""+new Uint8Array(o)),s(u,c)||(u[c]=!0,t(e,n,i))}}e.or._iterate(l,f,r,o),ke(i(e,o),e.algorithm,l,f,r,!e.keysOnly&&e.valueMapper)}():ke(i(e,o),Be(e.algorithm,a),t,n,r,!e.keysOnly&&e.valueMapper)}return{_read:function(e,t){var n=this._ctx;return n.error?n.table._trans(null,ht.bind(null,n.error)):n.table._idbstore(Y,e).then(t)},_write:function(e){var t=this._ctx;return t.error?t.table._trans(null,ht.bind(null,t.error)):t.table._idbstore(z,e,"locked")},_addAlgorithm:function(e){var t=this._ctx;t.algorithm=Be(t.algorithm,e)},_iterate:function(e,t,n,r){return o(this._ctx,e,t,n,r)},clone:function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&a(n,e),t._ctx=n,t},raw:function(){return this._ctx.valueMapper=null,this},each:function(e){var t=this._ctx;return this._read((function(n,r,i){o(t,e,n,r,i)}))},count:function(e){var t=this._ctx;if(_e(t,!0))return this._read((function(e,r,i){var o=n(t,i),a=t.range?o.count(t.range):o.count();a.onerror=Nt(r),a.onsuccess=function(n){e(Math.min(n.target.result,t.limit))}}),e);var r=0;return this._read((function(e,n,i){o(t,(function(){return++r,!1}),(function(){e(r)}),n,i)}),e)},sortBy:function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function u(e,t){var n=o(e,i),r=o(t,i);return n<r?-a:n>r?a:0}return this.toArray((function(e){return e.sort(u)})).then(t)},toArray:function(e){var t=this._ctx;return this._read((function(e,r,i){if(l&&"next"===t.dir&&_e(t,!0)&&t.limit>0){var a=t.table.hook.reading.fire,u=n(t,i),c=t.limit<1/0?u.getAll(t.range,t.limit):u.getAll(t.range);c.onerror=Nt(r),c.onsuccess=Pt(a===Z?e:function(t){try{e(t.map(a))}catch(e){r(e)}})}else{var s=[];o(t,(function(e){s.push(e)}),(function(){e(s)}),r,i)}}),e)},offset:function(e){var n=this._ctx;return e<=0||(n.offset+=e,_e(n)?t(n,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):t(n,(function(){var t=e;return function(){return--t<0}}))),this},limit:function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),t(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},until:function(t,n){return e(this._ctx,(function(e,r,i){return!t(e.value)||(r(i),n)})),this},first:function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},last:function(e){return this.reverse().first(e)},filter:function(t){return e(this._ctx,(function(e){return t(e.value)})),function(e,t){e.isMatch=Be(e.isMatch,t)}(this._ctx,t),this},and:function(e){return this.filter(e)},or:function(e){return new ge(this._ctx.table,e,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},eachUniqueKey:function(e){return this._ctx.unique="unique",this.eachKey(e)},eachPrimaryKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},keys:function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},primaryKeys:function(e){var t=this._ctx;if(l&&"next"===t.dir&&_e(t,!0)&&t.limit>0)return this._read((function(e,r,i){var o=n(t,i),a=t.limit<1/0?o.getAllKeys(t.range,t.limit):o.getAllKeys(t.range);a.onerror=Nt(r),a.onsuccess=Pt(e)})).then(e);t.keysOnly=!t.isMatch;var r=[];return this.each((function(e,t){r.push(t.primaryKey)})).then((function(){return r})).then(e)},uniqueKeys:function(e){return this._ctx.unique="unique",this.keys(e)},firstKey:function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},lastKey:function(e){return this.reverse().firstKey(e)},distinct:function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return e(this._ctx,(function(e){var t=e.primaryKey.toString(),n=s(r,t);return r[t]=!0,!n})),this},modify:function(e){var t=this,n=this._ctx.table.hook,i=n.updating.fire,o=n.deleting.fire;return this._write((function(n,u,c,f){var l;if("function"==typeof e)l=i===X&&o===X?e:function(t){var n=T(t);if(!1===e.call(this,t,this))return!1;if(s(this,"value")){var a=N(n,this.value),u=i.call(this,a,this.primKey,n,f);u&&(t=this.value,r(u).forEach((function(e){k(t,e,u[e])})))}else o.call(this,this.primKey,t,f)};else if(i===X){var h=r(e),p=h.length;l=function(t){for(var n=!1,r=0;r<p;++r){var i=h[r],o=e[i];S(t,i)!==o&&(k(t,i,o),n=!0)}return n}}else{var d=e;e=E(d),l=function(t){var n=!1,o=i.call(this,e,this.primKey,T(t),f);return o&&a(e,o),r(e).forEach((function(r){var i=e[r];S(t,r)!==i&&(k(t,r,i),n=!0)})),o&&(e=E(d)),n}}var y=0,v=0,b=!1,m=[],g=[],w=null;function _(e){return e&&(m.push(e),g.push(w)),u(new $("Error modifying one or more objects",m,v,g))}function A(){b&&v+m.length===y&&(m.length>0?_():n(v))}t.clone().raw()._iterate((function(e,t){w=t.primaryKey;var n={primKey:t.primaryKey,value:e,onsuccess:null,onerror:null};function r(e){return m.push(e),g.push(n.primKey),A(),!0}if(!1!==l.call(n,e,n)){var i=!s(n,"value");++y,O((function(){var e=i?t.delete():t.update(n.value);e._hookCtx=n,e.onerror=It(r),e.onsuccess=Tt((function(){++v,A()}))}),r)}else n.onsuccess&&n.onsuccess(n.value)}),(function(){b=!0,A()}),_,c)}))},delete:function(){var e=this,t=this._ctx,n=t.range,r=t.table.hook.deleting.fire,i=r!==X;if(!i&&_e(t)&&(t.isPrimKey&&!kt||!n))return this._write((function(e,t,r){var i=Nt(t),o=n?r.count(n):r.count();o.onerror=i,o.onsuccess=function(){var a=o.result;O((function(){var t=n?r.delete(n):r.clear();t.onerror=i,t.onsuccess=function(){return e(a)}}),(function(e){return t(e)}))}}));var o=i?2e3:1e4;return this._write((function(n,a,u,c){var s=0,f=e.clone({keysOnly:!t.isMatch&&!i}).distinct().limit(o).raw(),l=[];n(function e(){return f.each(i?function(e,t){l.push([t.primaryKey,t.value])}:function(e,t){l.push(t.primaryKey)}).then((function(){return i?l.sort((function(e,t){return xe(e[0],t[0])})):l.sort(xe),be(u,c,l,i,r)})).then((function(){var t=l.length;return s+=t,l=[],t<o?s:e()}))}())}))}}})),a(this,{Collection:we,Table:pe,Transaction:me,Version:ce,WhereClause:ge}),Q.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+Q.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+Q.name+"'. Closing db now to resume the delete request."),Q.close()})),Q.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+Q.name+"') was blocked"):console.warn("Upgrade '"+Q.name+"' blocked by other connection holding version "+e.oldVersion/10)})),v.forEach((function(e){e(Q)}))}function jt(e){if("function"==typeof e)return new e;if(i(e))return[jt(e[0])];if(e&&"object"===n(e)){var t={};return xt(t,e),t}return e}function xt(e,t){return r(t).forEach((function(n){var r=jt(t[n]);e[n]=r})),e}function Tt(e){return Ge((function(t){var n=t.target,r=n._hookCtx,i=r.value||n.result,o=r&&r.onsuccess;o&&o(i),e&&e(i)}),e)}function Nt(e){return Ge((function(t){return Bt(t),e(t.target.error),!1}))}function Pt(e){return Ge((function(t){e(t.target.result)}))}function It(e){return Ge((function(t){var n=t.target,r=n.error,i=n._hookCtx,o=i&&i.onerror;return o&&o(r),Bt(t),e(r),!1}))}function Bt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}function Ct(e){var t=function(t){return e.next(t)},n=o(t),r=o((function(t){return e.throw(t)}));function o(e){return function(t){var o=e(t),a=o.value;return o.done?a:a&&"function"==typeof a.then?a.then(n,r):i(a)?Pe.all(a).then(n,r):n(a)}}return o(t)()}function Dt(e,t,n,r,i,o,a){this.name=e,this.keyPath=t,this.unique=n,this.multi=r,this.auto=i,this.compound=o,this.dotted=a;var u="string"==typeof t?t:t&&"["+[].join.call(t,"+")+"]";this.src=(n?"&":"")+(r?"*":"")+(i?"++":"")+u}function Rt(e,t,n,r){this.name=e,this.primKey=t||new Dt,this.indexes=n||[new Dt],this.instanceTemplate=r,this.mappedClass=null,this.idxByName=_(n,(function(e){return[e.name,e]}))}function Ut(e){return 1===e.length?e[0]:e}function Ft(e){var t=e&&(e.getDatabaseNames||e.webkitGetDatabaseNames);return t&&t.bind(e)}R(D,Et),f(At,W),f(At,{delete:function(e){var t=new At(e),n=t.delete();return n.onblocked=function(e){return t.on("blocked",e),this},n},exists:function(e){return new At(e).open().then((function(e){return e.close(),!0})).catch(At.NoSuchDatabaseError,(function(){return!1}))},getDatabaseNames:function(e){var t=Ft(At.dependencies.indexedDB);return t?new Pe((function(e,n){var r=t();r.onsuccess=function(t){e(b(t.target.result,0))},r.onerror=Nt(n)})).then(e):dt.dbnames.toCollection().primaryKeys(e)},defineClass:function(){return function(e){e&&a(this,e)}},applyStructure:xt,ignoreTransaction:function(e){return je.trans?ut(je.transless,e):e()},vip:function(e){return Ze((function(){return je.letThrough=!0,e()}))},async:function(e){return function(){try{var t=Ct(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Pe.resolve(t)}catch(e){return ht(e)}}},spawn:function(e,t,n){try{var r=Ct(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Pe.resolve(r)}catch(e){return ht(e)}},currentTransaction:{get:function(){return je.trans||null}},waitFor:function(e,t){var n=Pe.resolve("function"==typeof e?At.ignoreTransaction(e):e).timeout(t||6e4);return je.trans?je.trans.waitFor(n):n},Promise:Pe,debug:{get:function(){return D},set:function(e){R(e,"dexie"===e?function(){return!0}:Et)}},derive:p,extend:a,props:f,override:m,Events:pt,getByKeyPath:S,setByKeyPath:k,delByKeyPath:function(e,t){"string"==typeof t?k(e,t,void 0):"length"in t&&[].map.call(t,(function(t){k(e,t,void 0)}))},shallowClone:E,deepClone:T,getObjectDiff:N,asap:w,maxKey:bt,minKey:mt,addons:[],connections:_t,MultiModifyError:H.Modify,errnames:Y,IndexSpec:Dt,TableSchema:Rt,dependencies:function(){try{return{indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch(e){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:yt,version:yt.split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)})),default:At,Dexie:At}),Pe.rejectionMapper=function(e,t){if(!e||e instanceof J||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Q[e.name])return e;var n=new Q[e.name](t||e.message,e);return"stack"in e&&h(n,"stack",{get:function(){return this.inner.stack}}),n},(dt=new At("__dbnames")).version(1).stores({dbnames:"name"}),function(){var e="Dexie.DatabaseNames";try{void 0!==("undefined"==typeof localStorage?"undefined":n(localStorage))&&void 0!==o.document&&(JSON.parse(localStorage.getItem(e)||"[]").forEach((function(e){return dt.dbnames.put({name:e}).catch(X)})),localStorage.removeItem(e))}catch(e){}}();const Lt=At;function Kt(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(e){o(e)}}function u(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}c((r=r.apply(e,t||[])).next())}))}function Mt(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}function qt(e){return[e.schema.primKey].concat(e.schema.indexes).map((function(e){return e.src})).join(",")}function Vt(e,t){return new Promise((function(n,r){var i=new FileReader;i.onabort=function(e){return r(new Error("file read aborted"))},i.onerror=function(e){return r(e.target.error)},i.onload=function(e){return n(e.target.result)},"binary"===t?i.readAsArrayBuffer(e):i.readAsText(e)}))}function Jt(e,t){if("undefined"==typeof FileReaderSync)throw new Error("FileReaderSync missing. Reading blobs synchronously requires code to run from within a web worker. Use TSON.encapsulateAsync() to do it from the main thread.");var n=new FileReaderSync;return"binary"===t?n.readAsArrayBuffer(e):n.readAsText(e)}var $t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Gt(e,t){return e(t={exports:{}},t.exports),t.exports}for(var Yt=Gt((function(e,t){e.exports=function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t,n,r,i,o,a){try{var u=e[o](a),c=u.value}catch(e){return void n(e)}u.done?t(c):Promise.resolve(c).then(r,i)}function n(e){return function(){var n=this,r=arguments;return new Promise((function(i,o){var a=e.apply(n,r);function u(e){t(a,i,o,u,c,"next",e)}function c(e){t(a,i,o,u,c,"throw",e)}u(void 0)}))}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var f=function e(t){r(this,e),this.p=new Promise(t)};f.__typeson__type__="TypesonPromise","undefined"!=typeof Symbol&&(f.prototype[Symbol.toStringTag]="TypesonPromise"),f.prototype.then=function(e,t){var n=this;return new f((function(r,i){n.p.then((function(t){r(e?e(t):t)})).catch((function(e){return t?t(e):Promise.reject(e)})).then(r,i)}))},f.prototype.catch=function(e){return this.then(null,e)},f.resolve=function(e){return new f((function(t){t(e)}))},f.reject=function(e){return new f((function(t,n){n(e)}))},["all","race"].forEach((function(e){f[e]=function(t){return new f((function(n,r){Promise[e](t.map((function(e){return e&&e.constructor&&"TypesonPromise"===e.constructor.__typeson__type__?e.p:e}))).then(n,r)}))}}));var l={}.toString,h={}.hasOwnProperty,p=Object.getPrototypeOf,d=h.toString;function y(e,t){return g(e)&&"function"==typeof e.then&&(!t||"function"==typeof e.catch)}function v(e){return l.call(e).slice(8,-1)}function b(t,n){if(!t||"object"!==e(t))return!1;var r=p(t);if(!r)return null===n;var i=h.call(r,"constructor")&&r.constructor;return"function"!=typeof i?null===n:n===i||null!==n&&d.call(i)===d.call(n)||"function"==typeof n&&"string"==typeof i.__typeson__type__&&i.__typeson__type__===n.__typeson__type__}function m(e){return!(!e||"Object"!==v(e))&&(!p(e)||b(e,Object))}function g(t){return t&&"object"===e(t)}function w(e){return e.replace(/~/g,"~0").replace(/\./g,"~1")}function _(e){return e.replace(/~1/g,".").replace(/~0/g,"~")}function O(e,t){if(""===t)return e;var n=t.indexOf(".");if(n>-1){var r=e[_(t.slice(0,n))];return void 0===r?void 0:O(r,t.slice(n+1))}return e[_(t)]}function S(e,t,n){if(""===t)return n;var r=t.indexOf(".");return r>-1?S(e[_(t.slice(0,r))],t.slice(r+1),n):(e[_(t)]=n,e)}var k=Object.keys,E=Array.isArray,A={}.hasOwnProperty,j=["type","replaced","iterateIn","iterateUnsetNumeric"];function x(e,t){if(""===e.keypath)return-1;var n=e.keypath.match(/\./g)||0,r=t.keypath.match(/\./g)||0;return n&&(n=n.length),r&&(r=r.length),n>r?-1:n<r?1:e.keypath<t.keypath?-1:e.keypath>t.keypath}var T=function(){function t(e){r(this,t),this.options=e,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return o=t,a=[{key:"stringify",value:function(e,t,n,r){r=u({},this.options,{},r,{stringification:!0});var i=this.encapsulate(e,null,r);return E(i)?JSON.stringify(i[0],t,n):i.then((function(e){return JSON.stringify(e,t,n)}))}},{key:"stringifySync",value:function(e,t,n,r){return this.stringify(e,t,n,u({throwOnBadSyncType:!0},r,{sync:!0}))}},{key:"stringifyAsync",value:function(e,t,n,r){return this.stringify(e,t,n,u({throwOnBadSyncType:!0},r,{sync:!1}))}},{key:"parse",value:function(e,t,n){return n=u({},this.options,{},n,{parse:!0}),this.revive(JSON.parse(e,t),n)}},{key:"parseSync",value:function(e,t,n){return this.parse(e,t,u({throwOnBadSyncType:!0},n,{sync:!0}))}},{key:"parseAsync",value:function(e,t,n){return this.parse(e,t,u({throwOnBadSyncType:!0},n,{sync:!1}))}},{key:"specialTypeNames",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.returnTypeNames=!0,this.encapsulate(e,t,n)}},{key:"rootTypeName",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.iterateNone=!0,this.encapsulate(e,t,n)}},{key:"encapsulate",value:function(r,i,o){var a=(o=u({sync:!0},this.options,{},o)).sync,l=this,h={},p=[],d=[],y=[],v=!("cyclic"in o)||o.cyclic,_=o.encapsulateObserver,O=P("",r,v,i||{},y);function S(e){var n=Object.values(h);if(o.iterateNone)return n.length?n[0]:t.getJSONType(e);if(n.length){if(o.returnTypeNames)return s(new Set(n));e&&m(e)&&!A.call(e,"$types")?e.$types=h:e={$:e,$types:{$:h}}}else g(e)&&A.call(e,"$types")&&(e={$:e,$types:!0});return!o.returnTypeNames&&e}function x(e,t){return T.apply(this,arguments)}function T(){return T=n(regeneratorRuntime.mark((function e(t,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(r.map((function(e){return e[1].p})));case 2:return i=e.sent,e.next=5,Promise.all(i.map(function(){var e=n(regeneratorRuntime.mark((function e(n){var i,o,a,u,s,l,h,p,d,y,v,m,g,w;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=[],o=r.splice(0,1),a=c(o,1),u=a[0],s=c(u,7),l=s[0],h=s[2],p=s[3],d=s[4],y=s[5],v=s[6],m=P(l,n,h,p,i,!0,v),g=b(m,f),!l||!g){e.next=11;break}return e.next=8,m.p;case 8:return w=e.sent,d[y]=w,e.abrupt("return",x(t,i));case 11:return l?d[y]=m:t=g?m.p:m,e.abrupt("return",x(t,i));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),T.apply(this,arguments)}function N(e,t,n){Object.assign(e,t);var r=j.map((function(t){var n=e[t];return delete e[t],n}));n(),j.forEach((function(t,n){e[t]=r[n]}))}function P(n,r,i,a,u,c,s){var y,v={},g=e(r),O=_?function(e){var o=s||a.type||t.getJSONType(r);_(Object.assign(e||v,{keypath:n,value:r,cyclic:i,stateObj:a,promisesData:u,resolvingTypesonPromise:c,awaitingTypesonPromise:b(r,f)},{type:o}))}:null;if(["string","boolean","number","undefined"].includes(g))return void 0===r||"number"===g&&(isNaN(r)||r===-1/0||r===1/0)?(y=a.replaced?r:I(n,r,a,u,!1,c,O))!==r&&(v={replaced:y}):y=r,O&&O(),y;if(null===r)return O&&O(),r;if(i&&!a.iterateIn&&!a.iterateUnsetNumeric&&r&&"object"===e(r)){var S=p.indexOf(r);if(!(S<0))return h[n]="#",O&&O({cyclicKeypath:d[S]}),"#"+d[S];!0===i&&(p.push(r),d.push(n))}var j,x=m(r),T=E(r),B=(x||T)&&(!l.plainObjectReplacers.length||a.replaced)||a.iterateIn?r:I(n,r,a,u,x||T,null,O);if(B!==r?(y=B,v={replaced:B}):""===n&&b(r,f)?(u.push([n,r,i,a,void 0,void 0,a.type]),y=r):T&&"object"!==a.iterateIn||"array"===a.iterateIn?(j=new Array(r.length),v={clone:j}):(["function","symbol"].includes(e(r))||"toJSON"in r||b(r,f)||b(r,Promise)||b(r,ArrayBuffer))&&!x&&"object"!==a.iterateIn?y=r:(j={},a.addLength&&(j.length=r.length),v={clone:j}),O&&O(),o.iterateNone)return j||y;if(!j)return y;if(a.iterateIn){var C=function(e){var t={ownKeys:A.call(r,e)};N(a,t,(function(){var t=n+(n?".":"")+w(e),o=P(t,r[e],Boolean(i),a,u,c);b(o,f)?u.push([t,o,Boolean(i),a,j,e,a.type]):void 0!==o&&(j[e]=o)}))};for(var D in r)C(D);O&&O({endIterateIn:!0,end:!0})}else k(r).forEach((function(e){var t=n+(n?".":"")+w(e);N(a,{ownKeys:!0},(function(){var n=P(t,r[e],Boolean(i),a,u,c);b(n,f)?u.push([t,n,Boolean(i),a,j,e,a.type]):void 0!==n&&(j[e]=n)}))})),O&&O({endIterateOwn:!0,end:!0});if(a.iterateUnsetNumeric){for(var R=r.length,U=function(e){if(!(e in r)){var t=n+(n?".":"")+e;N(a,{ownKeys:!1},(function(){var n=P(t,void 0,Boolean(i),a,u,c);b(n,f)?u.push([t,n,Boolean(i),a,j,e,a.type]):void 0!==n&&(j[e]=n)}))}},F=0;F<R;F++)U(F);O&&O({endIterateUnsetNumeric:!0,end:!0})}return j}function I(e,t,n,r,i,o,u){for(var c=i?l.plainObjectReplacers:l.nonplainObjectReplacers,s=c.length;s--;){var f=c[s];if(f.test(t,n)){var p=f.type;if(l.revivers[p]){var d=h[e];h[e]=d?[p].concat(d):p}return Object.assign(n,{type:p,replaced:!0}),!a&&f.replaceAsync||f.replace?(u&&u({replacing:!0}),P(e,f[a||!f.replaceAsync?"replace":"replaceAsync"](t,n),v&&"readonly",n,r,o,p)):(u&&u({typeDetected:!0}),P(e,t,v&&"readonly",n,r,o,p))}}return t}return y.length?a&&o.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(x(O,y)).then(S):!a&&o.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():o.stringification&&a?[S(O)]:a?S(O):Promise.resolve(S(O))}},{key:"encapsulateSync",value:function(e,t,n){return this.encapsulate(e,t,u({throwOnBadSyncType:!0},n,{sync:!0}))}},{key:"encapsulateAsync",value:function(e,t,n){return this.encapsulate(e,t,u({throwOnBadSyncType:!0},n,{sync:!1}))}},{key:"revive",value:function(e,t){var n=e&&e.$types;if(!n)return e;if(!0===n)return e.$;var r=(t=u({sync:!0},this.options,{},t)).sync,i=[],o={},a=!0;n.$&&m(n.$)&&(e=e.$,n=n.$,a=!1);var s=this;function l(e,t){var n=c(s.revivers[e]||[],1)[0];if(!n)throw new Error("Unregistered type: "+e);return r&&!("revive"in n)?t:n[r&&n.revive?"revive":!r&&n.reviveAsync?"reviveAsync":"revive"](t,o)}var h=[];function p(e){return b(e,N)?void 0:e}var d,v=function(){var t=[];if(Object.entries(n).forEach((function(e){var r=c(e,2),i=r[0],o=r[1];"#"!==o&&[].concat(o).forEach((function(e){c(s.revivers[e]||[null,{}],2)[1].plain&&(t.push({keypath:i,type:e}),delete n[i])}))})),t.length)return t.sort(x).reduce((function t(n,r){var i=r.keypath,o=r.type;if(y(n))return n.then((function(e){return t(e,{keypath:i,type:o})}));var a=O(e,i);if(b(a=l(o,a),f))return a.then((function(t){var n=S(e,i,t);n===t&&(e=n)}));var u=S(e,i,a);u===a&&(e=u)}),void 0)}();return b(v,f)?d=v.then((function(){return e})):(d=function e(t,r,o,u,s){if(!a||"$types"!==t){var p=n[t],d=E(r);if(d||m(r)){var y=d?new Array(r.length):{};for(k(r).forEach((function(n){var i=e(t+(t?".":"")+w(n),r[n],o||y,y,n),a=function(e){return b(e,N)?y[n]=void 0:void 0!==e&&(y[n]=e),e};b(i,f)?h.push(i.then((function(e){return a(e)}))):a(i)})),r=y;i.length;){var v=c(i[0],4),g=v[0],_=v[1],S=v[2],A=v[3],j=O(g,_);if(void 0===j)break;S[A]=j,i.splice(0,1)}}if(!p)return r;if("#"===p){var x=O(o,r.slice(1));return void 0===x&&i.push([o,r.slice(1),u,s]),x}return[].concat(p).reduce((function e(t,n){return b(t,f)?t.then((function(t){return e(t,n)})):l(n,t)}),r)}}("",e,null),h.length&&(d=f.resolve(d).then((function(e){return f.all([e].concat(h))})).then((function(e){return c(e,1)[0]})))),y(d)?r&&t.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():b(d,f)?d.p.then(p):d:!r&&t.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():r?p(d):Promise.resolve(p(d))}},{key:"reviveSync",value:function(e,t){return this.revive(e,u({throwOnBadSyncType:!0},t,{sync:!0}))}},{key:"reviveAsync",value:function(e,t){return this.revive(e,u({throwOnBadSyncType:!0},t,{sync:!1}))}},{key:"register",value:function(e,n){return n=n||{},[].concat(e).forEach((function e(r){var i=this;if(E(r))return r.map((function(t){return e.call(i,t)}));r&&k(r).forEach((function(e){if("#"===e)throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(t.JSON_TYPES.includes(e))throw new TypeError("Plain JSON object types are reserved as type names");var i=r[e],o=i&&i.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,a=o.filter((function(t){return t.type===e}));if(a.length&&(o.splice(o.indexOf(a[0]),1),delete this.revivers[e],delete this.types[e]),"function"==typeof i){var s=i;i={test:function(e){return e&&e.constructor===s},replace:function(e){return u({},e)},revive:function(e){return Object.assign(Object.create(s.prototype),e)}}}else if(E(i)){var f=c(i,3);i={test:f[0],replace:f[1],revive:f[2]}}if(i&&i.test){var l={type:e,test:i.test.bind(i)};i.replace&&(l.replace=i.replace.bind(i)),i.replaceAsync&&(l.replaceAsync=i.replaceAsync.bind(i));var h="number"==typeof n.fallback?n.fallback:n.fallback?0:1/0;if(i.testPlainObjects?this.plainObjectReplacers.splice(h,0,l):this.nonplainObjectReplacers.splice(h,0,l),i.revive||i.reviveAsync){var p={};i.revive&&(p.revive=i.revive.bind(i)),i.reviveAsync&&(p.reviveAsync=i.reviveAsync.bind(i)),this.revivers[e]=[p,{plain:i.testPlainObjects}]}this.types[e]=i}}),this)}),this),this}}],a&&i(o.prototype,a),l&&i(o,l),t;var o,a,l}(),N=function e(){r(this,e)};return N.__typeson__type__="TypesonUndefined",T.Undefined=N,T.Promise=f,T.isThenable=y,T.toStringTag=v,T.hasConstructorOf=b,T.isObject=g,T.isPlainObject=m,T.isUserObject=function e(t){if(!t||"Object"!==v(t))return!1;var n=p(t);return!n||b(t,Object)||e(n)},T.escapeKeyPathComponent=w,T.unescapeKeyPathComponent=_,T.getByKeyPath=O,T.getJSONType=function(t){return null===t?"null":Array.isArray(t)?"array":e(t)},T.JSON_TYPES=["null","boolean","number","string","array","object"],T}()})),zt=Gt((function(e,t){e.exports=function(){function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==u.return||u.return()}finally{if(i)throw o}}return n}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var y=function e(t){u(this,e),this.p=new Promise(t)};y.__typeson__type__="TypesonPromise","undefined"!=typeof Symbol&&(y.prototype[Symbol.toStringTag]="TypesonPromise"),y.prototype.then=function(e,t){var n=this;return new y((function(r,i){n.p.then((function(t){r(e?e(t):t)})).catch((function(e){return t?t(e):Promise.reject(e)})).then(r,i)}))},y.prototype.catch=function(e){return this.then(null,e)},y.resolve=function(e){return new y((function(t){t(e)}))},y.reject=function(e){return new y((function(t,n){n(e)}))},["all","race"].forEach((function(e){y[e]=function(t){return new y((function(n,r){Promise[e](t.map((function(e){return e&&e.constructor&&"TypesonPromise"===e.constructor.__typeson__type__?e.p:e}))).then(n,r)}))}}));var v={}.toString,b={}.hasOwnProperty,m=Object.getPrototypeOf,g=b.toString;function w(e,t){return k(e)&&"function"==typeof e.then&&(!t||"function"==typeof e.catch)}function _(e){return v.call(e).slice(8,-1)}function O(e,t){if(!e||"object"!==a(e))return!1;var n=m(e);if(!n)return null===t;var r=b.call(n,"constructor")&&n.constructor;return"function"!=typeof r?null===t:t===r||null!==t&&g.call(r)===g.call(t)||"function"==typeof t&&"string"==typeof r.__typeson__type__&&r.__typeson__type__===t.__typeson__type__}function S(e){return!(!e||"Object"!==_(e))&&(!m(e)||O(e,Object))}function k(e){return e&&"object"===a(e)}function E(e){return e.replace(/~/g,"~0").replace(/\./g,"~1")}function A(e){return e.replace(/~1/g,".").replace(/~0/g,"~")}function j(e,t){if(""===t)return e;var n=t.indexOf(".");if(n>-1){var r=e[A(t.slice(0,n))];return void 0===r?void 0:j(r,t.slice(n+1))}return e[A(t)]}function x(e,t,n){if(""===t)return n;var r=t.indexOf(".");return r>-1?x(e[A(t.slice(0,r))],t.slice(r+1),n):(e[A(t)]=n,e)}function T(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var N=Object.keys,P=Array.isArray,I={}.hasOwnProperty,B=["type","replaced","iterateIn","iterateUnsetNumeric"];function C(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}function D(e,t){if(""===e.keypath)return-1;var n=e.keypath.match(/\./g)||0,r=t.keypath.match(/\./g)||0;return n&&(n=n.length),r&&(r=r.length),n>r?-1:n<r?1:e.keypath<t.keypath?-1:e.keypath>t.keypath}var R=function(){function e(t){u(this,e),this.options=t,this.plainObjectReplacers=[],this.nonplainObjectReplacers=[],this.revivers={},this.types={}}return function(e,t,n){t&&c(e.prototype,t)}(e,[{key:"stringify",value:function(e,t,n,r){r=l(l(l({},this.options),r),{},{stringification:!0});var i=this.encapsulate(e,null,r);return P(i)?JSON.stringify(i[0],t,n):i.then((function(e){return JSON.stringify(e,t,n)}))}},{key:"stringifySync",value:function(e,t,n,r){return this.stringify(e,t,n,l(l({throwOnBadSyncType:!0},r),{},{sync:!0}))}},{key:"stringifyAsync",value:function(e,t,n,r){return this.stringify(e,t,n,l(l({throwOnBadSyncType:!0},r),{},{sync:!1}))}},{key:"parse",value:function(e,t,n){return n=l(l(l({},this.options),n),{},{parse:!0}),this.revive(JSON.parse(e,t),n)}},{key:"parseSync",value:function(e,t,n){return this.parse(e,t,l(l({throwOnBadSyncType:!0},n),{},{sync:!0}))}},{key:"parseAsync",value:function(e,t,n){return this.parse(e,t,l(l({throwOnBadSyncType:!0},n),{},{sync:!1}))}},{key:"specialTypeNames",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.returnTypeNames=!0,this.encapsulate(e,t,n)}},{key:"rootTypeName",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.iterateNone=!0,this.encapsulate(e,t,n)}},{key:"encapsulate",value:function(t,n,r){var i=C((function(e,t){return T(Promise.all(t.map((function(e){return e[1].p}))),(function(n){return T(Promise.all(n.map(C((function(n){var r=!1,o=[],a=h(t.splice(0,1),1),u=h(a[0],7),c=u[0],s=u[2],f=u[3],l=u[4],p=u[5],d=u[6],v=A(c,n,s,f,o,!0,d),b=O(v,y);return function(e,t){var n=e();return n&&n.then?n.then(t):t(n)}((function(){if(c&&b)return T(v.p,(function(t){return l[p]=t,r=!0,i(e,o)}))}),(function(t){return r?t:(c?l[p]=v:e=b?v.p:v,i(e,o))}))})))),(function(){return e}))}))})),o=(r=l(l({sync:!0},this.options),r)).sync,u=this,c={},s=[],f=[],v=[],b=!("cyclic"in r)||r.cyclic,m=r.encapsulateObserver,g=A("",t,b,n||{},v);function w(t){var n=Object.values(c);if(r.iterateNone)return n.length?n[0]:e.getJSONType(t);if(n.length){if(r.returnTypeNames)return function(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(new Set(n));t&&S(t)&&!I.call(t,"$types")?t.$types=c:t={$:t,$types:{$:c}}}else k(t)&&I.call(t,"$types")&&(t={$:t,$types:!0});return!r.returnTypeNames&&t}function _(e,t,n){Object.assign(e,t);var r=B.map((function(t){var n=e[t];return delete e[t],n}));n(),B.forEach((function(t,n){e[t]=r[n]}))}function A(t,n,i,o,l,h,p){var d,v={},b=a(n),g=m?function(r){var a=p||o.type||e.getJSONType(n);m(Object.assign(r||v,{keypath:t,value:n,cyclic:i,stateObj:o,promisesData:l,resolvingTypesonPromise:h,awaitingTypesonPromise:O(n,y)},{type:a}))}:null;if(["string","boolean","number","undefined"].includes(b))return void 0===n||Number.isNaN(n)||n===Number.NEGATIVE_INFINITY||n===Number.POSITIVE_INFINITY?(d=o.replaced?n:j(t,n,o,l,!1,h,g))!==n&&(v={replaced:d}):d=n,g&&g(),d;if(null===n)return g&&g(),n;if(i&&!o.iterateIn&&!o.iterateUnsetNumeric&&n&&"object"===a(n)){var w=s.indexOf(n);if(!(w<0))return c[t]="#",g&&g({cyclicKeypath:f[w]}),"#"+f[w];!0===i&&(s.push(n),f.push(t))}var k,x=S(n),T=P(n),B=(x||T)&&(!u.plainObjectReplacers.length||o.replaced)||o.iterateIn?n:j(t,n,o,l,x||T,null,g);if(B!==n?(d=B,v={replaced:B}):""===t&&O(n,y)?(l.push([t,n,i,o,void 0,void 0,o.type]),d=n):T&&"object"!==o.iterateIn||"array"===o.iterateIn?(k=new Array(n.length),v={clone:k}):(["function","symbol"].includes(a(n))||"toJSON"in n||O(n,y)||O(n,Promise)||O(n,ArrayBuffer))&&!x&&"object"!==o.iterateIn?d=n:(k={},o.addLength&&(k.length=n.length),v={clone:k}),g&&g(),r.iterateNone)return k||d;if(!k)return d;if(o.iterateIn){var C=function(e){var r={ownKeys:I.call(n,e)};_(o,r,(function(){var r=t+(t?".":"")+E(e),a=A(r,n[e],Boolean(i),o,l,h);O(a,y)?l.push([r,a,Boolean(i),o,k,e,o.type]):void 0!==a&&(k[e]=a)}))};for(var D in n)C(D);g&&g({endIterateIn:!0,end:!0})}else N(n).forEach((function(e){var r=t+(t?".":"")+E(e);_(o,{ownKeys:!0},(function(){var t=A(r,n[e],Boolean(i),o,l,h);O(t,y)?l.push([r,t,Boolean(i),o,k,e,o.type]):void 0!==t&&(k[e]=t)}))})),g&&g({endIterateOwn:!0,end:!0});if(o.iterateUnsetNumeric){for(var R=n.length,U=function(e){if(!(e in n)){var r=t+(t?".":"")+e;_(o,{ownKeys:!1},(function(){var t=A(r,void 0,Boolean(i),o,l,h);O(t,y)?l.push([r,t,Boolean(i),o,k,e,o.type]):void 0!==t&&(k[e]=t)}))}},F=0;F<R;F++)U(F);g&&g({endIterateUnsetNumeric:!0,end:!0})}return k}function j(e,t,n,r,i,a,s){for(var f=i?u.plainObjectReplacers:u.nonplainObjectReplacers,l=f.length;l--;){var h=f[l];if(h.test(t,n)){var p=h.type;if(u.revivers[p]){var d=c[e];c[e]=d?[p].concat(d):p}return Object.assign(n,{type:p,replaced:!0}),!o&&h.replaceAsync||h.replace?(s&&s({replacing:!0}),A(e,h[o||!h.replaceAsync?"replace":"replaceAsync"](t,n),b&&"readonly",n,r,a,p)):(s&&s({typeDetected:!0}),A(e,t,b&&"readonly",n,r,a,p))}}return t}return v.length?o&&r.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():Promise.resolve(i(g,v)).then(w):!o&&r.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():r.stringification&&o?[w(g)]:o?w(g):Promise.resolve(w(g))}},{key:"encapsulateSync",value:function(e,t,n){return this.encapsulate(e,t,l(l({throwOnBadSyncType:!0},n),{},{sync:!0}))}},{key:"encapsulateAsync",value:function(e,t,n){return this.encapsulate(e,t,l(l({throwOnBadSyncType:!0},n),{},{sync:!1}))}},{key:"revive",value:function(e,t){var n=e&&e.$types;if(!n)return e;if(!0===n)return e.$;var r=(t=l(l({sync:!0},this.options),t)).sync,i=[],o={},a=!0;n.$&&S(n.$)&&(e=e.$,n=n.$,a=!1);var u=this;function c(e,t){var n=h(u.revivers[e]||[],1)[0];if(!n)throw new Error("Unregistered type: "+e);return r&&!("revive"in n)?t:n[r&&n.revive?"revive":!r&&n.reviveAsync?"reviveAsync":"revive"](t,o)}var s=[];function f(e){return O(e,U)?void 0:e}var p,d=function(){var t=[];if(Object.entries(n).forEach((function(e){var r=h(e,2),i=r[0],o=r[1];"#"!==o&&[].concat(o).forEach((function(e){h(u.revivers[e]||[null,{}],2)[1].plain&&(t.push({keypath:i,type:e}),delete n[i])}))})),t.length)return t.sort(D).reduce((function t(n,r){var i=r.keypath,o=r.type;if(w(n))return n.then((function(e){return t(e,{keypath:i,type:o})}));var a=j(e,i);if(O(a=c(o,a),y))return a.then((function(t){var n=x(e,i,t);n===t&&(e=n)}));var u=x(e,i,a);u===a&&(e=u)}),void 0)}();return O(d,y)?p=d.then((function(){return e})):(p=function e(t,r,o,u,f){if(!a||"$types"!==t){var l=n[t],p=P(r);if(p||S(r)){var d=p?new Array(r.length):{};for(N(r).forEach((function(n){var i=e(t+(t?".":"")+E(n),r[n],o||d,d,n),a=function(e){return O(e,U)?d[n]=void 0:void 0!==e&&(d[n]=e),e};O(i,y)?s.push(i.then((function(e){return a(e)}))):a(i)})),r=d;i.length;){var v=h(i[0],4),b=v[0],m=v[1],g=v[2],w=v[3],_=j(b,m);if(void 0===_)break;g[w]=_,i.splice(0,1)}}if(!l)return r;if("#"===l){var k=j(o,r.slice(1));return void 0===k&&i.push([o,r.slice(1),u,f]),k}return[].concat(l).reduce((function e(t,n){return O(t,y)?t.then((function(t){return e(t,n)})):c(n,t)}),r)}}("",e,null),s.length&&(p=y.resolve(p).then((function(e){return y.all([e].concat(s))})).then((function(e){return h(e,1)[0]})))),w(p)?r&&t.throwOnBadSyncType?function(){throw new TypeError("Sync method requested but async result obtained")}():O(p,y)?p.p.then(f):p:!r&&t.throwOnBadSyncType?function(){throw new TypeError("Async method requested but sync result obtained")}():r?f(p):Promise.resolve(f(p))}},{key:"reviveSync",value:function(e,t){return this.revive(e,l(l({throwOnBadSyncType:!0},t),{},{sync:!0}))}},{key:"reviveAsync",value:function(e,t){return this.revive(e,l(l({throwOnBadSyncType:!0},t),{},{sync:!1}))}},{key:"register",value:function(t,n){return n=n||{},[].concat(t).forEach((function t(r){var i=this;if(P(r))return r.map((function(e){return t.call(i,e)}));r&&N(r).forEach((function(t){if("#"===t)throw new TypeError("# cannot be used as a type name as it is reserved for cyclic objects");if(e.JSON_TYPES.includes(t))throw new TypeError("Plain JSON object types are reserved as type names");var i=r[t],o=i&&i.testPlainObjects?this.plainObjectReplacers:this.nonplainObjectReplacers,a=o.filter((function(e){return e.type===t}));if(a.length&&(o.splice(o.indexOf(a[0]),1),delete this.revivers[t],delete this.types[t]),"function"==typeof i){var u=i;i={test:function(e){return e&&e.constructor===u},replace:function(e){return l({},e)},revive:function(e){return Object.assign(Object.create(u.prototype),e)}}}else if(P(i)){var c=h(i,3);i={test:c[0],replace:c[1],revive:c[2]}}if(i&&i.test){var s={type:t,test:i.test.bind(i)};i.replace&&(s.replace=i.replace.bind(i)),i.replaceAsync&&(s.replaceAsync=i.replaceAsync.bind(i));var f="number"==typeof n.fallback?n.fallback:n.fallback?0:Number.POSITIVE_INFINITY;if(i.testPlainObjects?this.plainObjectReplacers.splice(f,0,s):this.nonplainObjectReplacers.splice(f,0,s),i.revive||i.reviveAsync){var p={};i.revive&&(p.revive=i.revive.bind(i)),i.reviveAsync&&(p.reviveAsync=i.reviveAsync.bind(i)),this.revivers[t]=[p,{plain:i.testPlainObjects}]}this.types[t]=i}}),this)}),this),this}}]),e}(),U=function e(){u(this,e)};U.__typeson__type__="TypesonUndefined",R.Undefined=U,R.Promise=y,R.isThenable=w,R.toStringTag=_,R.hasConstructorOf=O,R.isObject=k,R.isPlainObject=S,R.isUserObject=function e(t){if(!t||"Object"!==_(t))return!1;var n=m(t);return!n||O(t,Object)||e(n)},R.escapeKeyPathComponent=E,R.unescapeKeyPathComponent=A,R.getByKeyPath=j,R.getJSONType=function(e){return null===e?"null":Array.isArray(e)?"array":a(e)},R.JSON_TYPES=["null","boolean","number","string","array","object"];for(var F={userObject:{test:function(e,t){return R.isUserObject(e)},replace:function(e){return function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?r(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):r(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},e)},revive:function(e){return e}}},L=[{arrayNonindexKeys:{testPlainObjects:!0,test:function(e,t){return!!Array.isArray(e)&&(Object.keys(e).some((function(e){return String(Number.parseInt(e))!==e}))&&(t.iterateIn="object",t.addLength=!0),!0)},replace:function(e,t){return t.iterateUnsetNumeric=!0,e},revive:function(e){if(Array.isArray(e))return e;var t=[];return Object.keys(e).forEach((function(n){var r=e[n];t[n]=r})),t}}},{sparseUndefined:{test:function(e,t){return void 0===e&&!1===t.ownKeys},replace:function(e){return 0},revive:function(e){}}}],K={undef:{test:function(e,t){return void 0===e&&(t.ownKeys||!("ownKeys"in t))},replace:function(e){return 0},revive:function(e){return new R.Undefined}}},M={StringObject:{test:function(t){return"String"===R.toStringTag(t)&&"object"===e(t)},replace:function(e){return String(e)},revive:function(e){return new String(e)}},BooleanObject:{test:function(t){return"Boolean"===R.toStringTag(t)&&"object"===e(t)},replace:function(e){return Boolean(e)},revive:function(e){return new Boolean(e)}},NumberObject:{test:function(t){return"Number"===R.toStringTag(t)&&"object"===e(t)},replace:function(e){return Number(e)},revive:function(e){return new Number(e)}}},q=[{nan:{test:function(e){return Number.isNaN(e)},replace:function(e){return"NaN"},revive:function(e){return Number.NaN}}},{infinity:{test:function(e){return e===Number.POSITIVE_INFINITY},replace:function(e){return"Infinity"},revive:function(e){return Number.POSITIVE_INFINITY}}},{negativeInfinity:{test:function(e){return e===Number.NEGATIVE_INFINITY},replace:function(e){return"-Infinity"},revive:function(e){return Number.NEGATIVE_INFINITY}}}],V={date:{test:function(e){return"Date"===R.toStringTag(e)},replace:function(e){var t=e.getTime();return Number.isNaN(t)?"NaN":t},revive:function(e){return"NaN"===e?new Date(Number.NaN):new Date(e)}}},J={regexp:{test:function(e){return"RegExp"===R.toStringTag(e)},replace:function(e){return{source:e.source,flags:(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":"")}},revive:function(e){var t=e.source,n=e.flags;return new RegExp(t,n)}}},$={map:{test:function(e){return"Map"===R.toStringTag(e)},replace:function(e){return i(e.entries())},revive:function(e){return new Map(e)}}},G={set:{test:function(e){return"Set"===R.toStringTag(e)},replace:function(e){return i(e.values())},revive:function(e){return new Set(e)}}},Y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",z=new Uint8Array(256),H=0;H<64;H++)z[Y.charCodeAt(H)]=H;var Q=function(e,t,n){null==n&&(n=e.byteLength);for(var r=new Uint8Array(e,t||0,n),i=r.length,o="",a=0;a<i;a+=3)o+=Y[r[a]>>2],o+=Y[(3&r[a])<<4|r[a+1]>>4],o+=Y[(15&r[a+1])<<2|r[a+2]>>6],o+=Y[63&r[a+2]];return i%3==2?o=o.slice(0,-1)+"=":i%3==1&&(o=o.slice(0,-2)+"=="),o},W=function(e){var t,n,r,i,o=e.length,a=.75*e.length,u=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);for(var c=new ArrayBuffer(a),s=new Uint8Array(c),f=0;f<o;f+=4)t=z[e.charCodeAt(f)],n=z[e.charCodeAt(f+1)],r=z[e.charCodeAt(f+2)],i=z[e.charCodeAt(f+3)],s[u++]=t<<2|n>>4,s[u++]=(15&n)<<4|r>>2,s[u++]=(3&r)<<6|63&i;return c},X={arraybuffer:{test:function(e){return"ArrayBuffer"===R.toStringTag(e)},replace:function(e,t){t.buffers||(t.buffers=[]);var n=t.buffers.indexOf(e);return n>-1?{index:n}:(t.buffers.push(e),Q(e))},revive:function(t,n){if(n.buffers||(n.buffers=[]),"object"===e(t))return n.buffers[t.index];var r=W(t);return n.buffers.push(r),r}}},Z="undefined"==typeof self?$t:self,ee={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach((function(e){var t=e,n=Z[t];n&&(ee[e.toLowerCase()]={test:function(e){return R.toStringTag(e)===t},replace:function(e,t){var n=e.buffer,r=e.byteOffset,i=e.length;t.buffers||(t.buffers=[]);var o=t.buffers.indexOf(n);return o>-1?{index:o,byteOffset:r,length:i}:(t.buffers.push(n),{encoded:Q(n),byteOffset:r,length:i})},revive:function(e,t){t.buffers||(t.buffers=[]);var r,i=e.byteOffset,o=e.length,a=e.encoded,u=e.index;return"index"in e?r=t.buffers[u]:(r=W(a),t.buffers.push(r)),new n(r,i,o)}})}));var te={dataview:{test:function(e){return"DataView"===R.toStringTag(e)},replace:function(e,t){var n=e.buffer,r=e.byteOffset,i=e.byteLength;t.buffers||(t.buffers=[]);var o=t.buffers.indexOf(n);return o>-1?{index:o,byteOffset:r,byteLength:i}:(t.buffers.push(n),{encoded:Q(n),byteOffset:r,byteLength:i})},revive:function(e,t){t.buffers||(t.buffers=[]);var n,r=e.byteOffset,i=e.byteLength,o=e.encoded,a=e.index;return"index"in e?n=t.buffers[a]:(n=W(o),t.buffers.push(n)),new DataView(n,r,i)}}},ne={IntlCollator:{test:function(e){return R.hasConstructorOf(e,Intl.Collator)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.Collator(e.locale,e)}},IntlDateTimeFormat:{test:function(e){return R.hasConstructorOf(e,Intl.DateTimeFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.DateTimeFormat(e.locale,e)}},IntlNumberFormat:{test:function(e){return R.hasConstructorOf(e,Intl.NumberFormat)},replace:function(e){return e.resolvedOptions()},revive:function(e){return new Intl.NumberFormat(e.locale,e)}}};function re(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t.buffer}var ie={file:{test:function(e){return"File"===R.toStringTag(e)},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),200!==t.status&&0!==t.status)throw new Error("Bad File access: "+t.status);return{type:e.type,stringContents:t.responseText,name:e.name,lastModified:e.lastModified}},revive:function(e){var t=e.name,n=e.type,r=e.stringContents,i=e.lastModified;return new File([re(r)],t,{type:n,lastModified:i})},replaceAsync:function(e){return new R.Promise((function(t,n){var r=new FileReader;r.addEventListener("load",(function(){t({type:e.type,stringContents:r.result,name:e.name,lastModified:e.lastModified})})),r.addEventListener("error",(function(){n(r.error)})),r.readAsBinaryString(e)}))}}},oe={bigint:{test:function(e){return"bigint"==typeof e},replace:function(e){return String(e)},revive:function(e){return BigInt(e)}}},ae={bigintObject:{test:function(t){return"object"===e(t)&&R.hasConstructorOf(t,BigInt)},replace:function(e){return String(e)},revive:function(e){return new Object(BigInt(e))}}},ue={cryptokey:{test:function(e){return"CryptoKey"===R.toStringTag(e)&&e.extractable},replaceAsync:function(e){return new R.Promise((function(t,n){crypto.subtle.exportKey("jwk",e).catch((function(e){n(e)})).then((function(n){t({jwk:n,algorithm:e.algorithm,usages:e.usages})}))}))},revive:function(e){var t=e.jwk,n=e.algorithm,r=e.usages;return crypto.subtle.importKey("jwk",t,n,!0,r)}}};return[F,K,L,M,q,V,J,{imagedata:{test:function(e){return"ImageData"===R.toStringTag(e)},replace:function(e){return{array:i(e.data),width:e.width,height:e.height}},revive:function(e){return new ImageData(new Uint8ClampedArray(e.array),e.width,e.height)}}},{imagebitmap:{test:function(e){return"ImageBitmap"===R.toStringTag(e)||e&&e.dataset&&"ImageBitmap"===e.dataset.toStringTag},replace:function(e){var t=document.createElement("canvas");return t.getContext("2d").drawImage(e,0,0),t.toDataURL()},revive:function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=document.createElement("img");return r.addEventListener("load",(function(){n.drawImage(r,0,0)})),r.src=e,t},reviveAsync:function(e){var t=document.createElement("canvas"),n=t.getContext("2d"),r=document.createElement("img");return r.addEventListener("load",(function(){n.drawImage(r,0,0)})),r.src=e,createImageBitmap(t)}}},ie,{file:ie.file,filelist:{test:function(e){return"FileList"===R.toStringTag(e)},replace:function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e.item(n);return t},revive:function(e){return new(function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e),this._files=arguments[0],this.length=this._files.length}return function(e,n,r){n&&t(e.prototype,n)}(e,[{key:"item",value:function(e){return this._files[e]}},{key:Symbol.toStringTag,get:function(){return"FileList"}}]),e}())(e)}}},{blob:{test:function(e){return"Blob"===R.toStringTag(e)},replace:function(e){var t=new XMLHttpRequest;if(t.overrideMimeType("text/plain; charset=x-user-defined"),t.open("GET",URL.createObjectURL(e),!1),t.send(),200!==t.status&&0!==t.status)throw new Error("Bad Blob access: "+t.status);return{type:e.type,stringContents:t.responseText}},revive:function(e){var t=e.type,n=e.stringContents;return new Blob([re(n)],{type:t})},replaceAsync:function(e){return new R.Promise((function(t,n){var r=new FileReader;r.addEventListener("load",(function(){t({type:e.type,stringContents:r.result})})),r.addEventListener("error",(function(){n(r.error)})),r.readAsBinaryString(e)}))}}}].concat("function"==typeof Map?$:[],"function"==typeof Set?G:[],"function"==typeof ArrayBuffer?X:[],"function"==typeof Uint8Array?ee:[],"function"==typeof DataView?te:[],"undefined"!=typeof Intl?ne:[],"undefined"!=typeof crypto?ue:[],"undefined"!=typeof BigInt?[oe,ae]:[])}()})),Ht="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Qt=new Uint8Array(256),Wt=0;Wt<64;Wt++)Qt[Ht.codePointAt(Wt)]=Wt;var Xt=function(e,t,n){null==n&&(n=e.byteLength);for(var r=new Uint8Array(e,t||0,n),i=r.length,o="",a=0;a<i;a+=3)o+=Ht[r[a]>>2],o+=Ht[(3&r[a])<<4|r[a+1]>>4],o+=Ht[(15&r[a+1])<<2|r[a+2]>>6],o+=Ht[63&r[a+2]];return i%3==2?o=o.slice(0,-1)+"=":i%3==1&&(o=o.slice(0,-2)+"=="),o},Zt=function(e){var t,n,r,i,o=e.length,a=.75*e.length,u=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);for(var c=new ArrayBuffer(a),s=new Uint8Array(c),f=0;f<o;f+=4)t=Qt[e.codePointAt(f)],n=Qt[e.codePointAt(f+1)],r=Qt[e.codePointAt(f+2)],i=Qt[e.codePointAt(f+3)],s[u++]=t<<2|n>>4,s[u++]=(15&n)<<4|r>>2,s[u++]=(3&r)<<6|63&i;return c},en="undefined"==typeof self?global:self,tn={};["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array"].forEach((function(e){var t=e,n=en[t];n&&(tn[e.toLowerCase()+"2"]={test:function(e){return Yt.toStringTag(e)===t},replace:function(e){return{buffer:e.buffer,byteOffset:e.byteOffset,length:e.length}},revive:function(e){var t=e.buffer,r=e.byteOffset,i=e.length;return new n(t,r,i)}})}));var nn={arraybuffer:{test:function(e){return"ArrayBuffer"===Yt.toStringTag(e)},replace:function(e){return Xt(e,0,e.byteLength)},revive:function(e){return Zt(e)}}},rn=(new Yt).register(zt),on="FileReaderSync"in self,an=[],un=0;rn.register([nn,tn,{blob2:{test:function(e){return"Blob"===Yt.toStringTag(e)},replace:function(e){if(e.isClosed)throw new Error("The Blob is closed");if(on){var t=Jt(e,"binary"),n=Xt(t,0,t.byteLength);return{type:e.type,data:n}}an.push(e);var r={type:e.type,data:{start:un,end:un+e.size}};return un+=e.size,r},finalize:function(e,t){e.data=Xt(t,0,t.byteLength)},revive:function(e){var t=e.type,n=e.data;return new Blob([Zt(n)],{type:t})}}}]),rn.mustFinalize=function(){return an.length>0},rn.finalize=function(e){return Kt(void 0,void 0,void 0,(function(){var t,n,r,i,o,a,u,c,s,f;return Mt(this,(function(l){switch(l.label){case 0:return[4,Vt(new Blob(an),"binary")];case 1:if(t=l.sent(),e)for(n=0,r=e;n<r.length;n++)if((i=r[n]).$types)for(u in o=i.$types,(a=o.$)&&(o=o.$),o)c=o[u],(s=rn.types[c])&&s.finalize&&(f=Lt.getByKeyPath(i,a?"$."+u:u),s.finalize(f,t.slice(f.start,f.end)));return an=[],[2]}}))}))};var cn=2e3;function sn(e,t){return Kt(this,void 0,void 0,(function(){function n(){return Kt(this,void 0,void 0,(function(){var n,s,f,l,h,p,d,y,v;return Mt(this,(function(b){switch(b.label){case 0:return[4,Promise.all(e.tables.map((function(e){return e.count()})))];case 1:(n=b.sent()).forEach((function(e,t){return i[t].rowCount=e})),c.totalRows=n.reduce((function(e,t){return e+t})),s=JSON.stringify(a,void 0,o?2:void 0),f=s.lastIndexOf("]"),l=s.substring(0,f),r.push(l),h=t.filter,p=function(n){var i,a,s,f,l,p,d,y,v,b,m;return Mt(this,(function(g){switch(g.label){case 0:i=e.table(n),a=i.schema.primKey,s=!!a.keyPath,f=t.numRowsPerChunk||cn,l=s?{tableName:i.name,inbound:!0,rows:[]}:{tableName:i.name,inbound:!1,rows:[]},p=JSON.stringify(l,void 0,o?2:void 0),o&&(p=p.split("\n").join("\n    ")),d=p.lastIndexOf("]"),r.push(p.substring(0,d)),y=null,v=0,b=!0,m=function(){var e,t,l,p,d,m,g,w;return Mt(this,(function(_){switch(_.label){case 0:return u&&Lt.ignoreTransaction((function(){return u(c)})),[4,(e=null==y?i.limit(f):i.where(":id").above(y).limit(f)).toArray()];case 1:return 0===(t=_.sent()).length?[2,"break"]:(null!=y&&v>0&&(r.push(","),o&&r.push("\n      ")),b=t.length===f,s?(l=h?t.filter((function(e){return h(n,e)})):t,p=l.map((function(e){return rn.encapsulate(e)})),rn.mustFinalize()?[4,Lt.waitFor(rn.finalize(p))]:[3,3]):[3,4]);case 2:_.sent(),_.label=3;case 3:return w=JSON.stringify(p,void 0,o?2:void 0),o&&(w=w.split("\n").join("\n      ")),r.push(new Blob([w.substring(1,w.length-1)])),v=l.length,y=t.length>0?Lt.getByKeyPath(t[t.length-1],a.keyPath):null,[3,8];case 4:return[4,e.primaryKeys()];case 5:return d=_.sent(),m=d.map((function(e,n){return[e,t[n]]})),h&&(m=m.filter((function(e){var t=e[0],r=e[1];return h(n,r,t)}))),g=m.map((function(e){return rn.encapsulate(e)})),rn.mustFinalize()?[4,Lt.waitFor(rn.finalize(g))]:[3,7];case 6:_.sent(),_.label=7;case 7:w=JSON.stringify(g,void 0,o?2:void 0),o&&(w=w.split("\n").join("\n      ")),r.push(new Blob([w.substring(1,w.length-1)])),v=m.length,y=d.length>0?d[d.length-1]:null,_.label=8;case 8:return c.completedRows+=t.length,[2]}}))},g.label=1;case 1:return b?[5,m()]:[3,3];case 2:return"break"===g.sent()?[3,3]:[3,1];case 3:return r.push(p.substr(d)),c.completedTables+=1,c.completedTables<c.totalTables&&r.push(","),[2]}}))},d=0,y=i,b.label=2;case 2:return d<y.length?(v=y[d].name,[5,p(v)]):[3,5];case 3:b.sent(),b.label=4;case 4:return d++,[3,2];case 5:return r.push(s.substr(f)),c.done=!0,u&&Lt.ignoreTransaction((function(){return u(c)})),[2]}}))}))}var r,i,o,a,u,c;return Mt(this,(function(s){switch(s.label){case 0:t=t||{},r=[],i=e.tables.map((function(e){return{name:e.name,schema:qt(e),rowCount:0}})),o=t.prettyJson,a={formatName:"dexie",formatVersion:1,data:{databaseName:e.name,databaseVersion:e.verno,tables:i,data:[]}},u=t.progressCallback,c={done:!1,completedRows:0,completedTables:0,totalRows:NaN,totalTables:e.tables.length},s.label=1;case 1:return s.trys.push([1,,6,7]),t.noTransaction?[4,n()]:[3,3];case 2:return s.sent(),[3,5];case 3:return[4,e.transaction("r",e.tables,n)];case 4:s.sent(),s.label=5;case 5:return[3,7];case 6:return rn.finalize(),[7];case 7:return[2,new Blob(r,{type:"text/json"})]}}))}))}var fn=1,ln=function(){},hn=Gt((function(e,t){!function(e){var t="object"==typeof process&&process.env?process.env:self;e.parser=function(e){return new f(e)},e.CParser=f,e.CStream=l,e.createStream=function(e){return new l(e)},e.MAX_BUFFER_LENGTH=10485760,e.DEBUG="debug"===t.CDEBUG,e.INFO="debug"===t.CDEBUG||"info"===t.CDEBUG,e.EVENTS=["value","string","key","openobject","closeobject","openarray","closearray","error","end","ready"];var n,r={textNode:void 0,numberNode:""},i=e.EVENTS.filter((function(e){return"error"!==e&&"end"!==e})),o=0;for(var a in e.STATE={BEGIN:o++,VALUE:o++,OPEN_OBJECT:o++,CLOSE_OBJECT:o++,OPEN_ARRAY:o++,CLOSE_ARRAY:o++,TEXT_ESCAPE:o++,STRING:o++,BACKSLASH:o++,END:o++,OPEN_KEY:o++,CLOSE_KEY:o++,TRUE:o++,TRUE2:o++,TRUE3:o++,FALSE:o++,FALSE2:o++,FALSE3:o++,FALSE4:o++,NULL:o++,NULL2:o++,NULL3:o++,NUMBER_DECIMAL_POINT:o++,NUMBER_DIGIT:o++},e.STATE)e.STATE[e.STATE[a]]=a;o=e.STATE;const u={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125};function c(e){for(var t in r)e[t]=r[t]}Object.create||(Object.create=function(e){function t(){this.__proto__=e}return t.prototype=e,new t}),Object.getPrototypeOf||(Object.getPrototypeOf=function(e){return e.__proto__}),Object.keys||(Object.keys=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t});var s=/[\\"\n]/g;function f(t){if(!(this instanceof f))return new f(t);var n=this;c(n),n.bufferCheckPosition=e.MAX_BUFFER_LENGTH,n.q=n.c=n.p="",n.opt=t||{},n.closed=n.closedRoot=n.sawRoot=!1,n.tag=n.error=null,n.state=o.BEGIN,n.stack=new Array,n.position=n.column=0,n.line=1,n.slashed=!1,n.unicodeI=0,n.unicodeS=null,n.depth=0,h(n,"onready")}f.prototype={end:function(){b(this)},write:function(t){var n=this;if(this.error)throw this.error;if(n.closed)return v(n,"Cannot write after close. Assign an onready handler.");if(null===t)return b(n);var i=0,a=t.charCodeAt(0),c=n.p;for(e.DEBUG&&console.log("write -> ["+t+"]");a&&(c=a,n.c=a=t.charCodeAt(i++),c!==a?n.p=c:c=n.p,a);)switch(e.DEBUG&&console.log(i,a,e.STATE[n.state]),n.position++,a===u.lineFeed?(n.line++,n.column=0):n.column++,n.state){case o.BEGIN:a===u.openBrace?n.state=o.OPEN_OBJECT:a===u.openBracket?n.state=o.OPEN_ARRAY:m(a)||v(n,"Non-whitespace before {[.");continue;case o.OPEN_KEY:case o.OPEN_OBJECT:if(m(a))continue;if(n.state===o.OPEN_KEY)n.stack.push(o.CLOSE_KEY);else{if(a===u.closeBrace){h(n,"onopenobject"),this.depth++,h(n,"oncloseobject"),this.depth--,n.state=n.stack.pop()||o.VALUE;continue}n.stack.push(o.CLOSE_OBJECT)}a===u.doubleQuote?n.state=o.STRING:v(n,'Malformed object key should start with "');continue;case o.CLOSE_KEY:case o.CLOSE_OBJECT:if(m(a))continue;n.state,o.CLOSE_KEY,a===u.colon?(n.state===o.CLOSE_OBJECT?(n.stack.push(o.CLOSE_OBJECT),d(n,"onopenobject"),this.depth++):d(n,"onkey"),n.state=o.VALUE):a===u.closeBrace?(p(n,"oncloseobject"),this.depth--,n.state=n.stack.pop()||o.VALUE):a===u.comma?(n.state===o.CLOSE_OBJECT&&n.stack.push(o.CLOSE_OBJECT),d(n),n.state=o.OPEN_KEY):v(n,"Bad object");continue;case o.OPEN_ARRAY:case o.VALUE:if(m(a))continue;if(n.state===o.OPEN_ARRAY){if(h(n,"onopenarray"),this.depth++,n.state=o.VALUE,a===u.closeBracket){h(n,"onclosearray"),this.depth--,n.state=n.stack.pop()||o.VALUE;continue}n.stack.push(o.CLOSE_ARRAY)}a===u.doubleQuote?n.state=o.STRING:a===u.openBrace?n.state=o.OPEN_OBJECT:a===u.openBracket?n.state=o.OPEN_ARRAY:a===u.t?n.state=o.TRUE:a===u.f?n.state=o.FALSE:a===u.n?n.state=o.NULL:a===u.minus?n.numberNode+="-":u._0<=a&&a<=u._9?(n.numberNode+=String.fromCharCode(a),n.state=o.NUMBER_DIGIT):v(n,"Bad value");continue;case o.CLOSE_ARRAY:if(a===u.comma)n.stack.push(o.CLOSE_ARRAY),d(n,"onvalue"),n.state=o.VALUE;else if(a===u.closeBracket)p(n,"onclosearray"),this.depth--,n.state=n.stack.pop()||o.VALUE;else{if(m(a))continue;v(n,"Bad array")}continue;case o.STRING:void 0===n.textNode&&(n.textNode="");var f=i-1,l=n.slashed,g=n.unicodeI;e:for(;;){for(e.DEBUG&&console.log(i,a,e.STATE[n.state],l);g>0;)if(n.unicodeS+=String.fromCharCode(a),a=t.charCodeAt(i++),n.position++,4===g?(n.textNode+=String.fromCharCode(parseInt(n.unicodeS,16)),g=0,f=i-1):g++,!a)break e;if(a===u.doubleQuote&&!l){n.state=n.stack.pop()||o.VALUE,n.textNode+=t.substring(f,i-1),n.position+=i-1-f;break}if(a===u.backslash&&!l&&(l=!0,n.textNode+=t.substring(f,i-1),n.position+=i-1-f,a=t.charCodeAt(i++),n.position++,!a))break;if(l){if(l=!1,a===u.n?n.textNode+="\n":a===u.r?n.textNode+="\r":a===u.t?n.textNode+="\t":a===u.f?n.textNode+="\f":a===u.b?n.textNode+="\b":a===u.u?(g=1,n.unicodeS=""):n.textNode+=String.fromCharCode(a),a=t.charCodeAt(i++),n.position++,f=i-1,a)continue;break}s.lastIndex=i;var w=s.exec(t);if(null===w){i=t.length+1,n.textNode+=t.substring(f,i-1),n.position+=i-1-f;break}if(i=w.index+1,!(a=t.charCodeAt(w.index))){n.textNode+=t.substring(f,i-1),n.position+=i-1-f;break}}n.slashed=l,n.unicodeI=g;continue;case o.TRUE:a===u.r?n.state=o.TRUE2:v(n,"Invalid true started with t"+a);continue;case o.TRUE2:a===u.u?n.state=o.TRUE3:v(n,"Invalid true started with tr"+a);continue;case o.TRUE3:a===u.e?(h(n,"onvalue",!0),n.state=n.stack.pop()||o.VALUE):v(n,"Invalid true started with tru"+a);continue;case o.FALSE:a===u.a?n.state=o.FALSE2:v(n,"Invalid false started with f"+a);continue;case o.FALSE2:a===u.l?n.state=o.FALSE3:v(n,"Invalid false started with fa"+a);continue;case o.FALSE3:a===u.s?n.state=o.FALSE4:v(n,"Invalid false started with fal"+a);continue;case o.FALSE4:a===u.e?(h(n,"onvalue",!1),n.state=n.stack.pop()||o.VALUE):v(n,"Invalid false started with fals"+a);continue;case o.NULL:a===u.u?n.state=o.NULL2:v(n,"Invalid null started with n"+a);continue;case o.NULL2:a===u.l?n.state=o.NULL3:v(n,"Invalid null started with nu"+a);continue;case o.NULL3:a===u.l?(h(n,"onvalue",null),n.state=n.stack.pop()||o.VALUE):v(n,"Invalid null started with nul"+a);continue;case o.NUMBER_DECIMAL_POINT:a===u.period?(n.numberNode+=".",n.state=o.NUMBER_DIGIT):v(n,"Leading zero not followed by .");continue;case o.NUMBER_DIGIT:u._0<=a&&a<=u._9?n.numberNode+=String.fromCharCode(a):a===u.period?(-1!==n.numberNode.indexOf(".")&&v(n,"Invalid number has two dots"),n.numberNode+="."):a===u.e||a===u.E?(-1===n.numberNode.indexOf("e")&&-1===n.numberNode.indexOf("E")||v(n,"Invalid number has two exponential"),n.numberNode+="e"):a===u.plus||a===u.minus?(c!==u.e&&c!==u.E&&v(n,"Invalid symbol in number"),n.numberNode+=String.fromCharCode(a)):(y(n),i--,n.state=n.stack.pop()||o.VALUE);continue;default:v(n,"Unknown state: "+n.state)}return n.position>=n.bufferCheckPosition&&function(t){var n=Math.max(e.MAX_BUFFER_LENGTH,10),i=0;for(var o in r){var a=void 0===t[o]?0:t[o].length;a>n&&("text"===o?closeText(t):v(t,"Max buffer length exceeded: "+o)),i=Math.max(i,a)}t.bufferCheckPosition=e.MAX_BUFFER_LENGTH-i+t.position}(n),n},resume:function(){return this.error=null,this},close:function(){return this.write(null)}};try{n=ln}catch(e){n=function(){}}function l(e){if(!(this instanceof l))return new l(e);this._parser=new f(e),this.writable=!0,this.readable=!0,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new Buffer(2),3:new Buffer(3),4:new Buffer(4)},this.string="";var t=this;n.apply(t),this._parser.onend=function(){t.emit("end")},this._parser.onerror=function(e){t.emit("error",e),t._parser.error=null},i.forEach((function(e){Object.defineProperty(t,"on"+e,{get:function(){return t._parser["on"+e]},set:function(n){if(!n)return t.removeAllListeners(e),t._parser["on"+e]=n,n;t.on(e,n)},enumerable:!0,configurable:!1})}))}function h(t,n,r){e.INFO&&console.log("-- emit",n,r),t[n]&&t[n](r)}function p(e,t,n){d(e),h(e,t,n)}function d(e,t){var n,r;e.textNode=(n=e.opt,void 0===(r=e.textNode)||(n.trim&&(r=r.trim()),n.normalize&&(r=r.replace(/\s+/g," "))),r),void 0!==e.textNode&&h(e,t||"onvalue",e.textNode),e.textNode=void 0}function y(e){e.numberNode&&h(e,"onvalue",parseFloat(e.numberNode)),e.numberNode=""}function v(e,t){return d(e),t+="\nLine: "+e.line+"\nColumn: "+e.column+"\nChar: "+e.c,t=new Error(t),e.error=t,h(e,"onerror",t),e}function b(e){return e.state===o.VALUE&&0===e.depth||v(e,"Unexpected end"),d(e),e.c="",e.closed=!0,h(e,"onend"),f.call(e,e.opt),e}function m(e){return e===u.carriageReturn||e===u.lineFeed||e===u.space||e===u.tab}l.prototype=Object.create(n.prototype,{constructor:{value:l}}),l.prototype.write=function(e){e=new Buffer(e);for(var t=0;t<e.length;t++){var n=e[t];if(this.bytes_remaining>0){for(var r=0;r<this.bytes_remaining;r++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+r]=e[r];this.string=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,t=t+r-1,this._parser.write(this.string),this.emit("data",this.string)}else if(0===this.bytes_remaining&&n>=128){if(n>=194&&n<=223&&(this.bytes_in_sequence=2),n>=224&&n<=239&&(this.bytes_in_sequence=3),n>=240&&n<=244&&(this.bytes_in_sequence=4),this.bytes_in_sequence+t>e.length){for(var i=0;i<=e.length-1-t;i++)this.temp_buffs[this.bytes_in_sequence][i]=e[t+i];return this.bytes_remaining=t+this.bytes_in_sequence-e.length,!0}this.string=e.slice(t,t+this.bytes_in_sequence).toString(),t=t+this.bytes_in_sequence-1,this._parser.write(this.string),this.emit("data",this.string)}else{for(var o=t;o<e.length&&!(e[o]>=128);o++);this.string=e.slice(t,o).toString(),this._parser.write(this.string),this.emit("data",this.string),t=o-1}}},l.prototype.end=function(e){return e&&e.length&&this._parser.write(e.toString()),this._parser.end(),!0},l.prototype.on=function(e,t){var r=this;return r._parser["on"+e]||-1===i.indexOf(e)||(r._parser["on"+e]=function(){var t=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);t.splice(0,0,e),r.emit.apply(r,t)}),n.prototype.on.call(r,e,t)},l.prototype.destroy=function(){c(this._parser),this.emit("close")}}(t)}));function pn(e){var t=0,n=function(e){var t,n,r,i=hn.parser(),o=0,a=[],u=!1,c=!1;return i.onopenobject=function(e){var i={incomplete:!0};t||(t=i),n&&(a.push([r,n,c]),c?n.push(i):n[r]=i),n=i,r=e,c=!1,++o},i.onkey=function(e){return r=e},i.onvalue=function(e){return c?n.push(e):n[r]=e},i.oncloseobject=function(){var e;if(delete n.incomplete,r=null,0==--o)u=!0;else{e=a.pop(),r=e[0],n=e[1],c=e[2]}},i.onopenarray=function(){var e=[];e.incomplete=!0,t||(t=e),n&&(a.push([r,n,c]),c?n.push(e):n[r]=e),n=e,c=!0,r=null,++o},i.onclosearray=function(){var e;if(delete n.incomplete,r=null,0==--o)u=!0;else{e=a.pop(),r=e[0],n=e[1],c=e[2]}},{write:function(e){return i.write(e),t},done:function(){return u}}}(),r={pullAsync:function(i){return Kt(this,void 0,void 0,(function(){var o,a,u;return Mt(this,(function(c){switch(c.label){case 0:return o=e.slice(t,t+i),t+=i,[4,Vt(o,"text")];case 1:return a=c.sent(),u=n.write(a),r.result=u||{},[2,u]}}))}))},pullSync:function(i){var o=e.slice(t,t+i);t+=i;var a=Jt(o,"text"),u=n.write(a);return r.result=u||{},u},done:function(){return n.done()},eof:function(){return t>=e.size},result:{}};return r}var dn=1024;function yn(e,t){return Kt(this,void 0,void 0,(function(){var n,r,i,o;return Mt(this,(function(a){switch(a.label){case 0:return n=(t=t||{}).chunkSizeBytes||1024*dn,[4,mn(e,n)];case 1:return r=a.sent(),i=r.result.data,(o=new Lt(i.databaseName)).version(i.databaseVersion).stores(function(e){for(var t={},n=0,r=e.tables;n<r.length;n++){var i=r[n];t[i.name]=i.schema}return t}(i)),[4,bn(o,r,t)];case 2:return a.sent(),[2,o]}}))}))}function vn(e){return Kt(this,void 0,void 0,(function(){var t;return Mt(this,(function(n){switch(n.label){case 0:t=pn(e),n.label=1;case 1:return t.eof()?[3,3]:[4,t.pullAsync(5120)];case 2:return n.sent(),t.result.data&&t.result.data.data?(delete t.result.data.data,[3,3]):[3,1];case 3:return[2,t.result]}}))}))}function bn(e,t,n){return Kt(this,void 0,void 0,(function(){function r(){return Kt(this,void 0,void 0,(function(){var t,r,a,l;return Mt(this,(function(h){switch(h.label){case 0:t=function(t){var r,i,o,a,u,l,h,p,d,y,v,b;return Mt(this,(function(m){switch(m.label){case 0:if(!t.rows)return[2,"break"];if(!t.rows.incomplete&&0===t.rows.length)return[2,"continue"];if(s&&Lt.ignoreTransaction((function(){return s(f)})),r=t.tableName,i=e.table(r),o=c.tables.filter((function(e){return e.name===r}))[0].schema,!i){if(n.acceptMissingTables)return[2,"continue"];throw new Error("Exported table ".concat(t.tableName," is missing in installed database"))}if(!n.acceptChangedPrimaryKey&&o.split(",")[0]!=i.schema.primKey.src)throw new Error("Primary key differs for table ".concat(t.tableName,". "));for(a=t.rows,u=[],l=0;l<a.length&&!(h=a[l]).incomplete;l++)u.push(rn.revive(h));return p=n.filter,d=p?t.inbound?u.filter((function(e){return p(r,e)})):u.filter((function(e){var t=e[0],n=e[1];return p(r,n,t)})):u,y=t.inbound?[void 0,d]:[d.map((function(e){return e[0]})),u.map((function(e){return e[1]}))],v=y[0],b=y[1],n.overwriteValues?[4,i.bulkPut(b,v)]:[3,2];case 1:return m.sent(),[3,4];case 2:return[4,i.bulkAdd(b,v)];case 3:m.sent(),m.label=4;case 4:return f.completedRows+=u.length,u.incomplete||(f.completedTables+=1),a.splice(0,u.length),[2]}}))},r=0,a=c.data,h.label=1;case 1:return r<a.length?(l=a[r],[5,t(l)]):[3,4];case 2:if("break"===h.sent())return[3,4];h.label=3;case 3:return r++,[3,1];case 4:for(;c.data.length>0&&c.data[0].rows&&!c.data[0].rows.incomplete;)c.data.splice(0,1);return o.done()||o.eof()?[3,8]:u?(o.pullSync(i),[3,7]):[3,5];case 5:return[4,Lt.waitFor(o.pullAsync(i))];case 6:h.sent(),h.label=7;case 7:return[3,9];case 8:return[3,10];case 9:return[3,0];case 10:return[2]}}))}))}var i,o,a,u,c,s,f,l,h;return Mt(this,(function(p){switch(p.label){case 0:return i=(n=n||{}).chunkSizeBytes||1024*dn,[4,mn(t,i)];case 1:if(o=p.sent(),a=o.result,u="FileReaderSync"in self,c=a.data,!n.acceptNameDiff&&e.name!==c.databaseName)throw new Error("Name differs. Current database name is ".concat(e.name," but export is ").concat(c.databaseName));if(!n.acceptVersionDiff&&e.verno!==c.databaseVersion)throw new Error("Database version differs. Current database is in version ".concat(e.verno," but export is ").concat(c.databaseVersion));if(s=n.progressCallback,f={done:!1,completedRows:0,completedTables:0,totalRows:c.tables.reduce((function(e,t){return e+t.rowCount}),0),totalTables:c.tables.length},s&&Lt.ignoreTransaction((function(){return s(f)})),!n.clearTablesBeforeImport)return[3,5];l=0,h=e.tables,p.label=2;case 2:return l<h.length?[4,h[l].clear()]:[3,5];case 3:p.sent(),p.label=4;case 4:return l++,[3,2];case 5:return n.noTransaction?[4,r()]:[3,7];case 6:return p.sent(),[3,9];case 7:return[4,e.transaction("rw",e.tables,r)];case 8:p.sent(),p.label=9;case 9:return f.done=!0,s&&Lt.ignoreTransaction((function(){return s(f)})),[2]}}))}))}function mn(e,t){return Kt(this,void 0,void 0,(function(){var n,r;return Mt(this,(function(i){switch(i.label){case 0:n="slice"in e?pn(e):e,i.label=1;case 1:return n.eof()?[3,3]:[4,n.pullAsync(t)];case 2:return i.sent(),n.result.data&&n.result.data.data?[3,3]:[3,1];case 3:if(!(r=n.result)||"dexie"!=r.formatName)throw new Error("Given file is not a dexie export");if(r.formatVersion>fn)throw new Error("Format version ".concat(r.formatVersion," not supported"));if(!r.data)throw new Error("No data in export file");if(!r.data.databaseName)throw new Error("Missing databaseName in export file");if(!r.data.databaseVersion)throw new Error("Missing databaseVersion in export file");if(!r.data.tables)throw new Error("Missing tables in export file");return[2,n]}}))}))}Lt.prototype.export=function(e){return sn(this,e)},Lt.prototype.import=function(e,t){return bn(this,e,t)},Lt.import=function(e,t){return yn(e,t)};var gn=function(){throw new Error("This addon extends Dexie.prototype globally and does not have be included in Dexie constructor's addons options.")};return t})()));
//# sourceMappingURL=dexie-export-import.js.map