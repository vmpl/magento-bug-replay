{"version":3,"file":"list-item.js","names":["_uiComponent","extend","itemActive","_knockout","observable","defaults","template","links","item","afterRender","element","addEventListener","onEventFireGesture","bind","onTap","onHold","type","event","_this","target","closest","tapEvent","clearTimeout","timeoutId","setTimeout","dispatchEvent","MouseEvent","optionsVisible","_default"],"sources":["../../ts/js/view/list-item.ts"],"sourcesContent":["import Component from 'uiComponent';\nimport ko from 'knockout';\nimport ItemSession from \"VMPL_BugReplay/js/model/item-session\";\n\nexport default Component.extend({\n    itemActive: ko.observable<ItemSession>(),\n    defaults: {\n        template: 'VMPL_BugReplay/player/list/item',\n        links: {\n            item: '${ $.provider }:sessions.${ $.itemIndex }',\n            itemActive: '${ $.provider }:activeSession',\n        },\n    },\n    afterRender(element: HTMLElement) {\n        this.element = element;\n        element.addEventListener('mousedown', this.onEventFireGesture.bind(this, 'mousedown'));\n        element.addEventListener('mousemove', this.onEventFireGesture.bind(this, 'mousemove'));\n        element.addEventListener('mouseup', this.onEventFireGesture.bind(this, 'mouseup'));\n        element.addEventListener('touchstart', this.onEventFireGesture.bind(this, 'touchstart'));\n        element.addEventListener('touchmove', this.onEventFireGesture.bind(this, 'touchmove'));\n        element.addEventListener('touchend', this.onEventFireGesture.bind(this, 'touchend'));\n\n        element.addEventListener('tap', this.onTap.bind(this));\n        element.addEventListener('hold', this.onHold.bind(this));\n    },\n    onEventFireGesture(type: string, event: MouseEvent | TouchEvent) {\n        const target = <HTMLElement>event.target;\n        if (target.closest('.actions')) {\n            return;\n        }\n\n        switch (type) {\n            case 'mousedown':\n            case 'touchstart':\n                this.tapEvent = event;\n                clearTimeout(this.timeoutId);\n                this.timeoutId = setTimeout(() => {\n                    delete this.tapEvent;\n                    this.element.dispatchEvent(new MouseEvent('hold', event));\n                }, 1000);\n                break;\n            case 'mousemove':\n            case 'touchmove':\n                delete this.tapEvent;\n                clearTimeout(this.timeoutId);\n                break;\n            case 'mouseup':\n            case 'touchend':\n                clearTimeout(this.timeoutId);\n                !this.tapEvent\n                    || this.element.dispatchEvent(new MouseEvent('tap', event));\n                break;\n        }\n    },\n    onTap(event: MouseEvent | TouchEvent) {\n        if (this.item.optionsVisible()) {\n            return this.item.optionsVisible(false);\n        }\n\n        this.itemActive(this.item);\n    },\n    onHold(event: MouseEvent | TouchEvent) {\n        this.item.optionsVisible(true);\n    },\n});\n"],"mappings":"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"}