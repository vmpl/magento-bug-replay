{"version":3,"file":"dialog-catch-error.js","names":["_dialog","extend","defaults","template","content","title","message","preview","upload","close","elementConfig","class","_knockout","observable","imports","manager","initObservable","_super","window","addEventListener","DataEvent","Types","NewSessionWithError","onSessionError","bind","event","sessionId","data","show","uploadSession","_this","then","session","uploadSessions","modalPreview","_this2","previewPlayer","getChild","sessionReplay","_default"],"sources":["../../ts/js/view/dialog-catch-error.ts"],"sourcesContent":["import Dialog from \"VMPL_BugReplay/js/view/dialog\";\nimport RecorderManager, {DataEvent} from \"VMPL_BugReplay/js/lib/recorder-manager\";\nimport ko from \"knockout\";\n\nexport default Dialog.extend({\n    defaults: {\n        template: 'VMPL_BugReplay/dialog/catch-error',\n        content: {\n            title: 'Error Detected.',\n            message: 'In previos sessions error was caught, the recording was saved on your browser memory.',\n            preview: 'Preview',\n            upload: 'Upload',\n            close: 'Close',\n        },\n        elementConfig: {\n            class: ko.observable<string>('message info left-bottom'),\n        },\n        imports: {\n            manager: '${ $.provider }:manager',\n        },\n    },\n    initObservable() {\n        this._super();\n        window.addEventListener(\n            DataEvent.Types.NewSessionWithError,\n            this.onSessionError.bind(this),\n        );\n        return this;\n    },\n    onSessionError(event: DataEvent) {\n        this.sessionId = <number>event.data;\n        this.show(true);\n    },\n    uploadSession() {\n        (<Promise<RecorderManager>>this.manager())\n            .then(manager => {\n                return manager.session(this.sessionId)\n                    .then(session => manager.uploadSessions([session]))\n                    .then(() => this.show(false));\n            })\n    },\n    modalPreview() {\n        (<Promise<RecorderManager>>this.manager())\n            .then(manager => manager.session(this.sessionId))\n            .then(session => {\n                this.elementConfig.class('message info full-center');\n\n                const previewPlayer = this.getChild('previewPlayer')\n                previewPlayer.sessionReplay(session);\n            })\n    }\n});\n"],"mappings":";;;iBAIeA,OAAA,CAAOC,MAAM,CAAC;IACzBC,QAAQ,EAAE;MACNC,QAAQ,EAAE,mCAAmC;MAC7CC,OAAO,EAAE;QACLC,KAAK,EAAE,iBAAiB;QACxBC,OAAO,EAAE,uFAAuF;QAChGC,OAAO,EAAE,SAAS;QAClBC,MAAM,EAAE,QAAQ;QAChBC,KAAK,EAAE;MACX,CAAC;MACDC,aAAa,EAAE;QACXC,KAAK,EAAEC,SAAA,CAAGC,UAAU,CAAS,0BAA0B;MAC3D,CAAC;MACDC,OAAO,EAAE;QACLC,OAAO,EAAE;MACb;IACJ,CAAC;IACDC,cAAc,WAAAA,eAAA,EAAG;MACb,IAAI,CAACC,MAAM,CAAC,CAAC;MACbC,MAAM,CAACC,gBAAgB,CACnBC,0BAAS,CAACC,KAAK,CAACC,mBAAmB,EACnC,IAAI,CAACC,cAAc,CAACC,IAAI,CAAC,IAAI,CACjC,CAAC;MACD,OAAO,IAAI;IACf,CAAC;IACDD,cAAc,WAAAA,eAACE,KAAgB,EAAE;MAC7B,IAAI,CAACC,SAAS,GAAWD,KAAK,CAACE,IAAI;MACnC,IAAI,CAACC,IAAI,CAAC,IAAI,CAAC;IACnB,CAAC;IACDC,aAAa,WAAAA,cAAA,EAAG;MAAA,IAAAC,KAAA;MACe,IAAI,CAACf,OAAO,CAAC,CAAC,CACpCgB,IAAI,CAAC,UAAAhB,OAAO,EAAI;QACb,OAAOA,OAAO,CAACiB,OAAO,CAACF,KAAI,CAACJ,SAAS,CAAC,CACjCK,IAAI,CAAC,UAAAC,OAAO;UAAA,OAAIjB,OAAO,CAACkB,cAAc,CAAC,CAACD,OAAO,CAAC,CAAC;QAAA,EAAC,CAClDD,IAAI,CAAC;UAAA,OAAMD,KAAI,CAACF,IAAI,CAAC,KAAK,CAAC;QAAA,EAAC;MACrC,CAAC,CAAC;IACV,CAAC;IACDM,YAAY,WAAAA,aAAA,EAAG;MAAA,IAAAC,MAAA;MACgB,IAAI,CAACpB,OAAO,CAAC,CAAC,CACpCgB,IAAI,CAAC,UAAAhB,OAAO;QAAA,OAAIA,OAAO,CAACiB,OAAO,CAACG,MAAI,CAACT,SAAS,CAAC;MAAA,EAAC,CAChDK,IAAI,CAAC,UAAAC,OAAO,EAAI;QACbG,MAAI,CAACzB,aAAa,CAACC,KAAK,CAAC,0BAA0B,CAAC;QAEpD,IAAMyB,aAAa,GAAGD,MAAI,CAACE,QAAQ,CAAC,eAAe,CAAC;QACpDD,aAAa,CAACE,aAAa,CAACN,OAAO,CAAC;MACxC,CAAC,CAAC;IACV;EACJ,CAAC,CAAC;EAAA,OAAAO,QAAA;AAAA"}