{"version":3,"file":"session-provider.js","names":["_provider","extend","defaults","fileHash","fileRequestUrl","_manager","_this","endpoint","URL","endpointRequest","pathname","replace","_recorderManager","init","indexedDB","databases","then","some","it","name","manager","downloadImport","_default"],"sources":["../../ts/js/model/session-provider.ts"],"sourcesContent":["import Provider from \"VMPL_BugReplay/js/model/provider\";\nimport RecorderManager from \"VMPL_BugReplay/js/bug-replay/recorder-manager\";\n\nexport default Provider.extend({\n    defaults: {\n        fileHash: 'AdminReplay',\n        fileRequestUrl: '',\n    },\n    _manager() {\n        const endpoint = new URL(this.endpointRequest).pathname.replace(/\\/+$/, '');\n\n        if (this.fileHash === 'AdminReplay') {\n            return RecorderManager.init(endpoint, this.fileHash); // @bug for some reason _super() doesn't work ??\n        }\n\n        return indexedDB.databases()\n            .then(databases => {\n                if (databases.some(it => it.name === this.fileHash)) {\n                    return RecorderManager.init(endpoint, this.fileHash);\n                }\n\n                return RecorderManager.init(endpoint, this.fileHash)\n                    .then((manager: RecorderManager) => {\n                        return manager.downloadImport(new URL(this.fileRequestUrl));\n                    })\n            })\n    },\n});\n"],"mappings":";;;iBAGeA,SAAA,CAASC,MAAM,CAAC;IAC3BC,QAAQ,EAAE;MACNC,QAAQ,EAAE,aAAa;MACvBC,cAAc,EAAE;IACpB,CAAC;IACDC,QAAQ,WAAAA,SAAA,EAAG;MAAA,IAAAC,KAAA;MACP,IAAMC,QAAQ,GAAG,IAAIC,GAAG,CAAC,IAAI,CAACC,eAAe,CAAC,CAACC,QAAQ,CAACC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC;MAE3E,IAAI,IAAI,CAACR,QAAQ,KAAK,aAAa,EAAE;QACjC,OAAOS,gBAAA,CAAgBC,IAAI,CAACN,QAAQ,EAAE,IAAI,CAACJ,QAAQ,CAAC,CAAC,CAAC;MAC1D;;MAEA,OAAOW,SAAS,CAACC,SAAS,CAAC,CAAC,CACvBC,IAAI,CAAC,UAAAD,SAAS,EAAI;QACf,IAAIA,SAAS,CAACE,IAAI,CAAC,UAAAC,EAAE;UAAA,OAAIA,EAAE,CAACC,IAAI,KAAKb,KAAI,CAACH,QAAQ;QAAA,EAAC,EAAE;UACjD,OAAOS,gBAAA,CAAgBC,IAAI,CAACN,QAAQ,EAAED,KAAI,CAACH,QAAQ,CAAC;QACxD;QAEA,OAAOS,gBAAA,CAAgBC,IAAI,CAACN,QAAQ,EAAED,KAAI,CAACH,QAAQ,CAAC,CAC/Ca,IAAI,CAAC,UAACI,OAAwB,EAAK;UAChC,OAAOA,OAAO,CAACC,cAAc,CAAC,IAAIb,GAAG,CAACF,KAAI,CAACF,cAAc,CAAC,CAAC;QAC/D,CAAC,CAAC;MACV,CAAC,CAAC;IACV;EACJ,CAAC,CAAC;EAAA,OAAAkB,QAAA;AAAA"}