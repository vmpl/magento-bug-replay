{"version":3,"file":"decorator-serializer.js","names":["deserialize","Map","randomstring","length","outString","inOptions","i","charAt","Math","floor","random","serialize","target","hasOwnProperty","Object","defineProperty","value","configurable","writable","enumerable","$serializeProperties","$deserializable","data","deserializable","$_serializeProperties","forEach","it","bind","deserializeToken","has","set","self","serializable","$serializable","propertyKey","serializableClass","push"],"sources":["../../ts/js/lib/decorator-serializer.ts"],"sourcesContent":["const deserialize: Map<string, Function> = new Map();\nexport { deserialize };\n\nfunction randomstring(length: number = 64): string {\n    let outString: string = '';\n    let inOptions: string = 'abcdefghijklmnopqrstuvwxyz0123456789';\n\n    for (let i = 0; i < length; i++) {\n        outString += inOptions.charAt(Math.floor(Math.random() * inOptions.length));\n    }\n\n    return outString;\n}\n\nexport function serialize(): Function {\n    return function (target: Object) {\n        if (!target.hasOwnProperty('$serializeProperties')) {\n            Object.defineProperty(target, '$serializeProperties', {\n                value: [],\n                configurable: false,\n                writable: false,\n                enumerable: true,\n            })\n        }\n        const { $serializeProperties} = <{ $serializeProperties: string[] }>target;\n\n        const $deserializable = (function (data: { [property: string]: any }) {\n            let deserializable = <{ [property: string]: any }>(new this());\n            deserializable.$_serializeProperties.forEach((it: string) => {\n                deserializable[it] = data[it];\n                if (deserializable[it].hasOwnProperty('$serializable')) {\n                    deserializable[it] = deserializable[it].$deserializable(deserializable[it]);\n                }\n            })\n            return deserializable;\n        }).bind(target);\n\n        let deserializeToken: string;\n        do {\n            deserializeToken = randomstring()\n        } while (deserialize.has(deserializeToken));\n        deserialize.set(deserializeToken, $deserializable);\n\n        if (!target.hasOwnProperty('$serializable')) {\n            Object.defineProperty(target, '$serializable', {\n                writable: false,\n                enumerable: false,\n                configurable: false,\n                value(): Object {\n                    const self = <{ [property: string]: any }>this;\n                    const serializable: { [property: string]: any } = {};\n                    serializable['$serializableClass'] = deserializeToken;\n                    $serializeProperties.forEach(it => {\n                        serializable[it] = self[it];\n                        if (serializable[it].hasOwnProperty('$serializable')) {\n                            serializable[it] = serializable[it].$serializable();\n                        }\n                    })\n                    return serializable;\n                }\n            });\n        }\n    }\n}\n\nexport function serializable(): Function {\n    return function (target: Object, propertyKey: string) {\n        if (!target.hasOwnProperty('$serializeProperties')) {\n            Object.defineProperty(target, '$serializeProperties', {\n                value: [],\n                configurable: false,\n                writable: false,\n                enumerable: true,\n            })\n        }\n\n        const serializableClass = <{ $serializeProperties: string[] }>target;\n        serializableClass.$serializeProperties.push(propertyKey);\n    }\n}\n"],"mappings":"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"}