{"version":3,"file":"session-worker.js","names":["SessionDatabase","_dexie$Dexie","_inheritsLoose","databaseName","_this","call","version","stores","events","_proto","prototype","post","record","put","Dexie","SessionWorker","_proto2","initInstance","instance","database","Promise","resolve","sayHello","console","log","exportToObject","bind","sessionWorker","expose"],"sources":["../../ts/js/worker/session-worker.ts"],"sourcesContent":["import {expose} from 'threads/worker';\nimport {Dexie} from 'dexie';\nimport {RecordEvent, SessionWorker as SessionWorkerInterface} from 'VMPL_BugReplay/js/api/session'\n\nclass SessionDatabase extends Dexie {\n    events!: Dexie.Table<RecordEvent, number>;\n\n    constructor(databaseName: string) {\n        super(databaseName);\n        this.version(1).stores({\n            events: 'timestamp,type,data',\n        });\n    }\n\n    post(record: RecordEvent): Promise<RecordEvent> {\n        return this.events.put(record);\n    }\n}\n\nclass SessionWorker implements SessionWorkerInterface {\n    protected database: Dexie;\n    initInstance(instance: string): Promise<any> {\n        this.database = new SessionDatabase(instance);\n        return Promise.resolve();\n    }\n    sayHello(): Promise<any> {\n        console.log('Hello World!');\n        return Promise.resolve();\n    }\n\n    exportToObject(): Object {\n        return {\n            initInstance: this.initInstance.bind(this),\n            sayHello: this.sayHello.bind(this),\n        }\n    }\n}\nconst sessionWorker = new SessionWorker();\n\nexpose(sessionWorker.exportToObject());\n"],"mappings":";;;;;;;MAIMA,eAAe,0BAAAC,YAAA;IAAAC,cAAA,CAAAF,eAAA,EAAAC,YAAA;IAGjB,SAAAD,gBAAYG,YAAoB,EAAE;MAAA,IAAAC,KAAA;MAC9BA,KAAA,GAAAH,YAAA,CAAAI,IAAA,OAAMF,YAAY,CAAC;MACnBC,KAAA,CAAKE,OAAO,CAAC,CAAC,CAAC,CAACC,MAAM,CAAC;QACnBC,MAAM,EAAE;MACZ,CAAC,CAAC;MAAC,OAAAJ,KAAA;IACP;IAAC,IAAAK,MAAA,GAAAT,eAAA,CAAAU,SAAA;IAAAD,MAAA,CAEDE,IAAI,GAAJ,SAAAA,KAAKC,MAAmB,EAAwB;MAC5C,OAAO,IAAI,CAACJ,MAAM,CAACK,GAAG,CAACD,MAAM,CAAC;IAClC,CAAC;IAAA,OAAAZ,eAAA;EAAA,EAZyBc,YAAK;EAAA,IAe7BC,aAAa;IAAA,SAAAA,cAAA;IAAA,IAAAC,OAAA,GAAAD,aAAA,CAAAL,SAAA;IAAAM,OAAA,CAEfC,YAAY,GAAZ,SAAAA,aAAaC,QAAgB,EAAgB;MACzC,IAAI,CAACC,QAAQ,GAAG,IAAInB,eAAe,CAACkB,QAAQ,CAAC;MAC7C,OAAOE,OAAO,CAACC,OAAO,CAAC,CAAC;IAC5B,CAAC;IAAAL,OAAA,CACDM,QAAQ,GAAR,SAAAA,SAAA,EAAyB;MACrBC,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC;MAC3B,OAAOJ,OAAO,CAACC,OAAO,CAAC,CAAC;IAC5B,CAAC;IAAAL,OAAA,CAEDS,cAAc,GAAd,SAAAA,eAAA,EAAyB;MACrB,OAAO;QACHR,YAAY,EAAE,IAAI,CAACA,YAAY,CAACS,IAAI,CAAC,IAAI,CAAC;QAC1CJ,QAAQ,EAAE,IAAI,CAACA,QAAQ,CAACI,IAAI,CAAC,IAAI;MACrC,CAAC;IACL,CAAC;IAAA,OAAAX,aAAA;EAAA;EAEL,IAAMY,aAAa,GAAG,IAAIZ,aAAa,CAAC,CAAC;EAEzC,IAAAa,cAAM,EAACD,aAAa,CAACF,cAAc,CAAC,CAAC,CAAC;AAAC"}